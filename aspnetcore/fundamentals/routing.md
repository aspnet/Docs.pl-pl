---
title: Routing w ASP.NET Core
author: rick-anderson
description: Dowiedz się, w jaki sposób Routing ASP.NET Core odpowiada za dopasowanie żądań HTTP i wysyłanie ich do wykonywalnych punktów końcowych.
monikerRange: '>= aspnetcore-2.1'
ms.author: riande
ms.custom: mvc
ms.date: 4/1/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: fundamentals/routing
ms.openlocfilehash: 0ce89d2dee3fb2054655c003daddfda2ffa52696
ms.sourcegitcommit: 54fe1ae5e7d068e27376d562183ef9ddc7afc432
ms.translationtype: MT
ms.contentlocale: pl-PL
ms.lasthandoff: 03/10/2021
ms.locfileid: "102587285"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="3660c-103">Routing w ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3660c-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="3660c-104">[Ryan Nowak](https://github.com/rynowak), [Kirka Larkin](https://twitter.com/serpent5)i [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="3660c-104">By [Ryan Nowak](https://github.com/rynowak), [Kirk Larkin](https://twitter.com/serpent5), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

::: moniker range=">= aspnetcore-3.0"

<span data-ttu-id="3660c-105">Routing jest odpowiedzialny za pasujące przychodzące żądania HTTP i wysyłając te żądania do wykonywalnych punktów końcowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-105">Routing is responsible for matching incoming HTTP requests and dispatching those requests to the app's executable endpoints.</span></span> <span data-ttu-id="3660c-106">[Punkty końcowe](#endpoint) to jednostki aplikacji wykonywalnego kodu obsługi żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-106">[Endpoints](#endpoint) are the app's units of executable request-handling code.</span></span> <span data-ttu-id="3660c-107">Punkty końcowe są zdefiniowane w aplikacji i konfigurowane podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-107">Endpoints are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="3660c-108">Proces dopasowywania punktów końcowych może wyodrębnić wartości z adresu URL żądania i podać te wartości dla przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="3660c-108">The endpoint matching process can extract values from the request's URL and provide those values for request processing.</span></span> <span data-ttu-id="3660c-109">Korzystając z informacji o punkcie końcowym z aplikacji, routing może również generować adresy URL mapowane na punkty końcowe.</span><span class="sxs-lookup"><span data-stu-id="3660c-109">Using endpoint information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="3660c-110">Aplikacje mogą konfigurować Routing przy użyciu:</span><span class="sxs-lookup"><span data-stu-id="3660c-110">Apps can configure routing using:</span></span>

- <span data-ttu-id="3660c-111">Kontrolery</span><span class="sxs-lookup"><span data-stu-id="3660c-111">Controllers</span></span>
- <span data-ttu-id="3660c-112">Razor Page</span><span class="sxs-lookup"><span data-stu-id="3660c-112">Razor Pages</span></span>
- SignalR
- <span data-ttu-id="3660c-113">Usługi gRPC Services</span><span class="sxs-lookup"><span data-stu-id="3660c-113">gRPC Services</span></span>
- <span data-ttu-id="3660c-114">[Oprogramowanie pośredniczące](xref:fundamentals/middleware/index) z obsługą punktu końcowego, takie jak [kontrole kondycji](xref:host-and-deploy/health-checks).</span><span class="sxs-lookup"><span data-stu-id="3660c-114">Endpoint-enabled [middleware](xref:fundamentals/middleware/index) such as [Health Checks](xref:host-and-deploy/health-checks).</span></span>
- <span data-ttu-id="3660c-115">Obiekty delegowane i wyrażenia lambda zarejestrowane z routingiem.</span><span class="sxs-lookup"><span data-stu-id="3660c-115">Delegates and lambdas registered with routing.</span></span>

<span data-ttu-id="3660c-116">W tym dokumencie przedstawiono szczegóły niskiego poziomu ASP.NET Core routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-116">This document covers low-level details of ASP.NET Core routing.</span></span> <span data-ttu-id="3660c-117">Aby uzyskać informacje na temat konfigurowania routingu:</span><span class="sxs-lookup"><span data-stu-id="3660c-117">For information on configuring routing:</span></span>

* <span data-ttu-id="3660c-118">W przypadku kontrolerów należy zapoznać się z tematem <xref:mvc/controllers/routing> .</span><span class="sxs-lookup"><span data-stu-id="3660c-118">For controllers, see <xref:mvc/controllers/routing>.</span></span>
* <span data-ttu-id="3660c-119">W przypadku Razor Konwencji stron, zobacz <xref:razor-pages/razor-pages-conventions> .</span><span class="sxs-lookup"><span data-stu-id="3660c-119">For Razor Pages conventions, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="3660c-120">System routingu punktu końcowego opisany w tym dokumencie ma zastosowanie do ASP.NET Core 3,0 i nowszych.</span><span class="sxs-lookup"><span data-stu-id="3660c-120">The endpoint routing system described in this document applies to ASP.NET Core 3.0 and later.</span></span> <span data-ttu-id="3660c-121">Aby uzyskać informacje dotyczące poprzedniego systemu routingu opartego na programie <xref:Microsoft.AspNetCore.Routing.IRouter> , wybierz wersję ASP.NET Core 2,1 przy użyciu jednej z następujących metod:</span><span class="sxs-lookup"><span data-stu-id="3660c-121">For information on the previous routing system based on <xref:Microsoft.AspNetCore.Routing.IRouter>, select the ASP.NET Core 2.1 version using one of the following approaches:</span></span>

* <span data-ttu-id="3660c-122">Selektor wersji dla poprzedniej wersji.</span><span class="sxs-lookup"><span data-stu-id="3660c-122">The version selector for a previous version.</span></span>
* <span data-ttu-id="3660c-123">Wybierz pozycję [ASP.NET Core 2,1 Routing](?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="3660c-123">Select [ASP.NET Core 2.1 routing](?view=aspnetcore-2.1).</span></span>

<span data-ttu-id="3660c-124">[Wyświetl lub pobierz przykładowy kod](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples/3.x) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="3660c-124">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples/3.x) ([how to download](xref:index#how-to-download-a-sample))</span></span>

<span data-ttu-id="3660c-125">Próbki pobierania dla tego dokumentu są włączane przez konkretną `Startup` klasę.</span><span class="sxs-lookup"><span data-stu-id="3660c-125">The download samples for this document are enabled by a specific `Startup` class.</span></span> <span data-ttu-id="3660c-126">Aby uruchomić określony przykład, zmodyfikuj *program.cs* w celu wywołania żądanej `Startup` klasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-126">To run a specific sample, modify *Program.cs* to call the desired `Startup` class.</span></span>

## <a name="routing-basics"></a><span data-ttu-id="3660c-127">Podstawy routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-127">Routing basics</span></span>

<span data-ttu-id="3660c-128">Wszystkie szablony ASP.NET Core obejmują Routing w wygenerowanym kodzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-128">All ASP.NET Core templates include routing in the generated code.</span></span> <span data-ttu-id="3660c-129">Routing jest zarejestrowany w potoku [pośredniczącego](xref:fundamentals/middleware/index) w programie `Startup.Configure` .</span><span class="sxs-lookup"><span data-stu-id="3660c-129">Routing is registered in the [middleware](xref:fundamentals/middleware/index) pipeline in `Startup.Configure`.</span></span>

<span data-ttu-id="3660c-130">Poniższy kod przedstawia podstawowy przykład routingu:</span><span class="sxs-lookup"><span data-stu-id="3660c-130">The following code shows a basic example of routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Startup.cs?name=snippet&highlight=8,10)]

<span data-ttu-id="3660c-131">Routing używa pary programów pośredniczących zarejestrowanych przez program <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> i <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> :</span><span class="sxs-lookup"><span data-stu-id="3660c-131">Routing uses a pair of middleware, registered by <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>:</span></span>

* <span data-ttu-id="3660c-132">`UseRouting` dodaje dopasowanie trasy do potoku programu pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-132">`UseRouting` adds route matching to the middleware pipeline.</span></span> <span data-ttu-id="3660c-133">To oprogramowanie pośredniczące sprawdza zestaw punktów końcowych zdefiniowanych w aplikacji i wybiera [najlepsze dopasowanie](#urlm) na podstawie żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-133">This middleware looks at the set of endpoints defined in the app, and selects the [best match](#urlm) based on the request.</span></span>
* <span data-ttu-id="3660c-134">`UseEndpoints` dodaje wykonywanie punktu końcowego do potoku programu pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-134">`UseEndpoints` adds endpoint execution to the middleware pipeline.</span></span> <span data-ttu-id="3660c-135">Powoduje uruchomienie delegata skojarzonego z wybranym punktem końcowym.</span><span class="sxs-lookup"><span data-stu-id="3660c-135">It runs the delegate associated with the selected endpoint.</span></span>

<span data-ttu-id="3660c-136">W powyższym przykładzie użyto pojedynczej *trasy do* punktu końcowego kodu przy użyciu metody [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) :</span><span class="sxs-lookup"><span data-stu-id="3660c-136">The preceding example includes a single *route to code* endpoint using the [MapGet](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*) method:</span></span>

* <span data-ttu-id="3660c-137">Gdy żądanie HTTP `GET` zostanie wysłane do głównego adresu URL `/` :</span><span class="sxs-lookup"><span data-stu-id="3660c-137">When an HTTP `GET` request is sent to the root URL `/`:</span></span>
  * <span data-ttu-id="3660c-138">Zostanie wyświetlony delegat żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-138">The request delegate shown executes.</span></span>
  * <span data-ttu-id="3660c-139">`Hello World!` jest zapisywana w odpowiedzi HTTP.</span><span class="sxs-lookup"><span data-stu-id="3660c-139">`Hello World!` is written to the HTTP response.</span></span> <span data-ttu-id="3660c-140">Domyślnie główny adres URL `/` to `https://localhost:5001/` .</span><span class="sxs-lookup"><span data-stu-id="3660c-140">By default, the root URL `/` is `https://localhost:5001/`.</span></span>
* <span data-ttu-id="3660c-141">Jeśli metoda żądania nie jest `GET` lub nie jest głównym adresem URL, nie są `/` zwracane żadne dopasowania tras i HTTP 404.</span><span class="sxs-lookup"><span data-stu-id="3660c-141">If the request method is not `GET` or the root URL is not `/`, no route matches and an HTTP 404 is returned.</span></span>

### <a name="endpoint"></a><span data-ttu-id="3660c-142">Punkt końcowy</span><span class="sxs-lookup"><span data-stu-id="3660c-142">Endpoint</span></span>

<a name="endpoint"></a>

<span data-ttu-id="3660c-143">`MapGet`Metoda jest używana do definiowania **punktu końcowego**.</span><span class="sxs-lookup"><span data-stu-id="3660c-143">The `MapGet` method is used to define an **endpoint**.</span></span> <span data-ttu-id="3660c-144">Punkt końcowy to coś, co może być:</span><span class="sxs-lookup"><span data-stu-id="3660c-144">An endpoint is something that can be:</span></span>

* <span data-ttu-id="3660c-145">Wybierany przez dopasowanie adresu URL i metody HTTP.</span><span class="sxs-lookup"><span data-stu-id="3660c-145">Selected, by matching the URL and HTTP method.</span></span>
* <span data-ttu-id="3660c-146">Wykonywane przez uruchomienie delegata.</span><span class="sxs-lookup"><span data-stu-id="3660c-146">Executed, by running the delegate.</span></span>

<span data-ttu-id="3660c-147">Punkty końcowe, które mogą być dopasowane i wykonywane przez aplikację, są skonfigurowane w programie `UseEndpoints` .</span><span class="sxs-lookup"><span data-stu-id="3660c-147">Endpoints that can be matched and executed by the app are configured in `UseEndpoints`.</span></span> <span data-ttu-id="3660c-148">Na przykład, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*> , <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*> i [podobne metody](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) Połącz delegatów żądań z systemem routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-148">For example, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapGet*>, <xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions.MapPost*>, and [similar methods](xref:Microsoft.AspNetCore.Builder.EndpointRouteBuilderExtensions) connect request delegates to the routing system.</span></span>
<span data-ttu-id="3660c-149">Do łączenia funkcji ASP.NET Core Framework z systemem routingu można używać dodatkowych metod:</span><span class="sxs-lookup"><span data-stu-id="3660c-149">Additional methods can be used to connect ASP.NET Core framework features to the routing system:</span></span>
- <span data-ttu-id="3660c-150">[RazorStrony Razor mapy stron](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)</span><span class="sxs-lookup"><span data-stu-id="3660c-150">[MapRazorPages for Razor Pages](xref:Microsoft.AspNetCore.Builder.RazorPagesEndpointRouteBuilderExtensions.MapRazorPages*)</span></span>
- [<span data-ttu-id="3660c-151">MapControllers dla kontrolerów</span><span class="sxs-lookup"><span data-stu-id="3660c-151">MapControllers for controllers</span></span>](xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllers*)
- <span data-ttu-id="3660c-152">[MapHub \<THub> dla SignalR](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*)</span><span class="sxs-lookup"><span data-stu-id="3660c-152">[MapHub\<THub> for SignalR](xref:Microsoft.AspNetCore.SignalR.HubRouteBuilder.MapHub*)</span></span> 
- [<span data-ttu-id="3660c-153">MapGrpcService \<TService> dla gRPC</span><span class="sxs-lookup"><span data-stu-id="3660c-153">MapGrpcService\<TService> for gRPC</span></span>](xref:grpc/aspnetcore)

<span data-ttu-id="3660c-154">W poniższym przykładzie przedstawiono Routing z bardziej zaawansowanym szablonem trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-154">The following example shows routing with a more sophisticated route template:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/RouteTemplateStartup.cs?name=snippet)]

<span data-ttu-id="3660c-155">Ciąg `/hello/{name:alpha}` jest **szablonem trasy**.</span><span class="sxs-lookup"><span data-stu-id="3660c-155">The string `/hello/{name:alpha}` is a **route template**.</span></span> <span data-ttu-id="3660c-156">Służy do konfigurowania sposobu dopasowywania punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-156">It is used to configure how the endpoint is matched.</span></span> <span data-ttu-id="3660c-157">W tym przypadku szablon pasuje do:</span><span class="sxs-lookup"><span data-stu-id="3660c-157">In this case, the template matches:</span></span>

* <span data-ttu-id="3660c-158">Adres URL, taki jak `/hello/Ryan`</span><span class="sxs-lookup"><span data-stu-id="3660c-158">A URL like `/hello/Ryan`</span></span>
* <span data-ttu-id="3660c-159">Dowolna ścieżka URL, która rozpoczyna się od `/hello/` po którym następuje sekwencja znaków alfabetu.</span><span class="sxs-lookup"><span data-stu-id="3660c-159">Any URL path that begins with `/hello/` followed by a sequence of alphabetic characters.</span></span>  <span data-ttu-id="3660c-160">`:alpha` stosuje ograniczenie trasy, które pasuje tylko do znaków alfabetu.</span><span class="sxs-lookup"><span data-stu-id="3660c-160">`:alpha` applies a route constraint that matches only alphabetic characters.</span></span> <span data-ttu-id="3660c-161">[Ograniczenia trasy](#route-constraint-reference) zostały omówione w dalszej części tego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="3660c-161">[Route constraints](#route-constraint-reference) are explained later in this document.</span></span>

<span data-ttu-id="3660c-162">Drugi segment ścieżki URL `{name:alpha}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-162">The second segment of the URL path, `{name:alpha}`:</span></span>

* <span data-ttu-id="3660c-163">Jest powiązany z `name` parametrem.</span><span class="sxs-lookup"><span data-stu-id="3660c-163">Is bound to the `name` parameter.</span></span>
* <span data-ttu-id="3660c-164">Jest przechwytywany i przechowywany w usłudze [HttpRequest. RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span><span class="sxs-lookup"><span data-stu-id="3660c-164">Is captured and stored in [HttpRequest.RouteValues](xref:Microsoft.AspNetCore.Http.HttpRequest.RouteValues*).</span></span>

<span data-ttu-id="3660c-165">System routingu punktu końcowego opisany w tym dokumencie jest nowy w ASP.NET Core 3,0.</span><span class="sxs-lookup"><span data-stu-id="3660c-165">The endpoint routing system described in this document is new as of ASP.NET Core 3.0.</span></span> <span data-ttu-id="3660c-166">Jednak wszystkie wersje ASP.NET Core obsługują ten sam zestaw funkcji szablonu trasy i ograniczenia trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-166">However, all versions of ASP.NET Core support the same set of route template features and route constraints.</span></span>

<span data-ttu-id="3660c-167">W poniższym przykładzie przedstawiono Routing z [kontrolami kondycji](xref:host-and-deploy/health-checks) i autoryzacją:</span><span class="sxs-lookup"><span data-stu-id="3660c-167">The following example shows routing with [health checks](xref:host-and-deploy/health-checks) and authorization:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

[!INCLUDE[request localized comments](~/includes/code-comments-loc.md)]

<span data-ttu-id="3660c-168">W poprzednim przykładzie pokazano, jak:</span><span class="sxs-lookup"><span data-stu-id="3660c-168">The preceding example demonstrates how:</span></span>

* <span data-ttu-id="3660c-169">Oprogramowanie pośredniczące autoryzacji może być używane z routingiem.</span><span class="sxs-lookup"><span data-stu-id="3660c-169">The authorization middleware can be used with routing.</span></span>
* <span data-ttu-id="3660c-170">Punkty końcowe mogą służyć do konfigurowania zachowania autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-170">Endpoints can be used to configure authorization behavior.</span></span>

<span data-ttu-id="3660c-171"><xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*>Wywołanie dodaje punkt końcowy sprawdzania kondycji.</span><span class="sxs-lookup"><span data-stu-id="3660c-171">The <xref:Microsoft.AspNetCore.Builder.HealthCheckEndpointRouteBuilderExtensions.MapHealthChecks*> call adds a health check endpoint.</span></span> <span data-ttu-id="3660c-172">Tworzenie łańcucha <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> w ramach tego wywołania powoduje dołączenie zasad autoryzacji do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-172">Chaining <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*> on to this call attaches an authorization policy to the endpoint.</span></span>

<span data-ttu-id="3660c-173">Wywoływanie <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> i <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> Dodawanie oprogramowania pośredniczącego uwierzytelniania i autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-173">Calling <xref:Microsoft.AspNetCore.Builder.AuthAppBuilderExtensions.UseAuthentication*> and <xref:Microsoft.AspNetCore.Builder.AuthorizationAppBuilderExtensions.UseAuthorization*> adds the authentication and authorization middleware.</span></span> <span data-ttu-id="3660c-174">Te oprogramowanie pośredniczące jest umieszczane między programem <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> i `UseEndpoints` tak, aby mogły:</span><span class="sxs-lookup"><span data-stu-id="3660c-174">These middleware are placed between <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseRouting*> and `UseEndpoints` so that they can:</span></span>

* <span data-ttu-id="3660c-175">Zobacz, który punkt końcowy został wybrany przez `UseRouting` .</span><span class="sxs-lookup"><span data-stu-id="3660c-175">See which endpoint was selected by `UseRouting`.</span></span>
* <span data-ttu-id="3660c-176">Zastosuj zasady autoryzacji przed <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> wysłaniem do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-176">Apply an authorization policy before <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> dispatches to the endpoint.</span></span>

<a name="metadata"></a>

### <a name="endpoint-metadata"></a><span data-ttu-id="3660c-177">Metadane punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="3660c-177">Endpoint metadata</span></span>

<span data-ttu-id="3660c-178">W poprzednim przykładzie istnieją dwa punkty końcowe, ale tylko punkt końcowy sprawdzania kondycji ma dołączone zasady autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-178">In the preceding example, there are two endpoints, but only the health check endpoint has an authorization policy attached.</span></span> <span data-ttu-id="3660c-179">Jeśli żądanie jest zgodne z punktem końcowym sprawdzania kondycji, `/healthz` zostanie wykonane sprawdzanie autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-179">If the request matches the health check endpoint, `/healthz`, an authorization check is performed.</span></span> <span data-ttu-id="3660c-180">Pokazuje, że punkty końcowe mogą mieć dodatkowe dane dołączone do nich.</span><span class="sxs-lookup"><span data-stu-id="3660c-180">This demonstrates that endpoints can have extra data attached to them.</span></span> <span data-ttu-id="3660c-181">Te dodatkowe dane są nazywane **metadanymi** punktu końcowego:</span><span class="sxs-lookup"><span data-stu-id="3660c-181">This extra data is called endpoint **metadata**:</span></span>

* <span data-ttu-id="3660c-182">Metadane mogą być przetwarzane przez oprogramowanie pośredniczące obsługujące Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-182">The metadata can be processed by routing-aware middleware.</span></span>
* <span data-ttu-id="3660c-183">Metadane mogą być dowolnego typu .NET.</span><span class="sxs-lookup"><span data-stu-id="3660c-183">The metadata can be of any .NET type.</span></span>

## <a name="routing-concepts"></a><span data-ttu-id="3660c-184">Pojęcia dotyczące routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-184">Routing concepts</span></span>

<span data-ttu-id="3660c-185">System routingu jest kompilowany na podstawie potoku programu pośredniczącego przez dodanie zaawansowanej koncepcji **punktu końcowego** .</span><span class="sxs-lookup"><span data-stu-id="3660c-185">The routing system builds on top of the middleware pipeline by adding the powerful **endpoint** concept.</span></span> <span data-ttu-id="3660c-186">Punkty końcowe reprezentują jednostki funkcji aplikacji, które różnią się od siebie pod względem routingu, autoryzacji i dowolnej liczby systemów ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="3660c-186">Endpoints represent units of the app's functionality that are distinct from each other in terms of routing, authorization, and any number of ASP.NET Core's systems.</span></span>

<a name="endpoint"></a>

### <a name="aspnet-core-endpoint-definition"></a><span data-ttu-id="3660c-187">Definicja punktu końcowego ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="3660c-187">ASP.NET Core endpoint definition</span></span>

<span data-ttu-id="3660c-188">Punkt końcowy ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3660c-188">An ASP.NET Core endpoint is:</span></span>

* <span data-ttu-id="3660c-189">Plik wykonywalny: ma <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> .</span><span class="sxs-lookup"><span data-stu-id="3660c-189">Executable: Has a <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate>.</span></span>
* <span data-ttu-id="3660c-190">Rozszerzalne: zawiera kolekcję [metadanych](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) .</span><span class="sxs-lookup"><span data-stu-id="3660c-190">Extensible: Has a [Metadata](xref:Microsoft.AspNetCore.Http.Endpoint.Metadata*) collection.</span></span>
* <span data-ttu-id="3660c-191">Wybór: Opcjonalnie, zawiera [Informacje o routingu](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span><span class="sxs-lookup"><span data-stu-id="3660c-191">Selectable: Optionally, has [routing information](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern*).</span></span>
* <span data-ttu-id="3660c-192">Wyliczalne: Kolekcja punktów końcowych może być wyświetlona przez pobranie <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> z elementu [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="3660c-192">Enumerable: The collection of endpoints can be listed by retrieving the <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> from [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="3660c-193">Poniższy kod pokazuje, jak pobrać i sprawdzić punkt końcowy pasujący do bieżącego żądania:</span><span class="sxs-lookup"><span data-stu-id="3660c-193">The following code shows how to retrieve and inspect the endpoint matching the current request:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/EndpointInspectorStartup.cs?name=snippet)]

<span data-ttu-id="3660c-194">Punkt końcowy, w przypadku wybrania, można pobrać z `HttpContext` .</span><span class="sxs-lookup"><span data-stu-id="3660c-194">The endpoint, if selected, can be retrieved from the `HttpContext`.</span></span> <span data-ttu-id="3660c-195">Jego właściwości można sprawdzić.</span><span class="sxs-lookup"><span data-stu-id="3660c-195">Its properties can be inspected.</span></span> <span data-ttu-id="3660c-196">Obiekty punktu końcowego są niezmienne i nie można ich modyfikować po utworzeniu.</span><span class="sxs-lookup"><span data-stu-id="3660c-196">Endpoint objects are immutable and cannot be modified after creation.</span></span> <span data-ttu-id="3660c-197">Najczęściej spotykanym typem punktu końcowego jest <xref:Microsoft.AspNetCore.Routing.RouteEndpoint> .</span><span class="sxs-lookup"><span data-stu-id="3660c-197">The most common type of endpoint is a <xref:Microsoft.AspNetCore.Routing.RouteEndpoint>.</span></span> <span data-ttu-id="3660c-198">`RouteEndpoint` zawiera informacje, które mogą być wybierane przez system routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-198">`RouteEndpoint` includes information that allows it to be to selected by the routing system.</span></span>

<span data-ttu-id="3660c-199">W poprzednim kodzie [aplikacja. Służy](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) do konfigurowania [oprogramowania pośredniczącego](xref:fundamentals/middleware/index)w wierszu.</span><span class="sxs-lookup"><span data-stu-id="3660c-199">In the preceding code, [app.Use](xref:Microsoft.AspNetCore.Builder.UseExtensions.Use*) configures an in-line [middleware](xref:fundamentals/middleware/index).</span></span>

<a name="mt"></a>

<span data-ttu-id="3660c-200">Poniższy kod pokazuje, że w zależności od tego, gdzie `app.Use` jest wywoływana w potoku, nie może istnieć punkt końcowy:</span><span class="sxs-lookup"><span data-stu-id="3660c-200">The following code shows that, depending on where `app.Use` is called in the pipeline, there may not be an endpoint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/MiddlewareFlowStartup.cs?name=snippet)]

<span data-ttu-id="3660c-201">Ten poprzedni przykład dodaje `Console.WriteLine` instrukcje, które wyświetlają czy punkt końcowy został wybrany.</span><span class="sxs-lookup"><span data-stu-id="3660c-201">This preceding sample adds `Console.WriteLine` statements that display whether or not an endpoint has been selected.</span></span> <span data-ttu-id="3660c-202">Dla jasności przykład przypisuje nazwę wyświetlaną do podanego `/` punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-202">For clarity, the sample assigns a display name to the provided `/` endpoint.</span></span>

<span data-ttu-id="3660c-203">Uruchomienie tego kodu z adresem URL `/` wyświetlanymi:</span><span class="sxs-lookup"><span data-stu-id="3660c-203">Running this code with a URL of `/` displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: Hello
3. Endpoint: Hello
```

<span data-ttu-id="3660c-204">Uruchomienie tego kodu z dowolnym innym adresem URL powoduje wyświetlenie:</span><span class="sxs-lookup"><span data-stu-id="3660c-204">Running this code with any other URL displays:</span></span>

```txt
1. Endpoint: (null)
2. Endpoint: (null)
4. Endpoint: (null)
```

<span data-ttu-id="3660c-205">Te dane wyjściowe pokazują, że:</span><span class="sxs-lookup"><span data-stu-id="3660c-205">This output demonstrates that:</span></span>

* <span data-ttu-id="3660c-206">Punkt końcowy ma zawsze wartość null przed `UseRouting` wywołaniem metody.</span><span class="sxs-lookup"><span data-stu-id="3660c-206">The endpoint is always null before `UseRouting` is called.</span></span>
* <span data-ttu-id="3660c-207">W przypadku znalezienia dopasowania punkt końcowy nie ma wartości null między `UseRouting` i <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-207">If a match is found, the endpoint is non-null between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="3660c-208">`UseEndpoints`Oprogramowanie pośredniczące jest **terminalem** , gdy zostanie znalezione dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-208">The `UseEndpoints` middleware is **terminal** when a match is found.</span></span> <span data-ttu-id="3660c-209">[Oprogramowanie pośredniczące terminalu](#tm) zostało zdefiniowane w dalszej części tego dokumentu.</span><span class="sxs-lookup"><span data-stu-id="3660c-209">[Terminal middleware](#tm) is defined later in this document.</span></span>
* <span data-ttu-id="3660c-210">Oprogramowanie pośredniczące po wykonaniu tylko wtedy, `UseEndpoints` gdy nie zostanie znalezione żadne dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-210">The middleware after `UseEndpoints` execute only when no match is found.</span></span>

<span data-ttu-id="3660c-211">`UseRouting`Oprogramowanie pośredniczące używa metody [setendpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) do dołączania punktu końcowego do bieżącego kontekstu.</span><span class="sxs-lookup"><span data-stu-id="3660c-211">The `UseRouting` middleware uses the [SetEndpoint](xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.SetEndpoint*) method to attach the endpoint to the current context.</span></span> <span data-ttu-id="3660c-212">Można zastąpić `UseRouting` oprogramowanie pośredniczące logiką niestandardową i nadal korzystać z punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-212">It's possible to replace the `UseRouting` middleware with custom logic and still get the benefits of using endpoints.</span></span> <span data-ttu-id="3660c-213">Punkty końcowe są typu podstawowego niskiego poziomu, takiego jak oprogramowanie pośredniczące, i nie są połączone z implementacją routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-213">Endpoints are a low-level primitive like middleware, and aren't coupled to the routing implementation.</span></span> <span data-ttu-id="3660c-214">Większość aplikacji nie musi zastąpić `UseRouting` logiki niestandardowej.</span><span class="sxs-lookup"><span data-stu-id="3660c-214">Most apps don't need to replace `UseRouting` with custom logic.</span></span>

<span data-ttu-id="3660c-215">`UseEndpoints`Oprogramowanie pośredniczące jest przeznaczone do użycia wspólnie z programem `UseRouting` pośredniczącym.</span><span class="sxs-lookup"><span data-stu-id="3660c-215">The `UseEndpoints` middleware is designed to be used in tandem with the `UseRouting` middleware.</span></span> <span data-ttu-id="3660c-216">Logika podstawowa do wykonania punktu końcowego nie jest skomplikowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-216">The core logic to execute an endpoint isn't complicated.</span></span> <span data-ttu-id="3660c-217">Użyj <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> do pobrania punktu końcowego, a następnie Wywołaj jego <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> Właściwość.</span><span class="sxs-lookup"><span data-stu-id="3660c-217">Use <xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*> to retrieve the endpoint, and then invoke its <xref:Microsoft.AspNetCore.Http.Endpoint.RequestDelegate> property.</span></span>

<span data-ttu-id="3660c-218">Poniższy kod ilustruje sposób, w jaki oprogramowanie pośredniczące może mieć wpływ na Routing lub reagować na nie:</span><span class="sxs-lookup"><span data-stu-id="3660c-218">The following code demonstrates how middleware can influence or react to routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/IntegratedMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="3660c-219">W poprzednim przykładzie pokazano dwa ważne pojęcia:</span><span class="sxs-lookup"><span data-stu-id="3660c-219">The preceding example demonstrates two important concepts:</span></span>

* <span data-ttu-id="3660c-220">Oprogramowanie pośredniczące może zostać uruchomione przed `UseRouting` modyfikacją danych, na których działa Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-220">Middleware can run before `UseRouting` to modify the data that routing operates upon.</span></span>
    * <span data-ttu-id="3660c-221">Zazwyczaj oprogramowanie pośredniczące, które pojawia się przed wybraniem trasy modyfikuje pewne właściwości żądania, takie jak <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*> , <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*> lub <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-221">Usually middleware that appears before routing modifies some property of the request, such as <xref:Microsoft.AspNetCore.Builder.RewriteBuilderExtensions.UseRewriter*>, <xref:Microsoft.AspNetCore.Builder.HttpMethodOverrideExtensions.UseHttpMethodOverride*>, or <xref:Microsoft.AspNetCore.Builder.UsePathBaseExtensions.UsePathBase*>.</span></span>
* <span data-ttu-id="3660c-222">Oprogramowanie pośredniczące może działać między programami `UseRouting` i, <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> Aby przetwarzać wyniki routingu przed wykonaniem punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-222">Middleware can run between `UseRouting` and <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> to process the results of routing before the endpoint is executed.</span></span>
    * <span data-ttu-id="3660c-223">Oprogramowanie pośredniczące, które działa między `UseRouting` i `UseEndpoints` :</span><span class="sxs-lookup"><span data-stu-id="3660c-223">Middleware that runs between `UseRouting` and `UseEndpoints`:</span></span>
      * <span data-ttu-id="3660c-224">Zwykle sprawdza metadane, aby zrozumieć punkty końcowe.</span><span class="sxs-lookup"><span data-stu-id="3660c-224">Usually inspects metadata to understand the endpoints.</span></span>
      * <span data-ttu-id="3660c-225">Często podejmuje decyzje dotyczące zabezpieczeń, zgodnie z oczekiwaniami `UseAuthorization` i `UseCors` .</span><span class="sxs-lookup"><span data-stu-id="3660c-225">Often makes security decisions, as done by `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="3660c-226">Kombinacja oprogramowania pośredniczącego i metadanych umożliwia konfigurowanie zasad dla poszczególnych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-226">The combination of middleware and metadata allows configuring policies per-endpoint.</span></span>

<span data-ttu-id="3660c-227">Powyższy kod przedstawia przykład niestandardowego oprogramowania pośredniczącego, które obsługuje zasady dotyczące poszczególnych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-227">The preceding code shows an example of a custom middleware that supports per-endpoint policies.</span></span> <span data-ttu-id="3660c-228">Oprogramowanie pośredniczące zapisuje *Dziennik inspekcji* dostępu do poufnych danych w konsoli programu.</span><span class="sxs-lookup"><span data-stu-id="3660c-228">The middleware writes an *audit log* of access to sensitive data to the console.</span></span> <span data-ttu-id="3660c-229">Oprogramowanie pośredniczące można skonfigurować do *inspekcji* punktu końcowego przy użyciu `AuditPolicyAttribute` metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-229">The middleware can be configured to *audit* an endpoint with the `AuditPolicyAttribute` metadata.</span></span> <span data-ttu-id="3660c-230">Ten przykład pokazuje wzorzec *wyboru, w* którym są poddawane inspekcji tylko punkty końcowe oznaczone jako poufne.</span><span class="sxs-lookup"><span data-stu-id="3660c-230">This sample demonstrates an *opt-in* pattern where only endpoints that are marked as sensitive are audited.</span></span> <span data-ttu-id="3660c-231">Istnieje możliwość zdefiniowania tej logiki na odwrót, przeprowadzenia inspekcji wszystkich elementów, które nie są oznaczone jako bezpieczne, na przykład.</span><span class="sxs-lookup"><span data-stu-id="3660c-231">It's possible to define this logic in reverse, auditing everything that isn't marked as safe, for example.</span></span> <span data-ttu-id="3660c-232">System metadanych punktu końcowego jest elastyczny.</span><span class="sxs-lookup"><span data-stu-id="3660c-232">The endpoint metadata system is flexible.</span></span> <span data-ttu-id="3660c-233">Ta logika może być zaprojektowana w dowolny sposób, jak w przypadku użycia.</span><span class="sxs-lookup"><span data-stu-id="3660c-233">This logic could be designed in whatever way suits the use case.</span></span>

<span data-ttu-id="3660c-234">Poprzedni przykładowy kod jest przeznaczony do zademonstrowania podstawowych koncepcji punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-234">The preceding sample code is intended to demonstrate the basic concepts of endpoints.</span></span> <span data-ttu-id="3660c-235">**Przykład nie jest przeznaczony do użycia w środowisku produkcyjnym**.</span><span class="sxs-lookup"><span data-stu-id="3660c-235">**The sample is not intended for production use**.</span></span> <span data-ttu-id="3660c-236">Bardziej kompletna wersja oprogramowania pośredniczącego *dziennika inspekcji* :</span><span class="sxs-lookup"><span data-stu-id="3660c-236">A more complete version of an *audit log* middleware would:</span></span>

* <span data-ttu-id="3660c-237">Zaloguj się do pliku lub bazy danych.</span><span class="sxs-lookup"><span data-stu-id="3660c-237">Log to a file or database.</span></span>
* <span data-ttu-id="3660c-238">Dołącz szczegóły, takie jak użytkownik, adres IP, nazwa poufnego punktu końcowego itd.</span><span class="sxs-lookup"><span data-stu-id="3660c-238">Include details such as the user, IP address, name of the sensitive endpoint, and more.</span></span>

<span data-ttu-id="3660c-239">Metadane zasad inspekcji `AuditPolicyAttribute` są zdefiniowane jako `Attribute` ułatwiające korzystanie z struktur opartych na klasach, takich jak kontrolery i SignalR .</span><span class="sxs-lookup"><span data-stu-id="3660c-239">The audit policy metadata `AuditPolicyAttribute` is defined as an `Attribute` for easier use with class-based frameworks such as controllers and SignalR.</span></span> <span data-ttu-id="3660c-240">W przypadku używania *trasy do kodu*:</span><span class="sxs-lookup"><span data-stu-id="3660c-240">When using *route to code*:</span></span>

* <span data-ttu-id="3660c-241">Metadane są dołączone do interfejsu API programu Builder.</span><span class="sxs-lookup"><span data-stu-id="3660c-241">Metadata is attached with a builder API.</span></span>
* <span data-ttu-id="3660c-242">Struktury oparte na klasie obejmują wszystkie atrybuty w odpowiedniej metodzie i klasie podczas tworzenia punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-242">Class-based frameworks include all attributes on the corresponding method and class when creating endpoints.</span></span>

<span data-ttu-id="3660c-243">Najlepszymi rozwiązaniami dotyczącymi typów metadanych są Definiowanie ich jako interfejsów lub atrybutów.</span><span class="sxs-lookup"><span data-stu-id="3660c-243">The best practices for metadata types are to define them either as interfaces or attributes.</span></span> <span data-ttu-id="3660c-244">Interfejsy i atrybuty umożliwiają ponowne użycie kodu.</span><span class="sxs-lookup"><span data-stu-id="3660c-244">Interfaces and attributes allow code reuse.</span></span> <span data-ttu-id="3660c-245">System metadanych jest elastyczny i nie nakłada żadnych ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="3660c-245">The metadata system is flexible and doesn't impose any limitations.</span></span>

<a name="tm"></a>

### <a name="comparing-a-terminal-middleware-and-routing"></a><span data-ttu-id="3660c-246">Porównanie oprogramowania pośredniczącego i routingu terminalu</span><span class="sxs-lookup"><span data-stu-id="3660c-246">Comparing a terminal middleware and routing</span></span>

<span data-ttu-id="3660c-247">Poniższy przykładowy kod kontrast korzystający z oprogramowania pośredniczącego z użyciem routingu:</span><span class="sxs-lookup"><span data-stu-id="3660c-247">The following code sample contrasts using middleware with using routing:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/TerminalMiddlewareStartup.cs?name=snippet)]

<span data-ttu-id="3660c-248">Styl oprogramowania pośredniczącego widoczny w programie `Approach 1:` to **terminalowe oprogramowanie pośredniczące**.</span><span class="sxs-lookup"><span data-stu-id="3660c-248">The style of middleware shown with `Approach 1:` is **terminal middleware**.</span></span> <span data-ttu-id="3660c-249">Jest on nazywany oprogramowanie pośredniczące terminalu, ponieważ wykonuje operację zgodną:</span><span class="sxs-lookup"><span data-stu-id="3660c-249">It's called terminal middleware because it does a matching operation:</span></span>

* <span data-ttu-id="3660c-250">Operacja dopasowywania w poprzednim przykładzie dotyczy `Path == "/"` oprogramowania pośredniczącego i `Path == "/Movie"` routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-250">The matching operation in the preceding sample is `Path == "/"` for the middleware and `Path == "/Movie"` for routing.</span></span>
* <span data-ttu-id="3660c-251">Gdy dopasowanie zakończy się pomyślnie, wykonuje pewne funkcje i zwraca zamiast wywoływania `next` oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-251">When a match is successful, it executes some functionality and returns, rather than invoking the `next` middleware.</span></span>

<span data-ttu-id="3660c-252">Jest on nazywany oprogramowanie pośredniczące terminalu, ponieważ kończy wyszukiwanie, wykonuje pewne funkcje, a następnie zwraca.</span><span class="sxs-lookup"><span data-stu-id="3660c-252">It's called terminal middleware because it terminates the search, executes some functionality, and then returns.</span></span>

<span data-ttu-id="3660c-253">Porównanie oprogramowania pośredniczącego i routingu w terminalu:</span><span class="sxs-lookup"><span data-stu-id="3660c-253">Comparing a terminal middleware and routing:</span></span>
* <span data-ttu-id="3660c-254">Obie metody umożliwiają zakończenie potoku przetwarzania:</span><span class="sxs-lookup"><span data-stu-id="3660c-254">Both approaches allow terminating the processing pipeline:</span></span>
    * <span data-ttu-id="3660c-255">Oprogramowanie pośredniczące kończy potok przez zwrócenie zamiast wywoływania `next` .</span><span class="sxs-lookup"><span data-stu-id="3660c-255">Middleware terminates the pipeline by returning rather than invoking `next`.</span></span>
    * <span data-ttu-id="3660c-256">Punkty końcowe są zawsze terminalem.</span><span class="sxs-lookup"><span data-stu-id="3660c-256">Endpoints are always terminal.</span></span>
* <span data-ttu-id="3660c-257">Oprogramowanie pośredniczące terminalu umożliwia rozmieszczenie oprogramowania pośredniczącego w dowolnym miejscu w potoku:</span><span class="sxs-lookup"><span data-stu-id="3660c-257">Terminal middleware allows positioning the middleware at an arbitrary place in the pipeline:</span></span>
    * <span data-ttu-id="3660c-258">Punkty końcowe są wykonywane na pozycji <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-258">Endpoints execute at the position of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>
* <span data-ttu-id="3660c-259">Oprogramowanie pośredniczące terminalu umożliwia dowolny kod, aby określić, kiedy oprogramowanie pośredniczące jest zgodne:</span><span class="sxs-lookup"><span data-stu-id="3660c-259">Terminal middleware allows arbitrary code to determine when the middleware matches:</span></span>
    * <span data-ttu-id="3660c-260">Niestandardowy kod dopasowania trasy może być pełny i trudny do poprawnego zapisu.</span><span class="sxs-lookup"><span data-stu-id="3660c-260">Custom route matching code can be verbose and difficult to write correctly.</span></span>
    * <span data-ttu-id="3660c-261">Routing oferuje proste rozwiązania dla typowych aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-261">Routing provides straightforward solutions for typical apps.</span></span> <span data-ttu-id="3660c-262">Większość aplikacji nie wymaga niestandardowego kodu dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-262">Most apps don't require custom route matching code.</span></span>
* <span data-ttu-id="3660c-263">Interfejs punktów końcowych z oprogramowaniemi pośredniczącymi, takimi jak `UseAuthorization` i `UseCors` .</span><span class="sxs-lookup"><span data-stu-id="3660c-263">Endpoints interface with middleware such as `UseAuthorization` and `UseCors`.</span></span>
    * <span data-ttu-id="3660c-264">Korzystanie z oprogramowania terminalowego z `UseAuthorization` `UseCors` systemem lub wymaga ręcznej obsługi systemu autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-264">Using a terminal middleware with `UseAuthorization` or `UseCors` requires manual interfacing with the authorization system.</span></span>

<span data-ttu-id="3660c-265">[Punkt końcowy](#endpoint) definiuje oba:</span><span class="sxs-lookup"><span data-stu-id="3660c-265">An [endpoint](#endpoint) defines both:</span></span>

* <span data-ttu-id="3660c-266">Delegat do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="3660c-266">A delegate to process requests.</span></span>
* <span data-ttu-id="3660c-267">Kolekcja dowolnych metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-267">A collection of arbitrary metadata.</span></span> <span data-ttu-id="3660c-268">Metadane służą do implementowania zagadnień związanych z wycinaniem w oparciu o zasady i konfigurację dołączone do każdego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-268">The metadata is used to implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="3660c-269">Oprogramowanie pośredniczące terminalu może być skutecznym narzędziem, ale może wymagać:</span><span class="sxs-lookup"><span data-stu-id="3660c-269">Terminal middleware can be an effective tool, but can require:</span></span>

* <span data-ttu-id="3660c-270">Znaczna ilość kodu i testowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-270">A significant amount of coding and testing.</span></span>
* <span data-ttu-id="3660c-271">Ręczna integracja z innymi systemami w celu osiągnięcia odpowiedniego poziomu elastyczności.</span><span class="sxs-lookup"><span data-stu-id="3660c-271">Manual integration with other systems to achieve the desired level of flexibility.</span></span>

<span data-ttu-id="3660c-272">Rozważ integrację z routingiem przed zapisaniem oprogramowania pośredniczącego terminalu.</span><span class="sxs-lookup"><span data-stu-id="3660c-272">Consider integrating with routing before writing a terminal middleware.</span></span>

<span data-ttu-id="3660c-273">Istniejące oprogramowanie pośredniczące, które integruje się z usługą [map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) lub <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> zwykle może być przełączane do punktu końcowego z obsługą routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-273">Existing terminal middleware that integrates with [Map](xref:fundamentals/middleware/index#branch-the-middleware-pipeline) or <xref:Microsoft.AspNetCore.Builder.MapWhenExtensions.MapWhen*> can usually be turned into a routing aware endpoint.</span></span> <span data-ttu-id="3660c-274">[MapHealthChecks](https://github.com/dotnet/AspNetCore/blob/main/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstruje wzorzec dla:</span><span class="sxs-lookup"><span data-stu-id="3660c-274">[MapHealthChecks](https://github.com/dotnet/AspNetCore/blob/main/src/Middleware/HealthChecks/src/Builder/HealthCheckEndpointRouteBuilderExtensions.cs#L16) demonstrates the pattern for router-ware:</span></span>
* <span data-ttu-id="3660c-275">Napisz metodę rozszerzenia <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-275">Write an extension method on <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span>
* <span data-ttu-id="3660c-276">Utwórz zagnieżdżony potok oprogramowania pośredniczącego przy użyciu programu <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-276">Create a nested middleware pipeline using <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder.CreateApplicationBuilder*>.</span></span>
* <span data-ttu-id="3660c-277">Dołącz oprogramowanie pośredniczące do nowego potoku.</span><span class="sxs-lookup"><span data-stu-id="3660c-277">Attach the middleware to the new pipeline.</span></span> <span data-ttu-id="3660c-278">W takim przypadku <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-278">In this case, <xref:Microsoft.AspNetCore.Builder.HealthCheckApplicationBuilderExtensions.UseHealthChecks*>.</span></span>
* <span data-ttu-id="3660c-279"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> Oprogramowanie pośredniczące w usłudze <xref:Microsoft.AspNetCore.Http.RequestDelegate> .</span><span class="sxs-lookup"><span data-stu-id="3660c-279"><xref:Microsoft.AspNetCore.Builder.IApplicationBuilder.Build*> the middleware pipeline into a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span>
* <span data-ttu-id="3660c-280">Wywołaj `Map` i podaj nowy potok pośredniczący.</span><span class="sxs-lookup"><span data-stu-id="3660c-280">Call `Map` and provide the new middleware pipeline.</span></span>
* <span data-ttu-id="3660c-281">Zwraca obiekt konstruktora dostarczony przez `Map` metodę rozszerzającą.</span><span class="sxs-lookup"><span data-stu-id="3660c-281">Return the builder object provided by `Map` from the extension method.</span></span>

<span data-ttu-id="3660c-282">Poniższy kod przedstawia użycie [MapHealthChecks](xref:host-and-deploy/health-checks):</span><span class="sxs-lookup"><span data-stu-id="3660c-282">The following code shows use of [MapHealthChecks](xref:host-and-deploy/health-checks):</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/AuthorizationStartup.cs?name=snippet)]

<span data-ttu-id="3660c-283">Poprzedni przykład pokazuje, dlaczego zwrócenie obiektu konstruktora jest ważne.</span><span class="sxs-lookup"><span data-stu-id="3660c-283">The preceding sample shows why returning the builder object is important.</span></span> <span data-ttu-id="3660c-284">Zwrócenie obiektu konstruktora umożliwia deweloperowi aplikacji Konfigurowanie zasad, takich jak autoryzacja dla punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-284">Returning the builder object allows the app developer to configure policies such as authorization for the endpoint.</span></span> <span data-ttu-id="3660c-285">W tym przykładzie oprogramowanie do sprawdzania kondycji nie ma bezpośredniej integracji z systemem autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-285">In this example, the health checks middleware has no direct integration with the authorization system.</span></span>

<span data-ttu-id="3660c-286">System metadanych został utworzony w odpowiedzi na problemy napotykane przez autorów rozszerzalności przy użyciu oprogramowania terminalu.</span><span class="sxs-lookup"><span data-stu-id="3660c-286">The metadata system was created in response to the problems encountered by extensibility authors using terminal middleware.</span></span> <span data-ttu-id="3660c-287">Jest to problematyczne dla każdego oprogramowania pośredniczącego, aby wdrożyć własną integrację z systemem autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-287">It's problematic for each middleware to implement its own integration with the authorization system.</span></span>

<a name="urlm"></a>

### <a name="url-matching"></a><span data-ttu-id="3660c-288">Dopasowanie adresu URL</span><span class="sxs-lookup"><span data-stu-id="3660c-288">URL matching</span></span>

* <span data-ttu-id="3660c-289">To proces, za pomocą którego Routing dopasowuje żądanie przychodzące do [punktu końcowego](#endpoint).</span><span class="sxs-lookup"><span data-stu-id="3660c-289">Is the process by which routing matches an incoming request to an [endpoint](#endpoint).</span></span>
* <span data-ttu-id="3660c-290">Jest oparty na danych w ścieżce URL i nagłówkach.</span><span class="sxs-lookup"><span data-stu-id="3660c-290">Is based on data in the URL path and headers.</span></span>
* <span data-ttu-id="3660c-291">Można rozszerzyć, aby uwzględnić dowolne dane w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="3660c-291">Can be extended to consider any data in the request.</span></span>

<span data-ttu-id="3660c-292">Po zakończeniu routingu oprogramowanie pośredniczące ustawia `Endpoint` wartości i trasy do [funkcji żądania](xref:fundamentals/request-features) na <xref:Microsoft.AspNetCore.Http.HttpContext> podstawie bieżącego żądania:</span><span class="sxs-lookup"><span data-stu-id="3660c-292">When a routing middleware executes, it sets an `Endpoint` and route values to a [request feature](xref:fundamentals/request-features) on the <xref:Microsoft.AspNetCore.Http.HttpContext> from the current request:</span></span>

* <span data-ttu-id="3660c-293">Wywołanie metody [HttpContext. GetEndPoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) Pobiera punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="3660c-293">Calling [HttpContext.GetEndpoint](<xref:Microsoft.AspNetCore.Http.EndpointHttpContextExtensions.GetEndpoint*>) gets the endpoint.</span></span>
* <span data-ttu-id="3660c-294">`HttpRequest.RouteValues` Pobiera kolekcję wartości tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-294">`HttpRequest.RouteValues` gets the collection of route values.</span></span>

<span data-ttu-id="3660c-295">[Oprogramowanie pośredniczące](xref:fundamentals/middleware/index) działające po kierowaniu oprogramowania pośredniczącego może sprawdzić punkt końcowy i podjąć odpowiednie działania.</span><span class="sxs-lookup"><span data-stu-id="3660c-295">[Middleware](xref:fundamentals/middleware/index) running after the routing middleware can inspect the endpoint and take action.</span></span> <span data-ttu-id="3660c-296">Na przykład, oprogramowanie pośredniczące autoryzacji może przejrzeć kolekcję metadanych punktu końcowego dla zasad autoryzacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-296">For example, an authorization middleware can interrogate the endpoint's metadata collection for an authorization policy.</span></span> <span data-ttu-id="3660c-297">Gdy zostanie wykonane wszystkie oprogramowanie pośredniczące w potoku przetwarzania żądań, zostanie wywołany delegat wybranego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-297">After all of the middleware in the request processing pipeline is executed, the selected endpoint's delegate is invoked.</span></span>

<span data-ttu-id="3660c-298">System routingu w ramach routingu punktów końcowych jest odpowiedzialny za wszystkie decyzje dotyczące wysyłania.</span><span class="sxs-lookup"><span data-stu-id="3660c-298">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="3660c-299">Ponieważ oprogramowanie pośredniczące stosuje zasady oparte na wybranym punkcie końcowym, ważne jest, aby:</span><span class="sxs-lookup"><span data-stu-id="3660c-299">Because the middleware applies policies based on the selected endpoint, it's important that:</span></span>

* <span data-ttu-id="3660c-300">Wszelkie decyzje, które mogą mieć wpływ na wysyłanie lub stosowanie zasad zabezpieczeń, odbywa się w systemie routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-300">Any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

> [!WARNING]
> <span data-ttu-id="3660c-301">W celu zapewnienia zgodności z poprzednimi wersjami, gdy Razor jest wykonywany delegat kontrolera lub stron, właściwości [RouteContext. RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) są ustawiane na odpowiednie wartości na podstawie przetwarzania żądania wykonanego do tej pory.</span><span class="sxs-lookup"><span data-stu-id="3660c-301">For backwards-compatibility, when a Controller or Razor Pages endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>
>
> <span data-ttu-id="3660c-302">`RouteContext`Typ zostanie oznaczony jako przestarzały w przyszłej wersji:</span><span class="sxs-lookup"><span data-stu-id="3660c-302">The `RouteContext` type will be marked obsolete in a future release:</span></span>
>
> * <span data-ttu-id="3660c-303">Migruj `RouteData.Values` do programu `HttpRequest.RouteValues` .</span><span class="sxs-lookup"><span data-stu-id="3660c-303">Migrate `RouteData.Values` to `HttpRequest.RouteValues`.</span></span>
> * <span data-ttu-id="3660c-304">Migruj `RouteData.DataTokens` do pobierania [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) z metadanych punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-304">Migrate `RouteData.DataTokens` to retrieve [IDataTokensMetadata](xref:Microsoft.AspNetCore.Routing.IDataTokensMetadata) from the endpoint metadata.</span></span>

<span data-ttu-id="3660c-305">Dopasowywanie adresów URL działa w konfigurowalnym zestawie faz.</span><span class="sxs-lookup"><span data-stu-id="3660c-305">URL matching operates in a configurable set of phases.</span></span> <span data-ttu-id="3660c-306">W każdej fazie dane wyjściowe są zestawem dopasowań.</span><span class="sxs-lookup"><span data-stu-id="3660c-306">In each phase, the output is a set of matches.</span></span> <span data-ttu-id="3660c-307">Zestaw dopasowań można zawęzić dalej w następnej fazie.</span><span class="sxs-lookup"><span data-stu-id="3660c-307">The set of matches can be narrowed down further by the next phase.</span></span> <span data-ttu-id="3660c-308">Implementacja routingu nie gwarantuje kolejności przetwarzania pasujących punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-308">The routing implementation does not guarantee a processing order for matching endpoints.</span></span> <span data-ttu-id="3660c-309">**Wszystkie** możliwe dopasowania są przetwarzane jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="3660c-309">**All** possible matches are processed at once.</span></span> <span data-ttu-id="3660c-310">Fazy dopasowywania adresów URL są wykonywane w następującej kolejności.</span><span class="sxs-lookup"><span data-stu-id="3660c-310">The URL matching phases occur in the following order.</span></span> <span data-ttu-id="3660c-311">ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3660c-311">ASP.NET Core:</span></span>

1. <span data-ttu-id="3660c-312">Przetwarza ścieżkę URL względem zestawu punktów końcowych i ich szablonów tras, zbierając **wszystkie** dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-312">Processes the URL path against the set of endpoints and their route templates, collecting **all** of the matches.</span></span>
1. <span data-ttu-id="3660c-313">Pobiera poprzednią listę i usuwa dopasowania, które kończą się niepowodzeniem z zastosowaniem ograniczeń trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-313">Takes the preceding list and removes matches that fail with route constraints applied.</span></span>
1. <span data-ttu-id="3660c-314">Pobiera poprzednią listę i usuwa dopasowania, które kończą się niepowodzeniem zestawu wystąpień [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) .</span><span class="sxs-lookup"><span data-stu-id="3660c-314">Takes the preceding list and removes matches that fail the set of [MatcherPolicy](xref:Microsoft.AspNetCore.Routing.MatcherPolicy) instances.</span></span>
1. <span data-ttu-id="3660c-315">Używa [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) , aby przeprowadzić ostateczną decyzję z poprzedniej listy.</span><span class="sxs-lookup"><span data-stu-id="3660c-315">Uses the [EndpointSelector](xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector) to make a final decision from the preceding list.</span></span>

<span data-ttu-id="3660c-316">Lista punktów końcowych jest określana według priorytetów według:</span><span class="sxs-lookup"><span data-stu-id="3660c-316">The list of endpoints is prioritized according to:</span></span>

* <span data-ttu-id="3660c-317">[RouteEndpoint. Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span><span class="sxs-lookup"><span data-stu-id="3660c-317">The [RouteEndpoint.Order](xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order*)</span></span>
* <span data-ttu-id="3660c-318">[Pierwszeństwo szablonu trasy](#rtp)</span><span class="sxs-lookup"><span data-stu-id="3660c-318">The [route template precedence](#rtp)</span></span>

<span data-ttu-id="3660c-319">Wszystkie zgodne punkty końcowe są przetwarzane w każdej fazie aż do <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> osiągnięcia.</span><span class="sxs-lookup"><span data-stu-id="3660c-319">All matching endpoints are processed in each phase until the <xref:Microsoft.AspNetCore.Routing.Matching.EndpointSelector> is reached.</span></span> <span data-ttu-id="3660c-320">`EndpointSelector`Jest to Faza końcowa.</span><span class="sxs-lookup"><span data-stu-id="3660c-320">The `EndpointSelector` is the final phase.</span></span> <span data-ttu-id="3660c-321">Wybiera punkt końcowy o najwyższym priorytecie z dopasowań w miarę najlepszego dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-321">It chooses the highest priority endpoint from the matches as the best match.</span></span> <span data-ttu-id="3660c-322">Jeśli istnieją inne dopasowania o takim samym priorytecie jak najlepsze dopasowanie, zostanie zgłoszony wyjątek niejednoznacznej zgodności.</span><span class="sxs-lookup"><span data-stu-id="3660c-322">If there are other matches with the same priority as the best match, an ambiguous match exception is thrown.</span></span>

<span data-ttu-id="3660c-323">Pierwszeństwo trasy jest obliczane na podstawie **bardziej szczegółowego** szablonu trasy o wyższym priorytecie.</span><span class="sxs-lookup"><span data-stu-id="3660c-323">The route precedence is computed based on a **more specific** route template being given a higher priority.</span></span> <span data-ttu-id="3660c-324">Rozważmy na przykład szablony `/hello` i `/{message}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-324">For example, consider the templates `/hello` and `/{message}`:</span></span>

* <span data-ttu-id="3660c-325">Oba pasują do ścieżki URL `/hello` .</span><span class="sxs-lookup"><span data-stu-id="3660c-325">Both match the URL path `/hello`.</span></span>
* <span data-ttu-id="3660c-326">`/hello`  jest bardziej szczegółowy i dlatego wyższy priorytet.</span><span class="sxs-lookup"><span data-stu-id="3660c-326">`/hello`  is more specific and therefore higher priority.</span></span>

<span data-ttu-id="3660c-327">Ogólnie rzecz biorąc, pierwszeństwo trasy jest dobrym zadaniem do wyboru najlepszego dopasowania dla rodzajów schematów adresów URL używanych w ćwiczeniach.</span><span class="sxs-lookup"><span data-stu-id="3660c-327">In general, route precedence does a good job of choosing the best match for the kinds of URL schemes used in practice.</span></span> <span data-ttu-id="3660c-328">Użyj <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> tylko w razie potrzeby, aby uniknąć niejednoznaczności.</span><span class="sxs-lookup"><span data-stu-id="3660c-328">Use <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.Order> only when necessary to avoid an ambiguity.</span></span>

<span data-ttu-id="3660c-329">Ze względu na rodzaje rozszerzalności udostępniane przez usługę Routing nie jest możliwe, aby system routingu był obliczany przed czasem niejednoznacznych tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-329">Due to the kinds of extensibility provided by routing, it isn't possible for the routing system to compute ahead of time the ambiguous routes.</span></span> <span data-ttu-id="3660c-330">Rozważmy przykład takich jak szablony tras `/{message:alpha}` i `/{message:int}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-330">Consider an example such as the route templates `/{message:alpha}` and `/{message:int}`:</span></span>

* <span data-ttu-id="3660c-331">`alpha`Ograniczenie pasuje tylko do znaków alfanumerycznych.</span><span class="sxs-lookup"><span data-stu-id="3660c-331">The `alpha` constraint matches only alphabetic characters.</span></span>
* <span data-ttu-id="3660c-332">`int`Ograniczenie jest zgodne tylko z liczbami.</span><span class="sxs-lookup"><span data-stu-id="3660c-332">The `int` constraint matches only numbers.</span></span>
* <span data-ttu-id="3660c-333">Te szablony mają ten sam priorytet trasy, ale nie istnieje pojedynczy adres URL, który oba są zgodne.</span><span class="sxs-lookup"><span data-stu-id="3660c-333">These templates have the same route precedence, but there's no single URL they both match.</span></span>
* <span data-ttu-id="3660c-334">Jeśli system routingu zgłosił błąd niejednoznaczności przy uruchamianiu, powinien zablokować ten prawidłowy przypadek użycia.</span><span class="sxs-lookup"><span data-stu-id="3660c-334">If the routing system reported an ambiguity error at startup, it would block this valid use case.</span></span>

> [!WARNING]
>
> <span data-ttu-id="3660c-335">Kolejność operacji wewnątrz <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> nie wpływa na zachowanie routingu, z wyjątkiem jednego wyjątku.</span><span class="sxs-lookup"><span data-stu-id="3660c-335">The order of operations inside <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> doesn't influence the behavior of routing, with one exception.</span></span> <span data-ttu-id="3660c-336"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> i <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> Automatycznie przypisz wartość zamówienia do punktów końcowych na podstawie kolejności, w której są wywoływane.</span><span class="sxs-lookup"><span data-stu-id="3660c-336"><xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> and <xref:Microsoft.AspNetCore.Builder.MvcAreaRouteBuilderExtensions.MapAreaRoute*> automatically assign an order value to their endpoints based on the order they are invoked.</span></span> <span data-ttu-id="3660c-337">Symuluje to długotrwałe zachowanie kontrolerów bez systemu routingu, zapewniając takie same gwarancje jak starsze implementacje routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-337">This simulates long-time behavior of controllers without the routing system providing the same guarantees as older routing implementations.</span></span>
>
> <span data-ttu-id="3660c-338">W starszej implementacji routingu możliwe jest wdrożenie rozszerzalności routingu, która ma zależność od kolejności przetwarzania tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-338">In the legacy implementation of routing, it's possible to implement routing extensibility that has a dependency on the order in which routes are processed.</span></span> <span data-ttu-id="3660c-339">Routing punktów końcowych w ASP.NET Core 3,0 i nowszych:</span><span class="sxs-lookup"><span data-stu-id="3660c-339">Endpoint routing in ASP.NET Core 3.0 and later:</span></span>
> 
> * <span data-ttu-id="3660c-340">Nie ma koncepcji tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-340">Doesn't have a concept of routes.</span></span>
> * <span data-ttu-id="3660c-341">Nie oferuje gwarancji porządkowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-341">Doesn't provide ordering guarantees.</span></span> <span data-ttu-id="3660c-342">Wszystkie punkty końcowe są przetwarzane jednocześnie.</span><span class="sxs-lookup"><span data-stu-id="3660c-342">All endpoints are processed at once.</span></span>

<a name="rtp"></a>

### <a name="route-template-precedence-and-endpoint-selection-order"></a><span data-ttu-id="3660c-343">Kolejność zaznaczania szablonu i punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="3660c-343">Route template precedence and endpoint selection order</span></span>

<span data-ttu-id="3660c-344">[Pierwszeństwo szablonu trasy](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) to system, który przypisuje każdemu szablonowi trasy wartość na podstawie ich określonego.</span><span class="sxs-lookup"><span data-stu-id="3660c-344">[Route template precedence](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Template/RoutePrecedence.cs#L16) is a system that assigns each route template a value based on how specific it is.</span></span> <span data-ttu-id="3660c-345">Pierwszeństwo szablonu trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-345">Route template precedence:</span></span>

* <span data-ttu-id="3660c-346">Pozwala uniknąć konieczności dostosowywania kolejności punktów końcowych w typowych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="3660c-346">Avoids the need to adjust the order of endpoints in common cases.</span></span>
* <span data-ttu-id="3660c-347">Podejmuje próbę dopasowania częstych oczekiwań związanych z routingiem.</span><span class="sxs-lookup"><span data-stu-id="3660c-347">Attempts to match the common-sense expectations of routing behavior.</span></span>

<span data-ttu-id="3660c-348">Rozważmy na przykład szablony `/Products/List` i `/Products/{id}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-348">For example, consider templates `/Products/List` and `/Products/{id}`.</span></span> <span data-ttu-id="3660c-349">Należy założyć, że `/Products/List` jest to lepszy odpowiednik niż `/Products/{id}` ścieżka URL `/Products/List` .</span><span class="sxs-lookup"><span data-stu-id="3660c-349">It would be reasonable to assume that `/Products/List` is a better match than `/Products/{id}` for the URL path `/Products/List`.</span></span> <span data-ttu-id="3660c-350">To działa, ponieważ segment literału `/List` jest uznawany za wyższy niż segment parametru `/{id}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-350">This works because the literal segment `/List` is considered to have better precedence than the parameter segment `/{id}`.</span></span>

<span data-ttu-id="3660c-351">Szczegóły dotyczące sposobu działania pierwszeństwa są powiązane ze sposobem definiowania szablonów tras:</span><span class="sxs-lookup"><span data-stu-id="3660c-351">The details of how precedence works are coupled to how route templates are defined:</span></span>

* <span data-ttu-id="3660c-352">Szablony o większej liczbie segmentów są uważane za bardziej szczegółowe.</span><span class="sxs-lookup"><span data-stu-id="3660c-352">Templates with more segments are considered more specific.</span></span>
* <span data-ttu-id="3660c-353">Segment z tekstem literału jest traktowany jako bardziej szczegółowy niż segment parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-353">A segment with literal text is considered more specific than a parameter segment.</span></span>
* <span data-ttu-id="3660c-354">Segment parametru z ograniczeniem jest uznawany za bardziej szczegółowy niż jeden bez.</span><span class="sxs-lookup"><span data-stu-id="3660c-354">A parameter segment with a constraint is considered more specific than one without.</span></span>
* <span data-ttu-id="3660c-355">Segment złożony jest uznawany za określony jako segment parametru z ograniczeniem.</span><span class="sxs-lookup"><span data-stu-id="3660c-355">A complex segment is considered as specific as a parameter segment with a constraint.</span></span>
* <span data-ttu-id="3660c-356">Catch-wszystkie parametry są najmniej określone.</span><span class="sxs-lookup"><span data-stu-id="3660c-356">Catch-all parameters are the least specific.</span></span> <span data-ttu-id="3660c-357">Aby uzyskać ważne informacje dotyczące przechwytywania wszystkich tras, zobacz temat **catch-all** w [dokumentacji dotyczącej szablonu trasy](#rtr) .</span><span class="sxs-lookup"><span data-stu-id="3660c-357">See **catch-all** in the [Route template reference](#rtr) for important information on catch-all routes.</span></span>

<span data-ttu-id="3660c-358">Zapoznaj się z [kodem źródłowym w witrynie GitHub](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) , aby uzyskać odwołanie do dokładnych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-358">See the [source code on GitHub](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Template/RoutePrecedence.cs#L189) for a reference of exact values.</span></span>

<a name="lg"></a>

### <a name="url-generation-concepts"></a><span data-ttu-id="3660c-359">Pojęcia związane z generowaniem adresów URL</span><span class="sxs-lookup"><span data-stu-id="3660c-359">URL generation concepts</span></span>

<span data-ttu-id="3660c-360">Generowanie adresu URL:</span><span class="sxs-lookup"><span data-stu-id="3660c-360">URL generation:</span></span>

* <span data-ttu-id="3660c-361">To proces, za pomocą którego Routing może utworzyć ścieżkę URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-361">Is the process by which routing can create a URL path based on a set of route values.</span></span>
* <span data-ttu-id="3660c-362">Umożliwia logiczne rozdzielenie między punktami końcowymi i adresami URL, które uzyskują do nich dostęp.</span><span class="sxs-lookup"><span data-stu-id="3660c-362">Allows for a logical separation between endpoints and the URLs that access them.</span></span>

<span data-ttu-id="3660c-363">Routing punktów końcowych obejmuje <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejs API.</span><span class="sxs-lookup"><span data-stu-id="3660c-363">Endpoint routing includes the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API.</span></span> <span data-ttu-id="3660c-364">`LinkGenerator` jest usługą pojedynczą dostępną w ramach programu [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="3660c-364">`LinkGenerator` is a singleton service available from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="3660c-365">`LinkGenerator`Interfejsu API można używać poza kontekstem żądania wykonania.</span><span class="sxs-lookup"><span data-stu-id="3660c-365">The `LinkGenerator` API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="3660c-366">[MVC. IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) i scenariusze, które są zależne <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> , takie jak [pomocnicy tagów](xref:mvc/views/tag-helpers/intro), pomocników HTML i [wyniki akcji](xref:mvc/controllers/actions), używają `LinkGenerator` wewnętrznie interfejsu API w celu zapewnienia możliwości generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-366">[Mvc.IUrlHelper](xref:Microsoft.AspNetCore.Mvc.IUrlHelper) and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the `LinkGenerator` API internally to provide link generating capabilities.</span></span>

<span data-ttu-id="3660c-367">Generator łącza jest objęty koncepcją i **schematami** **adresów.**</span><span class="sxs-lookup"><span data-stu-id="3660c-367">The link generator is backed by the concept of an **address** and **address schemes**.</span></span> <span data-ttu-id="3660c-368">Schemat adresów jest sposobem określania punktów końcowych, które należy wziąć pod uwagę podczas generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-368">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="3660c-369">Na przykład nazwa trasy i wartości trasy scenariusze wielu użytkowników są znane z kontrolerów, a Razor strony są implementowane jako schemat adresów.</span><span class="sxs-lookup"><span data-stu-id="3660c-369">For example, the route name and route values scenarios many users are familiar with from controllers and Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="3660c-370">Generator łącza może łączyć się z kontrolerami i Razor stronami przy użyciu następujących metod rozszerzających:</span><span class="sxs-lookup"><span data-stu-id="3660c-370">The link generator can link to controllers and Razor Pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="3660c-371">Przeciążenia tych metod akceptują argumenty, które obejmują `HttpContext` .</span><span class="sxs-lookup"><span data-stu-id="3660c-371">Overloads of these methods accept arguments that include the `HttpContext`.</span></span> <span data-ttu-id="3660c-372">Te metody są funkcjonalnie równoważne z [adresem URL. Action](xref:System.Web.Mvc.UrlHelper.Action*) i [URL. Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), ale oferują dodatkową elastyczność i opcje.</span><span class="sxs-lookup"><span data-stu-id="3660c-372">These methods are functionally equivalent to [Url.Action](xref:System.Web.Mvc.UrlHelper.Action*) and [Url.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*), but offer additional flexibility and options.</span></span>

<span data-ttu-id="3660c-373">`GetPath*`Metody są najbardziej podobne do `Url.Action` i `Url.Page` , w tym, że generują identyfikator URI zawierający ścieżkę bezwzględną.</span><span class="sxs-lookup"><span data-stu-id="3660c-373">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page`, in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="3660c-374">`GetUri*`Metody zawsze generują bezwzględny identyfikator URI zawierający schemat i hosta.</span><span class="sxs-lookup"><span data-stu-id="3660c-374">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="3660c-375">Metody, które akceptują `HttpContext` Identyfikator URI w kontekście żądania wykonania.</span><span class="sxs-lookup"><span data-stu-id="3660c-375">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="3660c-376">Użycie wartości tras w [otoczeniu](#ambient) , ścieżki podstawowej adresu URL, schematu i hosta z żądania wykonania jest używane, chyba że zostaną zastąpione.</span><span class="sxs-lookup"><span data-stu-id="3660c-376">The [ambient](#ambient) route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="3660c-377"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> jest wywoływana przy użyciu adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-377"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="3660c-378">Generowanie identyfikatora URI występuje w dwóch krokach:</span><span class="sxs-lookup"><span data-stu-id="3660c-378">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="3660c-379">Adres jest powiązany z listą punktów końcowych, które pasują do adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-379">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="3660c-380">Wszystkie punkty końcowe <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> są oceniane do momentu znalezienia wzorca tras pasującego do dostarczonych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-380">Each endpoint's <xref:Microsoft.AspNetCore.Routing.RouteEndpoint.RoutePattern> is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="3660c-381">Wynikowe dane wyjściowe są łączone z innymi częściami identyfikatora URI dostarczanymi do generatora linków i zwracanymi.</span><span class="sxs-lookup"><span data-stu-id="3660c-381">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="3660c-382">Metody zapewniane przez <xref:Microsoft.AspNetCore.Routing.LinkGenerator> obsługę funkcji generowania linków standardowych dla dowolnego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-382">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="3660c-383">Najbardziej wygodnym sposobem korzystania z generatora łączy są metody rozszerzające, które wykonują operacje dla określonego typu adresu:</span><span class="sxs-lookup"><span data-stu-id="3660c-383">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type:</span></span>

| <span data-ttu-id="3660c-384">Metoda rozszerzenia</span><span class="sxs-lookup"><span data-stu-id="3660c-384">Extension Method</span></span> | <span data-ttu-id="3660c-385">Opis</span><span class="sxs-lookup"><span data-stu-id="3660c-385">Description</span></span> |
| ---------------- | ----------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="3660c-386">Generuje identyfikator URI z ścieżką bezwzględną na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-386">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="3660c-387">Generuje bezwzględny identyfikator URI na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-387">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="3660c-388">Należy zwrócić uwagę na następujące konsekwencje wywoływania <xref:Microsoft.AspNetCore.Routing.LinkGenerator> metod:</span><span class="sxs-lookup"><span data-stu-id="3660c-388">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="3660c-389">Użyj `GetUri*` metod rozszerzających z zachowaniem ostrożności w konfiguracji aplikacji, która nie weryfikuje `Host` nagłówka żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="3660c-389">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="3660c-390">Jeśli `Host` nagłówek żądań przychodzących nie jest zweryfikowany, dane wejściowe żądania niezaufanego mogą być wysyłane z powrotem do klienta w identyfikatorach URI w widoku lub stronie.</span><span class="sxs-lookup"><span data-stu-id="3660c-390">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view or page.</span></span> <span data-ttu-id="3660c-391">Zaleca się, aby wszystkie aplikacje produkcyjne skonfigurowali swój serwer do sprawdzania poprawności `Host` nagłówka pod kątem znanych prawidłowych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-391">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="3660c-392">Należy używać <xref:Microsoft.AspNetCore.Routing.LinkGenerator> z zachowaniem ostrożności w oprogramowaniu pośredniczącym w połączeniu z `Map` lub `MapWhen` .</span><span class="sxs-lookup"><span data-stu-id="3660c-392">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="3660c-393">`Map*` zmienia ścieżkę podstawową żądania wykonania, która ma wpływ na dane wyjściowe generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-393">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="3660c-394">Wszystkie <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsy API umożliwiają określanie ścieżki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="3660c-394">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="3660c-395">Określ pustą ścieżkę bazową, aby cofnąć `Map*` wpływ na generowanie linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-395">Specify an empty base path to undo the `Map*` affect on link generation.</span></span>

### <a name="middleware-example"></a><span data-ttu-id="3660c-396">Przykład oprogramowania pośredniczącego</span><span class="sxs-lookup"><span data-stu-id="3660c-396">Middleware example</span></span>

<span data-ttu-id="3660c-397">W poniższym przykładzie oprogramowanie pośredniczące używa <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsu API do utworzenia linku do metody akcji, która wyświetla listę produktów ze sklepu.</span><span class="sxs-lookup"><span data-stu-id="3660c-397">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create a link to an action method that lists store products.</span></span> <span data-ttu-id="3660c-398">Przy użyciu generatora linków poprzez wstrzyknięcie go do klasy i wywołanie `GenerateLink` jest dostępne dla dowolnej klasy w aplikacji:</span><span class="sxs-lookup"><span data-stu-id="3660c-398">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Middleware/ProductsLinkMiddleware.cs?name=snippet)]

<a name="rtr"></a>

## <a name="route-template-reference"></a><span data-ttu-id="3660c-399">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-399">Route template reference</span></span>

<span data-ttu-id="3660c-400">Tokeny w ramach `{}` definiowania parametrów trasy, które są powiązane w przypadku dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-400">Tokens within `{}` define route parameters that are bound if the route is matched.</span></span> <span data-ttu-id="3660c-401">W segmencie trasy można zdefiniować więcej niż jeden parametr trasy, ale parametry tras muszą być rozdzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="3660c-401">More than one route parameter can be defined in a route segment, but route parameters  must be separated by a literal value.</span></span> <span data-ttu-id="3660c-402">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie ma wartości literału między `{controller}` i `{action}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-402">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span>  <span data-ttu-id="3660c-403">Parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="3660c-403">Route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="3660c-404">Tekst literału inny niż parametry trasy (na przykład `{id}` ) i separator ścieżki `/` muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-404">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="3660c-405">W dopasowaniu do tekstu nie jest rozróżniana wielkość liter i w oparciu o zdekodowaną reprezentację ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-405">Text matching is case-insensitive and based on the decoded representation of the URL's path.</span></span> <span data-ttu-id="3660c-406">Aby dopasować Ogranicznik parametru trasy literału `{` lub `}` , należy wprowadzić ogranicznik, powtarzając znak.</span><span class="sxs-lookup"><span data-stu-id="3660c-406">To match a literal route parameter delimiter `{` or `}`, escape the delimiter by repeating the character.</span></span> <span data-ttu-id="3660c-407">Na przykład `{{` lub `}}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-407">For example `{{` or `}}`.</span></span>

<span data-ttu-id="3660c-408">Gwiazdka `*` lub podwójna gwiazdka `**` :</span><span class="sxs-lookup"><span data-stu-id="3660c-408">Asterisk `*` or double asterisk `**`:</span></span>

* <span data-ttu-id="3660c-409">Można go użyć jako prefiksu do parametru trasy, aby powiązać z pozostałą częścią identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="3660c-409">Can be used as a prefix to a route parameter to bind to the rest of the URI.</span></span>
* <span data-ttu-id="3660c-410">Są nazywane parametrami **przechwycenia** .</span><span class="sxs-lookup"><span data-stu-id="3660c-410">Are called a **catch-all** parameters.</span></span> <span data-ttu-id="3660c-411">Na przykład `blog/{**slug}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-411">For example, `blog/{**slug}`:</span></span>
  * <span data-ttu-id="3660c-412">Dopasowuje dowolny identyfikator URI, który rozpoczyna się od `/blog` i ma dowolną wartość po nim.</span><span class="sxs-lookup"><span data-stu-id="3660c-412">Matches any URI that starts with `/blog` and has any value following it.</span></span>
  * <span data-ttu-id="3660c-413">Wartość poniżej `/blog` jest przypisana do wartości trasy [informacji](https://developer.mozilla.org/docs/Glossary/Slug) o sobie.</span><span class="sxs-lookup"><span data-stu-id="3660c-413">The value following `/blog` is assigned to the [slug](https://developer.mozilla.org/docs/Glossary/Slug) route value.</span></span>

[!INCLUDE[](~/includes/catchall.md)]

<span data-ttu-id="3660c-414">Catch-wszystkie parametry można także dopasować do pustego ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-414">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="3660c-415">Parametr catch-all wyprowadza odpowiednie znaki, gdy trasa jest używana do generowania adresu URL, włącznie z separatorami ścieżki `/` .</span><span class="sxs-lookup"><span data-stu-id="3660c-415">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator `/` characters.</span></span> <span data-ttu-id="3660c-416">Na przykład trasa `foo/{*path}` z wartościami trasy jest `{ path = "my/path" }` generowana `foo/my%2Fpath` .</span><span class="sxs-lookup"><span data-stu-id="3660c-416">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="3660c-417">Zwróć uwagę na odwrócony ukośnik.</span><span class="sxs-lookup"><span data-stu-id="3660c-417">Note the escaped forward slash.</span></span> <span data-ttu-id="3660c-418">Aby zaokrąglić znaki separatora ścieżki, użyj `**` prefiksu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-418">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="3660c-419">Trasa `foo/{**path}` z `{ path = "my/path" }` generowaniem `foo/my/path` .</span><span class="sxs-lookup"><span data-stu-id="3660c-419">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="3660c-420">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="3660c-420">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="3660c-421">Rozważmy na przykład szablon `files/{filename}.{ext?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-421">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="3660c-422">Gdy wartości obu `filename` i `ext` istnieją, są wypełniane obie wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-422">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="3660c-423">Jeśli tylko wartość `filename` istnieje w adresie URL, trasa pasuje do siebie, ponieważ końcowe `.` jest opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="3660c-423">If only a value for `filename` exists in the URL, the route matches because the trailing `.` is  optional.</span></span> <span data-ttu-id="3660c-424">Następujące adresy URL pasują do tej trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-424">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="3660c-425">Parametry trasy mogą mieć **wartości domyślne** , określając wartość domyślną po nazwie parametru oddzielone znakiem równości ( `=` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-425">Route parameters may have **default values** designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="3660c-426">Na przykład `{controller=Home}` definiuje `Home` jako wartość domyślną dla `controller` .</span><span class="sxs-lookup"><span data-stu-id="3660c-426">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="3660c-427">Wartość domyślna jest używana, jeśli żadna wartość nie jest obecna w adresie URL dla parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-427">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="3660c-428">Parametry trasy są opcjonalne przez dołączenie znaku zapytania ( `?` ) na końcu nazwy parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-428">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name.</span></span> <span data-ttu-id="3660c-429">Na przykład `id?`.</span><span class="sxs-lookup"><span data-stu-id="3660c-429">For example, `id?`.</span></span> <span data-ttu-id="3660c-430">Różnica między wartościami opcjonalnymi i domyślnymi parametrami trasy to:</span><span class="sxs-lookup"><span data-stu-id="3660c-430">The difference between optional values and default route parameters is:</span></span>

* <span data-ttu-id="3660c-431">Parametr trasy z wartością domyślną zawsze generuje wartość.</span><span class="sxs-lookup"><span data-stu-id="3660c-431">A route parameter with a default value always produces a value.</span></span>
* <span data-ttu-id="3660c-432">Opcjonalny parametr ma wartość tylko wtedy, gdy wartość jest podana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-432">An optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="3660c-433">Parametry trasy mogą mieć ograniczenia, które muszą być zgodne z wartością trasy powiązaną z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-433">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="3660c-434">Dodawanie `:` i ograniczanie nazwy po nazwie parametru trasy określa ograniczenie wbudowane dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-434">Adding `:` and constraint name after the route parameter name specifies an inline constraint on a route parameter.</span></span> <span data-ttu-id="3660c-435">Jeśli ograniczenie wymaga argumentów, są one ujęte w nawiasy `(...)` po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-435">If the constraint requires arguments, they're enclosed in parentheses `(...)` after the constraint name.</span></span> <span data-ttu-id="3660c-436">Można określić wiele *ograniczeń wbudowanych* , dołączając inne `:` i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-436">Multiple *inline constraints* can be specified by appending another `:` and constraint name.</span></span>

<span data-ttu-id="3660c-437">Nazwa i argumenty ograniczenia są przekazane do usługi w <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> celu utworzenia wystąpienia <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> do użycia w przetwarzaniu adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-437">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="3660c-438">Na przykład szablon trasy `blog/{article:minlength(10)}` określa `minlength` ograniczenie z argumentem `10` .</span><span class="sxs-lookup"><span data-stu-id="3660c-438">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="3660c-439">Aby uzyskać więcej informacji na temat ograniczeń trasy i listę ograniczeń zapewnianych przez platformę, zobacz sekcję [odwołanie do ograniczenia trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-439">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="3660c-440">Parametry trasy mogą także mieć Transformatory parametrów.</span><span class="sxs-lookup"><span data-stu-id="3660c-440">Route parameters may also have parameter transformers.</span></span> <span data-ttu-id="3660c-441">Transformatory parametrów przekształcają wartość parametru podczas generowania linków i dopasowywania akcji i stron do adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-441">Parameter transformers transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="3660c-442">Podobnie jak ograniczenia, transformatory parametrów można dodać do parametru trasy, dodając `:` nazwę i transformator po nazwie parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-442">Like constraints, parameter transformers can be added inline to a route parameter by adding a `:` and transformer name after the route parameter name.</span></span> <span data-ttu-id="3660c-443">Na przykład szablon trasy `blog/{article:slugify}` określa `slugify` transformator.</span><span class="sxs-lookup"><span data-stu-id="3660c-443">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="3660c-444">Aby uzyskać więcej informacji na temat transformatorów parametrów, zobacz sekcję [informacje dotyczące transformatora parametrów](#parameter-transformer-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-444">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="3660c-445">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie:</span><span class="sxs-lookup"><span data-stu-id="3660c-445">The following table demonstrates example route templates and their behavior:</span></span>

| <span data-ttu-id="3660c-446">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-446">Route Template</span></span>                           | <span data-ttu-id="3660c-447">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="3660c-447">Example Matching URI</span></span>    | <span data-ttu-id="3660c-448">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="3660c-448">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="3660c-449">Dopasowuje tylko jedną ścieżkę `/hello` .</span><span class="sxs-lookup"><span data-stu-id="3660c-449">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="3660c-450">Dopasowuje i ustawia `Page` jako `Home` .</span><span class="sxs-lookup"><span data-stu-id="3660c-450">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="3660c-451">Dopasowuje i ustawia `Page` jako `Contact` .</span><span class="sxs-lookup"><span data-stu-id="3660c-451">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="3660c-452">Mapuje do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-452">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="3660c-453">Mapuje do `Products` kontrolera i  `Details` akcji z `id` ustawioną na 123.</span><span class="sxs-lookup"><span data-stu-id="3660c-453">Maps to the `Products` controller and  `Details` action with`id` set to 123.</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="3660c-454">Mapuje na `Home` kontroler i `Index` metodę.</span><span class="sxs-lookup"><span data-stu-id="3660c-454">Maps to the `Home` controller and `Index` method.</span></span> <span data-ttu-id="3660c-455">Parametr `id` jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-455">`id` is ignored.</span></span>        |
| `{controller=Home}/{action=Index}/{id?}` | `/Products`         | <span data-ttu-id="3660c-456">Mapuje na `Products` kontroler i `Index` metodę.</span><span class="sxs-lookup"><span data-stu-id="3660c-456">Maps to the `Products` controller and `Index` method.</span></span> <span data-ttu-id="3660c-457">Parametr `id` jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-457">`id` is ignored.</span></span>        |

<span data-ttu-id="3660c-458">Użycie szablonu jest ogólnie najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-458">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="3660c-459">Ograniczenia i wartości domyślne można także określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-459">Constraints and defaults can also be specified outside the route template.</span></span>

### <a name="complex-segments"></a><span data-ttu-id="3660c-460">Złożone segmenty</span><span class="sxs-lookup"><span data-stu-id="3660c-460">Complex segments</span></span>

<span data-ttu-id="3660c-461">Złożone segmenty są przetwarzane przez dopasowanie ograniczników literałów od prawej do lewej w sposób [niezachłanney](#greedy) .</span><span class="sxs-lookup"><span data-stu-id="3660c-461">Complex segments are processed by matching up literal delimiters from right to left in a [non-greedy](#greedy) way.</span></span> <span data-ttu-id="3660c-462">Na przykład `[Route("/a{b}c{d}")]` jest segmentem złożonym.</span><span class="sxs-lookup"><span data-stu-id="3660c-462">For example, `[Route("/a{b}c{d}")]` is a complex segment.</span></span>
<span data-ttu-id="3660c-463">Złożone segmenty działają w określony sposób, który należy zrozumieć, aby użyć ich pomyślnie.</span><span class="sxs-lookup"><span data-stu-id="3660c-463">Complex segments work in a particular way that must be understood to use them successfully.</span></span> <span data-ttu-id="3660c-464">W przykładzie w tej sekcji pokazano, dlaczego złożone segmenty tylko naprawdę działają prawidłowo, gdy tekst ogranicznika nie jest wyświetlany wewnątrz wartości parametrów.</span><span class="sxs-lookup"><span data-stu-id="3660c-464">The example in this section demonstrates why complex segments only really work well when the delimiter text doesn't appear inside the parameter values.</span></span> <span data-ttu-id="3660c-465">Użycie [wyrażenia regularnego](/dotnet/standard/base-types/regular-expressions) , a następnie ręczne wyodrębnienie wartości jest zbędne dla bardziej złożonych przypadków.</span><span class="sxs-lookup"><span data-stu-id="3660c-465">Using a [regex](/dotnet/standard/base-types/regular-expressions) and then manually extracting the values is needed for more complex cases.</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="3660c-466">Jest to podsumowanie kroków wykonywanych przez Routing z szablonem `/a{b}c{d}` i ścieżką URL `/abcd` .</span><span class="sxs-lookup"><span data-stu-id="3660c-466">This is a summary of the steps that routing performs with the template `/a{b}c{d}` and the URL path `/abcd`.</span></span> <span data-ttu-id="3660c-467">`|`Służy do wizualizacji działania algorytmu:</span><span class="sxs-lookup"><span data-stu-id="3660c-467">The `|` is used to help visualize how the algorithm works:</span></span>

* <span data-ttu-id="3660c-468">Pierwszy literał, od prawej do lewej, jest `c` .</span><span class="sxs-lookup"><span data-stu-id="3660c-468">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="3660c-469">`/abcd`W związku z tym jest wyszukiwany od prawej i odnaleziony `/ab|c|d` .</span><span class="sxs-lookup"><span data-stu-id="3660c-469">So `/abcd` is searched from right and finds `/ab|c|d`.</span></span>
* <span data-ttu-id="3660c-470">Wszystko w prawo ( `d` ) jest teraz dopasowane do parametru Route `{d}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-470">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="3660c-471">Następnym literałem, od prawej do lewej, jest `a` .</span><span class="sxs-lookup"><span data-stu-id="3660c-471">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="3660c-472">W związku z tym zostanie `/ab|c|d` wyszukany od momentu, gdy został pozostawiony, a następnie `a` zostanie znaleziony `/|a|b|c|d` .</span><span class="sxs-lookup"><span data-stu-id="3660c-472">So `/ab|c|d` is searched starting where we left off, then `a` is found `/|a|b|c|d`.</span></span>
* <span data-ttu-id="3660c-473">Wartość z prawej strony ( `b` ) jest teraz dopasowana do parametru Route `{b}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-473">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="3660c-474">Nie ma pozostałego tekstu i nie ma pozostałego szablonu trasy, więc jest to dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-474">There is no remaining text and no remaining route template, so this is a match.</span></span>

<span data-ttu-id="3660c-475">Oto przykład negatywnego przypadku przy użyciu tego samego szablonu `/a{b}c{d}` i ścieżki URL `/aabcd` .</span><span class="sxs-lookup"><span data-stu-id="3660c-475">Here's an example of a negative case using the same template `/a{b}c{d}` and the URL path `/aabcd`.</span></span> <span data-ttu-id="3660c-476">`|`Służy do wizualizacji działania algorytmu.</span><span class="sxs-lookup"><span data-stu-id="3660c-476">The `|` is used to help visualize how the algorithm works.</span></span> <span data-ttu-id="3660c-477">Ten przypadek nie jest odpowiednikiem, który jest wyjaśniony przez ten sam algorytm:</span><span class="sxs-lookup"><span data-stu-id="3660c-477">This case isn't a match, which is explained by the same algorithm:</span></span>
* <span data-ttu-id="3660c-478">Pierwszy literał, od prawej do lewej, jest `c` .</span><span class="sxs-lookup"><span data-stu-id="3660c-478">The first literal, right to left, is `c`.</span></span> <span data-ttu-id="3660c-479">`/aabcd`W związku z tym jest wyszukiwany od prawej i odnaleziony `/aab|c|d` .</span><span class="sxs-lookup"><span data-stu-id="3660c-479">So `/aabcd` is searched from right and finds `/aab|c|d`.</span></span>
* <span data-ttu-id="3660c-480">Wszystko w prawo ( `d` ) jest teraz dopasowane do parametru Route `{d}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-480">Everything to the right (`d`) is now matched to the route parameter `{d}`.</span></span>
* <span data-ttu-id="3660c-481">Następnym literałem, od prawej do lewej, jest `a` .</span><span class="sxs-lookup"><span data-stu-id="3660c-481">The next literal, right to left, is `a`.</span></span> <span data-ttu-id="3660c-482">W związku z tym zostanie `/aab|c|d` wyszukany od momentu, gdy został pozostawiony, a następnie `a` zostanie znaleziony `/a|a|b|c|d` .</span><span class="sxs-lookup"><span data-stu-id="3660c-482">So `/aab|c|d` is searched starting where we left off, then `a` is found `/a|a|b|c|d`.</span></span>
* <span data-ttu-id="3660c-483">Wartość z prawej strony ( `b` ) jest teraz dopasowana do parametru Route `{b}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-483">The value to the right (`b`) is now matched to the route parameter `{b}`.</span></span>
* <span data-ttu-id="3660c-484">Na tym etapie jest pozostały tekst `a` , ale algorytm został uruchomiony z szablonu trasy do analizy, więc nie jest to dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-484">At this point there is remaining text `a`, but the algorithm has run out of route template to parse, so this is not a match.</span></span>

<span data-ttu-id="3660c-485">Ponieważ algorytm dopasowywania nie jest [zachłanne](#greedy):</span><span class="sxs-lookup"><span data-stu-id="3660c-485">Since the matching algorithm is [non-greedy](#greedy):</span></span>

* <span data-ttu-id="3660c-486">Pasuje do najmniejszej ilości tekstu możliwej w każdym kroku.</span><span class="sxs-lookup"><span data-stu-id="3660c-486">It matches the smallest amount of text possible in each step.</span></span>
* <span data-ttu-id="3660c-487">Każdy przypadek, w którym wartość ogranicznika pojawia się wewnątrz wartości parametrów, powoduje niedopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-487">Any case where the delimiter value appears inside the parameter values results in not matching.</span></span>

<span data-ttu-id="3660c-488">Wyrażenia regularne zapewniają znacznie większą kontrolę nad ich zachowaniem.</span><span class="sxs-lookup"><span data-stu-id="3660c-488">Regular expressions provide much more control over their matching behavior.</span></span>

<a name="greedy"></a>

<span data-ttu-id="3660c-489">Dopasowanie zachłanne, znane także jako [Dopasowywanie z opóźnieniem](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), jest zgodne z największym możliwym ciągiem.</span><span class="sxs-lookup"><span data-stu-id="3660c-489">Greedy matching, also know as [lazy matching](https://wikipedia.org/wiki/Regular_expression#Lazy_matching), matches the largest possible string.</span></span> <span data-ttu-id="3660c-490">Zachłanne jest zgodny z najmniejszym możliwym ciągiem.</span><span class="sxs-lookup"><span data-stu-id="3660c-490">Non-greedy matches the smallest possible string.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="3660c-491">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-491">Route constraint reference</span></span>

<span data-ttu-id="3660c-492">Ograniczenia trasy są wykonywane, gdy nastąpiło dopasowanie do przychodzącego adresu URL, a Ścieżka adresu URL jest zgodna z wartościami trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-492">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="3660c-493">Ograniczenia trasy zwykle sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują decyzję o tym, czy wartość jest akceptowalna.</span><span class="sxs-lookup"><span data-stu-id="3660c-493">Route constraints generally inspect the route value associated via the route template and make a true or false decision about whether the value is acceptable.</span></span> <span data-ttu-id="3660c-494">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby uwzględnić, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-494">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="3660c-495">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> może akceptować lub odrzucać żądanie na podstawie jego zlecenia http.</span><span class="sxs-lookup"><span data-stu-id="3660c-495">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="3660c-496">Ograniczenia są używane w żądaniach routingu i generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-496">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="3660c-497">Nie używaj ograniczeń sprawdzania poprawności danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-497">Don't use constraints for input validation.</span></span> <span data-ttu-id="3660c-498">Jeśli ograniczenia są używane do sprawdzania poprawności danych wejściowych, nieprawidłowe wyniki wejściowe w `404` odpowiedzi nie znaleziono.</span><span class="sxs-lookup"><span data-stu-id="3660c-498">If constraints are used for input validation, invalid input results in a `404` Not Found response.</span></span> <span data-ttu-id="3660c-499">Nieprawidłowe dane wejściowe powinny generować `400` Nieprawidłowe żądanie z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-499">Invalid input should produce a `400` Bad Request with an appropriate error message.</span></span> <span data-ttu-id="3660c-500">Ograniczenia trasy są używane do odróżniania podobnych tras, a nie do sprawdzania danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-500">Route constraints are used to disambiguate similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="3660c-501">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie:</span><span class="sxs-lookup"><span data-stu-id="3660c-501">The following table demonstrates example route constraints and their expected behavior:</span></span>

| <span data-ttu-id="3660c-502">ograniczenie</span><span class="sxs-lookup"><span data-stu-id="3660c-502">constraint</span></span> | <span data-ttu-id="3660c-503">Przykład</span><span class="sxs-lookup"><span data-stu-id="3660c-503">Example</span></span> | <span data-ttu-id="3660c-504">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-504">Example Matches</span></span> | <span data-ttu-id="3660c-505">Uwagi</span><span class="sxs-lookup"><span data-stu-id="3660c-505">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="3660c-506">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-506">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-507">Dopasowuje dowolną liczbę całkowitą</span><span class="sxs-lookup"><span data-stu-id="3660c-507">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="3660c-508">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="3660c-508">`true`, `FALSE`</span></span> | <span data-ttu-id="3660c-509">Dopasowuje `true` lub `false` .</span><span class="sxs-lookup"><span data-stu-id="3660c-509">Matches `true` or `false`.</span></span> <span data-ttu-id="3660c-510">Bez uwzględniania wielkości liter</span><span class="sxs-lookup"><span data-stu-id="3660c-510">Case-insensitive</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="3660c-511">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="3660c-511">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="3660c-512">Dopasowuje prawidłową `DateTime` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-512">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="3660c-513">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-513">See preceding warning.</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="3660c-514">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="3660c-514">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="3660c-515">Dopasowuje prawidłową `decimal` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-515">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="3660c-516">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-516">See preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="3660c-517">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-517">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-518">Dopasowuje prawidłową `double` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-518">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="3660c-519">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-519">See preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="3660c-520">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-520">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-521">Dopasowuje prawidłową `float` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-521">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="3660c-522">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-522">See preceding warning.</span></span>|
| `guid` | `{id:guid}` | `CD2C1638-1638-72D5-1638-DEADBEEF1638` | <span data-ttu-id="3660c-523">Dopasowuje prawidłową `Guid` wartość</span><span class="sxs-lookup"><span data-stu-id="3660c-523">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="3660c-524">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-524">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-525">Dopasowuje prawidłową `long` wartość</span><span class="sxs-lookup"><span data-stu-id="3660c-525">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="3660c-526">Ciąg musi składać się z co najmniej 4 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-526">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="3660c-527">Ciąg nie może zawierać więcej niż 8 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-527">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="3660c-528">Ciąg musi zawierać dokładnie 12 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-528">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="3660c-529">Ciąg musi mieć długość co najmniej 8 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-529">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="3660c-530">Wartość całkowita musi być równa co najmniej 18</span><span class="sxs-lookup"><span data-stu-id="3660c-530">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="3660c-531">Wartość całkowita nie może być większa niż 120</span><span class="sxs-lookup"><span data-stu-id="3660c-531">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="3660c-532">Wartość całkowita musi być równa co najmniej 18, ale nie więcej niż 120</span><span class="sxs-lookup"><span data-stu-id="3660c-532">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="3660c-533">Ciąg musi składać się z co najmniej jednego znaku alfabetycznego `a` - `z` i nie uwzględnia wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="3660c-533">String must consist of one or more alphabetical characters, `a`-`z` and case-insensitive.</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="3660c-534">Ciąg musi być zgodny z wyrażeniem regularnym.</span><span class="sxs-lookup"><span data-stu-id="3660c-534">String must match the regular expression.</span></span> <span data-ttu-id="3660c-535">Zapoznaj się z poradami dotyczącymi definiowania wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-535">See tips about defining a regular expression.</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="3660c-536">Służy do wymuszania, że podczas generowania adresu URL jest obecna wartość, która nie jest wartością parametru</span><span class="sxs-lookup"><span data-stu-id="3660c-536">Used to enforce that a non-parameter value is present during URL generation</span></span> |

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="3660c-537">Wielokrotne ograniczenia rozdzielane średnikami mogą być stosowane do jednego parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-537">Multiple, colon delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="3660c-538">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub wyższej:</span><span class="sxs-lookup"><span data-stu-id="3660c-538">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="3660c-539">Ograniczenia trasy, które weryfikują adres URL i są konwertowane na typ CLR zawsze używają niezmiennej kultury.</span><span class="sxs-lookup"><span data-stu-id="3660c-539">Route constraints that verify the URL and are converted to a CLR type always use the invariant culture.</span></span> <span data-ttu-id="3660c-540">Na przykład konwersja na typ CLR `int` lub `DateTime` .</span><span class="sxs-lookup"><span data-stu-id="3660c-540">For example, conversion to the CLR type `int` or `DateTime`.</span></span> <span data-ttu-id="3660c-541">W tych ograniczeniach przyjęto założenie, że adres URL nie jest Lokalizowalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-541">These constraints assume that the URL is not localizable.</span></span> <span data-ttu-id="3660c-542">Ograniczenia trasy dostarczone przez platformę nie modyfikują wartości przechowywanych w wartościach trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-542">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="3660c-543">Wszystkie wartości tras analizowane na podstawie adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="3660c-543">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="3660c-544">Na przykład, `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy może być konwertowana na typ float.</span><span class="sxs-lookup"><span data-stu-id="3660c-544">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

### <a name="regular-expressions-in-constraints"></a><span data-ttu-id="3660c-545">Wyrażenia regularne w ograniczeniach</span><span class="sxs-lookup"><span data-stu-id="3660c-545">Regular expressions in constraints</span></span>

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="3660c-546">Wyrażenia regularne można określać jako ograniczenia wbudowane przy użyciu `regex(...)` ograniczenia trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-546">Regular expressions can be specified as inline constraints using the `regex(...)` route constraint.</span></span> <span data-ttu-id="3660c-547">Metody w <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> rodzinie również akceptują literał obiektu w ograniczeniach.</span><span class="sxs-lookup"><span data-stu-id="3660c-547">Methods in the <xref:Microsoft.AspNetCore.Builder.ControllerEndpointRouteBuilderExtensions.MapControllerRoute*> family also accept an object literal of constraints.</span></span> <span data-ttu-id="3660c-548">Jeśli formularz jest używany, wartości ciągów są interpretowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="3660c-548">If that form is used, string values are interpreted as regular expressions.</span></span>

<span data-ttu-id="3660c-549">Poniższy kod używa wbudowanego ograniczenia wyrażenia regularnego:</span><span class="sxs-lookup"><span data-stu-id="3660c-549">The following code uses an inline regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex.cs?name=snippet)]

<span data-ttu-id="3660c-550">Poniższy kod używa literału obiektu do określenia ograniczenia wyrażenia regularnego:</span><span class="sxs-lookup"><span data-stu-id="3660c-550">The following code uses an object literal to specify a regex constraint:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRegex2.cs?name=snippet)]

<span data-ttu-id="3660c-551">ASP.NET Core Framework dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-551">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="3660c-552"><xref:System.Text.RegularExpressions.RegexOptions>Aby uzyskać opis tych elementów członkowskich, zobacz.</span><span class="sxs-lookup"><span data-stu-id="3660c-552">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="3660c-553">Wyrażenia regularne używają ograniczników i tokenów podobnie jak w przypadku routingu i języka C#.</span><span class="sxs-lookup"><span data-stu-id="3660c-553">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="3660c-554">Tokeny wyrażenia regularnego muszą być zmienione.</span><span class="sxs-lookup"><span data-stu-id="3660c-554">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="3660c-555">Aby użyć wyrażenia regularnego `^\d{3}-\d{2}-\d{4}$` w ograniczeniu wbudowanym, użyj jednego z następujących elementów:</span><span class="sxs-lookup"><span data-stu-id="3660c-555">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in an inline constraint, use one of the following:</span></span>

* <span data-ttu-id="3660c-556">Zamień `\` znaki podane w ciągu jako `\\` znaki w pliku źródłowym C# w celu ucieczki `\` znaku ucieczki ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-556">Replace `\` characters provided in the string as `\\` characters in the C# source file in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="3660c-557">[Literały ciągu Verbatim](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="3660c-557">[Verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="3660c-558">Aby uzyskać ogranicznik parametrów routingu ucieczki,,,, `{` `}` `[` `]` podwójne znaki w wyrażeniu, na przykład, `{{` `}}` `[[` ,, `]]` .</span><span class="sxs-lookup"><span data-stu-id="3660c-558">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression, for example, `{{`, `}}`, `[[`, `]]`.</span></span> <span data-ttu-id="3660c-559">W poniższej tabeli przedstawiono wyrażenie regularne i jego wersja o zmienionym znaczeniu:</span><span class="sxs-lookup"><span data-stu-id="3660c-559">The following table shows a regular expression and its escaped version:</span></span>

| <span data-ttu-id="3660c-560">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="3660c-560">Regular expression</span></span>    | <span data-ttu-id="3660c-561">Wyrażenie regularne o zmienionym znaczeniu</span><span class="sxs-lookup"><span data-stu-id="3660c-561">Escaped regular expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="3660c-562">Wyrażenia regularne używane w routingu często zaczynają się od `^` znaku i pasują do pozycji początkowej ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-562">Regular expressions used in routing often start with the `^` character and match the starting position of the string.</span></span> <span data-ttu-id="3660c-563">Wyrażenia często kończą się `$` znakiem i pasują do końca ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-563">The expressions often end with the `$` character and match the end of the string.</span></span> <span data-ttu-id="3660c-564">`^`Znaki i `$` zapewniają, że wyrażenie regularne dopasowuje całą wartość parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-564">The `^` and `$` characters ensure that the regular expression matches the entire route parameter value.</span></span> <span data-ttu-id="3660c-565">Bez `^` znaków i `$` wyrażenie regularne dopasowuje dowolny podciąg w ciągu, co jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="3660c-565">Without the `^` and `$` characters, the regular expression matches any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="3660c-566">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są one zgodne lub nie można ich dopasować:</span><span class="sxs-lookup"><span data-stu-id="3660c-566">The following table provides examples and explains why they match or fail to match:</span></span>

| <span data-ttu-id="3660c-567">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="3660c-567">Expression</span></span>   | <span data-ttu-id="3660c-568">Ciąg</span><span class="sxs-lookup"><span data-stu-id="3660c-568">String</span></span>    | <span data-ttu-id="3660c-569">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="3660c-569">Match</span></span> | <span data-ttu-id="3660c-570">Komentarz</span><span class="sxs-lookup"><span data-stu-id="3660c-570">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="3660c-571">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-571">hello</span></span>     | <span data-ttu-id="3660c-572">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-572">Yes</span></span>   | <span data-ttu-id="3660c-573">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-573">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-574">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-574">123abc456</span></span> | <span data-ttu-id="3660c-575">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-575">Yes</span></span>   | <span data-ttu-id="3660c-576">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-576">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-577">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-577">mz</span></span>        | <span data-ttu-id="3660c-578">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-578">Yes</span></span>   | <span data-ttu-id="3660c-579">Wyrażenie dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-579">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="3660c-580">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-580">MZ</span></span>        | <span data-ttu-id="3660c-581">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-581">Yes</span></span>   | <span data-ttu-id="3660c-582">Bez uwzględniania wielkości liter</span><span class="sxs-lookup"><span data-stu-id="3660c-582">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-583">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-583">hello</span></span>     | <span data-ttu-id="3660c-584">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-584">No</span></span>    | <span data-ttu-id="3660c-585">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-585">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-586">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-586">123abc456</span></span> | <span data-ttu-id="3660c-587">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-587">No</span></span>    | <span data-ttu-id="3660c-588">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-588">See `^` and `$` above</span></span> |

<span data-ttu-id="3660c-589">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework wyrażeń regularnych](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="3660c-589">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="3660c-590">Aby ograniczyć parametr do znanego zestawu możliwych wartości, użyj wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-590">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="3660c-591">Na przykład `{action:regex(^(list|get|create)$)}` dopasowuje `action` wartość trasy do `list` , `get` , lub `create` .</span><span class="sxs-lookup"><span data-stu-id="3660c-591">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="3660c-592">Jeśli przeszedł do słownika ograniczeń, ciąg `^(list|get|create)$` jest równoważny.</span><span class="sxs-lookup"><span data-stu-id="3660c-592">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="3660c-593">Ograniczenia, które są przesyłane w słowniku ograniczeń, które nie pasują do jednego ze znanych ograniczeń, są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="3660c-593">Constraints that are passed in the constraints dictionary that don't match one of the known constraints are also treated as regular expressions.</span></span> <span data-ttu-id="3660c-594">Ograniczenia, które są przesyłane w ramach szablonu, który nie odpowiada jednemu ze znanych ograniczeń, nie są traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="3660c-594">Constraints that are passed  within a template that don't match one of the known constraints are not treated as regular expressions.</span></span>

### <a name="custom-route-constraints"></a><span data-ttu-id="3660c-595">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-595">Custom route constraints</span></span>

<span data-ttu-id="3660c-596">Niestandardowe ograniczenia trasy można utworzyć przez implementację <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="3660c-596">Custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="3660c-597">`IRouteConstraint`Interfejs zawiera <xref:System.Web.Routing.IRouteConstraint.Match*> , który zwraca, `true` Jeśli ograniczenie jest spełnione i `false` w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="3660c-597">The `IRouteConstraint` interface contains <xref:System.Web.Routing.IRouteConstraint.Match*>, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="3660c-598">Niestandardowe ograniczenia trasy są rzadko zbędne.</span><span class="sxs-lookup"><span data-stu-id="3660c-598">Custom route constraints are rarely needed.</span></span> <span data-ttu-id="3660c-599">Przed wdrożeniem niestandardowego ograniczenia trasy należy rozważyć alternatywy, takie jak powiązanie modelu.</span><span class="sxs-lookup"><span data-stu-id="3660c-599">Before implementing a custom route constraint, consider alternatives, such as model binding.</span></span>

<span data-ttu-id="3660c-600">Folder [ograniczenia](https://github.com/dotnet/aspnetcore/tree/main/src/Http/Routing/src/Constraints) ASP.NET Core zawiera dobre przykłady tworzenia ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="3660c-600">The ASP.NET Core [Constraints](https://github.com/dotnet/aspnetcore/tree/main/src/Http/Routing/src/Constraints) folder provides good examples of creating a constraints.</span></span> <span data-ttu-id="3660c-601">Na przykład [GuidRouteConstraint](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Constraints/GuidRouteConstraint.cs#L18).</span><span class="sxs-lookup"><span data-stu-id="3660c-601">For example, [GuidRouteConstraint](https://github.com/dotnet/aspnetcore/blob/main/src/Http/Routing/src/Constraints/GuidRouteConstraint.cs#L18).</span></span>

<span data-ttu-id="3660c-602">Aby użyć niestandardowego `IRouteConstraint` , typ ograniczenia trasy musi być zarejestrowany w ramach aplikacji <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> w kontenerze usługi.</span><span class="sxs-lookup"><span data-stu-id="3660c-602">To use a custom `IRouteConstraint`, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the service container.</span></span> <span data-ttu-id="3660c-603">`ConstraintMap`Jest słownikiem, który mapuje klucze ograniczeń trasy do `IRouteConstraint` implementacji, które weryfikują te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-603">A `ConstraintMap` is a dictionary that maps route constraint keys to `IRouteConstraint` implementations that validate those constraints.</span></span> <span data-ttu-id="3660c-604">Aplikację `ConstraintMap` można zaktualizować w `Startup.ConfigureServices` ramach [usług. Wywołanie addrouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub przez skonfigurowanie <xref:Microsoft.AspNetCore.Routing.RouteOptions> bezpośrednio w usłudze `services.Configure<RouteOptions>` .</span><span class="sxs-lookup"><span data-stu-id="3660c-604">An app's `ConstraintMap` can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="3660c-605">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3660c-605">For example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet)]

<span data-ttu-id="3660c-606">Poprzednie ograniczenie jest stosowane w poniższym kodzie:</span><span class="sxs-lookup"><span data-stu-id="3660c-606">The preceding constraint is applied in the following code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet&highlight=6,13)]

[!INCLUDE[](~/includes/MyDisplayRouteInfo.md)]

<span data-ttu-id="3660c-607">Implementacja `MyCustomConstraint` uniemożliwia `0` stosowanie do parametru trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-607">The implementation of `MyCustomConstraint` prevents `0` being applied to a route parameter:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint.cs?name=snippet2)]

[!INCLUDE[](~/includes/regex.md)]

<span data-ttu-id="3660c-608">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="3660c-608">The preceding code:</span></span>

* <span data-ttu-id="3660c-609">Zapobiega `0` w `{id}` segmencie trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-609">Prevents `0` in the `{id}` segment of the route.</span></span>
* <span data-ttu-id="3660c-610">Jest przedstawiany jako podstawowy przykład implementowania niestandardowego ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-610">Is shown to provide a basic example of implementing a custom constraint.</span></span> <span data-ttu-id="3660c-611">Nie powinno być używane w aplikacji produkcyjnej.</span><span class="sxs-lookup"><span data-stu-id="3660c-611">It should not be used in a production app.</span></span>

<span data-ttu-id="3660c-612">Poniższy kod jest lepszym rozwiązaniem do zapobiegania `id` `0` przetwarzaniu danych z programu.</span><span class="sxs-lookup"><span data-stu-id="3660c-612">The following code is a better approach to preventing an `id` containing a `0` from being processed:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/TestController.cs?name=snippet2)]

<span data-ttu-id="3660c-613">Poprzedni kod ma następujące zalety w porównaniu z `MyCustomConstraint` podejściem:</span><span class="sxs-lookup"><span data-stu-id="3660c-613">The preceding code has the following advantages over the `MyCustomConstraint` approach:</span></span>

* <span data-ttu-id="3660c-614">Nie wymaga ograniczeń niestandardowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-614">It doesn't require a custom constraint.</span></span>
* <span data-ttu-id="3660c-615">Zwraca bardziej opisowy błąd, gdy parametr Route zawiera `0` .</span><span class="sxs-lookup"><span data-stu-id="3660c-615">It returns a more descriptive error when the route parameter includes `0`.</span></span>

## <a name="parameter-transformer-reference"></a><span data-ttu-id="3660c-616">Odwołanie do transformatora parametrów</span><span class="sxs-lookup"><span data-stu-id="3660c-616">Parameter transformer reference</span></span>

<span data-ttu-id="3660c-617">Transformatory parametrów:</span><span class="sxs-lookup"><span data-stu-id="3660c-617">Parameter transformers:</span></span>

* <span data-ttu-id="3660c-618">Wykonaj podczas generowania linku przy użyciu <xref:Microsoft.AspNetCore.Routing.LinkGenerator> .</span><span class="sxs-lookup"><span data-stu-id="3660c-618">Execute when generating a link using <xref:Microsoft.AspNetCore.Routing.LinkGenerator>.</span></span>
* <span data-ttu-id="3660c-619">Implementacja <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="3660c-619">Implement <xref:Microsoft.AspNetCore.Routing.IOutboundParameterTransformer?displayProperty=fullName>.</span></span>
* <span data-ttu-id="3660c-620">Są konfigurowane przy użyciu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> .</span><span class="sxs-lookup"><span data-stu-id="3660c-620">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="3660c-621">Wypełnij wartość trasy parametru i Przekształć ją na nową wartość ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-621">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="3660c-622">Wynikiem jest użycie przekształconej wartości w wygenerowanym łączu.</span><span class="sxs-lookup"><span data-stu-id="3660c-622">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="3660c-623">Na przykład niestandardowy `slugify` transformator parametrów w wzorcu trasy `blog\{article:slugify}` z `Url.Action(new { article = "MyTestArticle" })` generowaniem `blog\my-test-article` .</span><span class="sxs-lookup"><span data-stu-id="3660c-623">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="3660c-624">Weź pod uwagę następującą `IOutboundParameterTransformer` implementację:</span><span class="sxs-lookup"><span data-stu-id="3660c-624">Consider the following `IOutboundParameterTransformer` implementation:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet2)]

<span data-ttu-id="3660c-625">Aby użyć transformatora parametrów w wzorcu trasy, skonfiguruj go przy użyciu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> w programie `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-625">To use a parameter transformer in a route pattern, configure it using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupConstraint2.cs?name=snippet)]

<span data-ttu-id="3660c-626">ASP.NET Core Framework używa transformatorów parametrów do przekształcania identyfikatora URI, w którym jest rozpoznawany punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="3660c-626">The ASP.NET Core framework uses parameter transformers to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="3660c-627">Na przykład Transformatory parametrów przekształcają wartości tras używane do dopasowania do `area` , `controller` , `action` , i `page` .</span><span class="sxs-lookup"><span data-stu-id="3660c-627">For example, parameter transformers transform the route values used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapControllerRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="3660c-628">W przypadku poprzedniego szablonu trasy Akcja `SubscriptionManagementController.GetAll` jest zgodna z identyfikatorem URI `/subscription-management/get-all` .</span><span class="sxs-lookup"><span data-stu-id="3660c-628">With the preceding route template, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="3660c-629">Transformator parametrów nie zmienia wartości trasy użytych do wygenerowania linku.</span><span class="sxs-lookup"><span data-stu-id="3660c-629">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="3660c-630">Na przykład dane `Url.Action("GetAll", "SubscriptionManagement")` wyjściowe `/subscription-management/get-all` .</span><span class="sxs-lookup"><span data-stu-id="3660c-630">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="3660c-631">ASP.NET Core udostępnia konwencje interfejsu API do korzystania z transformatorów parametrów z wygenerowanymi trasami:</span><span class="sxs-lookup"><span data-stu-id="3660c-631">ASP.NET Core provides API conventions for using parameter transformers with generated routes:</span></span>

* <span data-ttu-id="3660c-632"><xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName>Konwencja MVC stosuje określony transformator parametrów do wszystkich tras atrybutów w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-632">The <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention?displayProperty=fullName> MVC convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="3660c-633">Transformator parametrów przekształca tokeny trasy atrybutów po ich wymianie.</span><span class="sxs-lookup"><span data-stu-id="3660c-633">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="3660c-634">Aby uzyskać więcej informacji, zobacz [używanie transformatora parametrów do dostosowywania zastępowania tokenu](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="3660c-634">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="3660c-635">Razor Strony używają <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> Konwencji interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="3660c-635">Razor Pages uses the <xref:Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention> API convention.</span></span> <span data-ttu-id="3660c-636">Ta Konwencja stosuje określony transformator parametrów do wszystkich automatycznie odnalezionych Razor stron.</span><span class="sxs-lookup"><span data-stu-id="3660c-636">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="3660c-637">Transformator parametrów przekształca folder i segmenty nazw plików Razor tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-637">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="3660c-638">Aby uzyskać więcej informacji, zobacz [używanie transformatora parametrów do dostosowywania tras stron](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="3660c-638">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

<a name="ugr"></a>

## <a name="url-generation-reference"></a><span data-ttu-id="3660c-639">Odwołanie do generacji adresów URL</span><span class="sxs-lookup"><span data-stu-id="3660c-639">URL generation reference</span></span>

<span data-ttu-id="3660c-640">Ta sekcja zawiera odwołanie do algorytmu zaimplementowane przez generowanie adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-640">This section contains a reference for the algorithm implemented by URL generation.</span></span> <span data-ttu-id="3660c-641">W tym przypadku najbardziej złożone przykłady generowania adresów URL używają kontrolerów lub Razor stron.</span><span class="sxs-lookup"><span data-stu-id="3660c-641">In practice, most complex examples of URL generation use controllers or Razor Pages.</span></span> <span data-ttu-id="3660c-642">Aby uzyskać dodatkowe informacje, zobacz  [Routing na kontrolerach](xref:mvc/controllers/routing) .</span><span class="sxs-lookup"><span data-stu-id="3660c-642">See  [routing in controllers](xref:mvc/controllers/routing) for additional information.</span></span>

<span data-ttu-id="3660c-643">Proces generowania adresu URL rozpoczyna się od wywołania metody [LinkGenerator. GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) lub podobną metodę.</span><span class="sxs-lookup"><span data-stu-id="3660c-643">The URL generation process begins with a call to [LinkGenerator.GetPathByAddress](xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*) or a similar method.</span></span> <span data-ttu-id="3660c-644">Metoda jest dostarczana z adresem, zestawem wartości tras i opcjonalnie informacjami o bieżącym żądaniu z `HttpContext` .</span><span class="sxs-lookup"><span data-stu-id="3660c-644">The method is provided with an address, a set of route values, and optionally information about the current request from `HttpContext`.</span></span>

<span data-ttu-id="3660c-645">Pierwszym krokiem jest użycie adresu do rozpoznania zestawu punktów końcowych kandydujących przy użyciu [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) , który jest zgodny z typem adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-645">The first step is to use the address to resolve a set of candidate endpoints using an [`IEndpointAddressScheme<TAddress>`](xref:Microsoft.AspNetCore.Routing.IEndpointAddressScheme`1) that matches the address's type.</span></span>

<span data-ttu-id="3660c-646">Po znalezieniu zestawu kandydatów przez schemat adresów punkty końcowe są uporządkowane i przetwarzane iteracyjnie do momentu pomyślnego zakończenia operacji generowania adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-646">Once the set of candidates is found by the address scheme, the endpoints are ordered and processed iteratively until a URL generation operation succeeds.</span></span> <span data-ttu-id="3660c-647">Generowanie adresu URL **nie sprawdza niejasności** . pierwszy zwrócony wynik to wynik końcowy.</span><span class="sxs-lookup"><span data-stu-id="3660c-647">URL generation does **not** check for ambiguities, the first result returned is the final result.</span></span>

### <a name="troubleshooting-url-generation-with-logging"></a><span data-ttu-id="3660c-648">Rozwiązywanie problemów z generowaniem adresów URL przy użyciu rejestrowania</span><span class="sxs-lookup"><span data-stu-id="3660c-648">Troubleshooting URL generation with logging</span></span>

<span data-ttu-id="3660c-649">Pierwszym krokiem podczas generowania adresu URL rozwiązywania problemów jest ustawienie poziomu rejestrowania `Microsoft.AspNetCore.Routing` na `TRACE` .</span><span class="sxs-lookup"><span data-stu-id="3660c-649">The first step in troubleshooting URL generation is setting the logging level of `Microsoft.AspNetCore.Routing` to `TRACE`.</span></span> <span data-ttu-id="3660c-650">`LinkGenerator` rejestruje wiele szczegółowych informacji o jego przetwarzaniu, które mogą być przydatne do rozwiązywania problemów.</span><span class="sxs-lookup"><span data-stu-id="3660c-650">`LinkGenerator` logs many details about its processing which can be useful to troubleshoot problems.</span></span>

<span data-ttu-id="3660c-651">Aby uzyskać szczegółowe informacje na temat generowania adresów URL, zobacz [odwołanie do generacji adresów URL](#ugr) .</span><span class="sxs-lookup"><span data-stu-id="3660c-651">See [URL generation reference](#ugr) for details on URL generation.</span></span>

### <a name="addresses"></a><span data-ttu-id="3660c-652">Adresy</span><span class="sxs-lookup"><span data-stu-id="3660c-652">Addresses</span></span>

<span data-ttu-id="3660c-653">Adresy są pojęciem generacji adresów URL używanym do powiązania wywołania z generatorem linków z zestawem punktów końcowych kandydatów.</span><span class="sxs-lookup"><span data-stu-id="3660c-653">Addresses are the concept in URL generation used to bind a call into the link generator to a set of candidate endpoints.</span></span>

<span data-ttu-id="3660c-654">Adresy to rozszerzalne koncepcje, które domyślnie mają dwie implementacje:</span><span class="sxs-lookup"><span data-stu-id="3660c-654">Addresses are an extensible concept that come with two implementations by default:</span></span>

* <span data-ttu-id="3660c-655">Użycie *nazwy punktu końcowego* ( `string` ) jako adresu:</span><span class="sxs-lookup"><span data-stu-id="3660c-655">Using *endpoint name* (`string`) as the address:</span></span>
    * <span data-ttu-id="3660c-656">Zapewnia podobną funkcjonalność do nazwy trasy MVC.</span><span class="sxs-lookup"><span data-stu-id="3660c-656">Provides similar functionality to MVC's route name.</span></span>
    * <span data-ttu-id="3660c-657">Używa <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> typu metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-657">Uses the <xref:Microsoft.AspNetCore.Routing.IEndpointNameMetadata> metadata type.</span></span>
    * <span data-ttu-id="3660c-658">Rozpoznaje podany ciąg w odniesieniu do metadanych wszystkich zarejestrowanych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-658">Resolves the provided string against the metadata of all registered endpoints.</span></span>
    * <span data-ttu-id="3660c-659">Zgłasza wyjątek podczas uruchamiania, jeśli wiele punktów końcowych używa tej samej nazwy.</span><span class="sxs-lookup"><span data-stu-id="3660c-659">Throws an exception on startup if multiple endpoints use the same name.</span></span>
    * <span data-ttu-id="3660c-660">Zalecane do zastosowania ogólnego przeznaczenia poza kontrolerami i Razor stronami.</span><span class="sxs-lookup"><span data-stu-id="3660c-660">Recommended for general-purpose use outside of controllers and Razor Pages.</span></span>
* <span data-ttu-id="3660c-661">Użycie *wartości trasy* ( <xref:Microsoft.AspNetCore.Routing.RouteValuesAddress> ) jako adresu:</span><span class="sxs-lookup"><span data-stu-id="3660c-661">Using *route values* (<xref:Microsoft.AspNetCore.Routing.RouteValuesAddress>) as the address:</span></span>
    * <span data-ttu-id="3660c-662">Zapewnia podobną funkcjonalność do kontrolerów i stron, które są Razor starszej generacji adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-662">Provides similar functionality to controllers and Razor Pages legacy URL generation.</span></span>
    * <span data-ttu-id="3660c-663">Bardzo skomplikowane do rozszerania i debugowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-663">Very complex to extend and debug.</span></span>
    * <span data-ttu-id="3660c-664">Zapewnia implementację używaną przez `IUrlHelper` , pomocników tagów, pomocników HTML, wyników akcji itp.</span><span class="sxs-lookup"><span data-stu-id="3660c-664">Provides the implementation used by `IUrlHelper`, Tag Helpers, HTML Helpers, Action Results, etc.</span></span>

<span data-ttu-id="3660c-665">Rolą schematu adresowania jest skojarzenie między adresem i zgodnymi punktami końcowymi przez dowolne kryterium:</span><span class="sxs-lookup"><span data-stu-id="3660c-665">The role of the address scheme is to make the association between the address and matching endpoints by arbitrary criteria:</span></span>

* <span data-ttu-id="3660c-666">Schemat nazwy punktu końcowego wykonuje wyszukiwanie podstawowego słownika.</span><span class="sxs-lookup"><span data-stu-id="3660c-666">The endpoint name scheme performs a basic dictionary lookup.</span></span>
* <span data-ttu-id="3660c-667">Schemat wartości trasy ma złożone najlepsze podzbiór algorytmu zestawu.</span><span class="sxs-lookup"><span data-stu-id="3660c-667">The route values scheme has a complex best subset of set algorithm.</span></span>

<a name="ambient"></a>

### <a name="ambient-values-and-explicit-values"></a><span data-ttu-id="3660c-668">Wartości otoczenia i jawne wartości</span><span class="sxs-lookup"><span data-stu-id="3660c-668">Ambient values and explicit values</span></span>

<span data-ttu-id="3660c-669">Z bieżącego żądania Routing uzyskuje dostęp do wartości trasy bieżącego żądania `HttpContext.Request.RouteValues` .</span><span class="sxs-lookup"><span data-stu-id="3660c-669">From the current request, routing accesses the route values of the current request `HttpContext.Request.RouteValues`.</span></span> <span data-ttu-id="3660c-670">Wartości skojarzone z bieżącym żądaniem są określane jako **wartości otoczenia**.</span><span class="sxs-lookup"><span data-stu-id="3660c-670">The values associated with the current request are referred to as the **ambient values**.</span></span> <span data-ttu-id="3660c-671">Na potrzeby przejrzystości dokumentacja odwołuje się do wartości trasy przekazaną do metod jako **wartości jawnych**.</span><span class="sxs-lookup"><span data-stu-id="3660c-671">For the purpose of clarity, the documentation refers to the route values passed in to methods as **explicit values**.</span></span>

<span data-ttu-id="3660c-672">Poniższy przykład pokazuje wartości otoczenia i jawne wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-672">The following example shows ambient values and explicit values.</span></span> <span data-ttu-id="3660c-673">Zapewnia ona wartości otoczenia z bieżącego żądania i wartości jawne: `{ id = 17, }` :</span><span class="sxs-lookup"><span data-stu-id="3660c-673">It provides ambient values from the current request and explicit values: `{ id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet)]

<span data-ttu-id="3660c-674">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="3660c-674">The preceding code:</span></span>

* <span data-ttu-id="3660c-675">Typu `/Widget/Index/17`</span><span class="sxs-lookup"><span data-stu-id="3660c-675">Returns `/Widget/Index/17`</span></span>
* <span data-ttu-id="3660c-676">Pobiera <xref:Microsoft.AspNetCore.Routing.LinkGenerator> za pośrednictwem [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="3660c-676">Gets <xref:Microsoft.AspNetCore.Routing.LinkGenerator> via [DI](xref:fundamentals/dependency-injection).</span></span>

<span data-ttu-id="3660c-677">Poniższy kod nie zawiera żadnych wartości otoczenia i wartości jawnych: `{ controller = "Home", action = "Subscribe", id = 17, }` :</span><span class="sxs-lookup"><span data-stu-id="3660c-677">The following code provides no ambient values and explicit values: `{ controller = "Home", action = "Subscribe", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet2)]

<span data-ttu-id="3660c-678">Poprzednia metoda zwraca `/Home/Subscribe/17`</span><span class="sxs-lookup"><span data-stu-id="3660c-678">The preceding  method returns `/Home/Subscribe/17`</span></span>

<span data-ttu-id="3660c-679">Następujący kod w `WidgetController` zwracaniu `/Widget/Subscribe/17` :</span><span class="sxs-lookup"><span data-stu-id="3660c-679">The following code in the `WidgetController` returns `/Widget/Subscribe/17`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/WidgetController.cs?name=snippet3)]

<span data-ttu-id="3660c-680">Poniższy kod udostępnia kontroler z wartości otoczenia w bieżącym żądaniu i wartościach jawnych: `{ action = "Edit", id = 17, }` :</span><span class="sxs-lookup"><span data-stu-id="3660c-680">The following code provides the controller from ambient values in the current request and explicit values: `{ action = "Edit", id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/GadgetController.cs?name=snippet)]

<span data-ttu-id="3660c-681">Powyższy kod ma następujące działanie:</span><span class="sxs-lookup"><span data-stu-id="3660c-681">In the preceding code:</span></span>

* <span data-ttu-id="3660c-682">`/Gadget/Edit/17` jest zwracany.</span><span class="sxs-lookup"><span data-stu-id="3660c-682">`/Gadget/Edit/17` is returned.</span></span>
* <span data-ttu-id="3660c-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> Pobiera <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> .</span><span class="sxs-lookup"><span data-stu-id="3660c-683"><xref:Microsoft.AspNetCore.Mvc.ControllerBase.Url> gets the <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>.</span></span>
* <xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*>   
<span data-ttu-id="3660c-684">generuje adres URL ze ścieżką bezwzględną dla metody akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-684">generates a URL with an absolute path for an action method.</span></span> <span data-ttu-id="3660c-685">Adres URL zawiera określoną `action` nazwę i `route` wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-685">The URL contains the specified `action` name and `route` values.</span></span>

<span data-ttu-id="3660c-686">Poniższy kod zawiera wartości otoczenia z bieżącego żądania oraz wartości jawne: `{ page = "./Edit, id = 17, }` :</span><span class="sxs-lookup"><span data-stu-id="3660c-686">The following code provides ambient values from the current request and explicit values: `{ page = "./Edit, id = 17, }`:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Pages/Index.cshtml.cs?name=snippet)]

<span data-ttu-id="3660c-687">Poprzedni kod jest ustawiany `url` na,  `/Edit/17` gdy Razor Strona Edycja zawiera następującą dyrektywę strony:</span><span class="sxs-lookup"><span data-stu-id="3660c-687">The preceding code sets `url` to  `/Edit/17` when the Edit Razor Page contains the following page directive:</span></span>

 `@page "{id:int}"`

<span data-ttu-id="3660c-688">Jeśli strona Edycja nie zawiera `"{id:int}"` szablonu trasy, `url` to `/Edit?id=17` .</span><span class="sxs-lookup"><span data-stu-id="3660c-688">If the Edit page doesn't contain the `"{id:int}"` route template, `url` is `/Edit?id=17`.</span></span>

<span data-ttu-id="3660c-689">Zachowanie funkcji MVC <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> dodaje warstwę złożoności obok zasad opisanych tutaj:</span><span class="sxs-lookup"><span data-stu-id="3660c-689">The behavior of MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> adds a layer of complexity in addition to the rules described here:</span></span>

* <span data-ttu-id="3660c-690">`IUrlHelper` zawsze udostępnia wartości trasy z bieżącego żądania jako wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-690">`IUrlHelper` always provides the route values from the current request as ambient values.</span></span>
* <span data-ttu-id="3660c-691">[IUrlHelper. Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) zawsze kopiuje bieżące `action` i `controller` trasy jako wartości jawne, chyba że zostaną zastąpione przez dewelopera.</span><span class="sxs-lookup"><span data-stu-id="3660c-691">[IUrlHelper.Action](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Action*) always copies the current `action` and `controller` route values as explicit values unless overridden by the developer.</span></span>
* <span data-ttu-id="3660c-692">[IUrlHelper. Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) zawsze kopiuje bieżącą `page` wartość trasy jako wartość jawną, chyba że zostanie zastąpiona.</span><span class="sxs-lookup"><span data-stu-id="3660c-692">[IUrlHelper.Page](xref:Microsoft.AspNetCore.Mvc.UrlHelperExtensions.Page*) always copies the current `page` route value as an explicit value unless overridden.</span></span> <!--by the user-->
* <span data-ttu-id="3660c-693">`IUrlHelper.Page` zawsze zastępuje bieżącą `handler` wartość trasy wartością `null` jako jawne wartości, chyba że zostaną zastąpione.</span><span class="sxs-lookup"><span data-stu-id="3660c-693">`IUrlHelper.Page` always overrides the current `handler` route value with `null` as an explicit values unless overridden.</span></span>

<span data-ttu-id="3660c-694">Użytkownicy są często przeniesieni przez szczegółowe informacje o zachowaniu wartości otoczenia, ponieważ MVC nie przestrzega własnych reguł.</span><span class="sxs-lookup"><span data-stu-id="3660c-694">Users are often surprised by the behavioral details of ambient values, because MVC doesn't seem to follow its own rules.</span></span> <span data-ttu-id="3660c-695">Ze względu na historyczne i zgodność niektóre wartości tras, takie jak `action` ,, `controller` `page` i `handler` mają własne zachowanie specjalne.</span><span class="sxs-lookup"><span data-stu-id="3660c-695">For historical and compatibility reasons, certain route values such as `action`, `controller`, `page`, and `handler` have their own special-case behavior.</span></span>

<span data-ttu-id="3660c-696">Równoważne funkcje zapewniane przez program `LinkGenerator.GetPathByAction` i `LinkGenerator.GetPathByPage` duplikują te anomalie `IUrlHelper` w celu zapewnienia zgodności.</span><span class="sxs-lookup"><span data-stu-id="3660c-696">The equivalent functionality provided by `LinkGenerator.GetPathByAction` and `LinkGenerator.GetPathByPage` duplicates these anomalies of `IUrlHelper` for compatibility.</span></span>

### <a name="url-generation-process"></a><span data-ttu-id="3660c-697">Proces generowania adresu URL</span><span class="sxs-lookup"><span data-stu-id="3660c-697">URL generation process</span></span>

<span data-ttu-id="3660c-698">Po znalezieniu zestawu punktów końcowych kandydujących algorytm generowania adresów URL:</span><span class="sxs-lookup"><span data-stu-id="3660c-698">Once the set of candidate endpoints are found, the URL generation algorithm:</span></span>

* <span data-ttu-id="3660c-699">Przetwarza punkty końcowe iteracyjnie.</span><span class="sxs-lookup"><span data-stu-id="3660c-699">Processes the endpoints iteratively.</span></span>
* <span data-ttu-id="3660c-700">Zwraca pierwszy udany wynik.</span><span class="sxs-lookup"><span data-stu-id="3660c-700">Returns the first successful result.</span></span>

<span data-ttu-id="3660c-701">Pierwszy krok w tym procesie nazywa się **nieprawidłową wartością trasy**.</span><span class="sxs-lookup"><span data-stu-id="3660c-701">The first step in this process is called **route value invalidation**.</span></span>  <span data-ttu-id="3660c-702">Unieważnianie wartości trasy to proces, za pomocą którego Routing decyduje o tym, które wartości tras z wartości otoczenia powinny być używane, i które mają być ignorowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-702">Route value invalidation is the process by which routing decides which route values from the ambient values should be used and which should be ignored.</span></span> <span data-ttu-id="3660c-703">Każda wartość otoczenia jest brana pod uwagę i jest dołączona do wartości jawnych lub ignorowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-703">Each ambient value is considered and either combined with the explicit values, or ignored.</span></span>

<span data-ttu-id="3660c-704">Najlepszym sposobem, aby myśleć o roli otaczających wartości, jest próba zapisu deweloperów aplikacji wpisywanych w niektórych typowych przypadkach.</span><span class="sxs-lookup"><span data-stu-id="3660c-704">The best way to think about the role of ambient values is that they attempt to save application developers typing, in some common cases.</span></span> <span data-ttu-id="3660c-705">Tradycyjnie scenariusze, w których wartości otoczenia są przydatne, są związane z MVC:</span><span class="sxs-lookup"><span data-stu-id="3660c-705">Traditionally, the scenarios where ambient values are helpful are related to MVC:</span></span>

* <span data-ttu-id="3660c-706">Podczas łączenia z inną akcją w tym samym kontrolerze nie trzeba określać nazwy kontrolera.</span><span class="sxs-lookup"><span data-stu-id="3660c-706">When linking to another action in the same controller, the controller name doesn't need to be specified.</span></span>
* <span data-ttu-id="3660c-707">W przypadku łączenia z innym kontrolerem w tym samym obszarze nie trzeba określać nazwy obszaru.</span><span class="sxs-lookup"><span data-stu-id="3660c-707">When linking to another controller in the same area, the area name doesn't need to be specified.</span></span>
* <span data-ttu-id="3660c-708">Podczas łączenia z tą samą metodą akcji nie trzeba określać wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-708">When linking to the same action method, route values don't need to be specified.</span></span>
* <span data-ttu-id="3660c-709">Podczas tworzenia połączenia z inną częścią aplikacji nie ma potrzeby przenoszenia wartości tras, które nie mają znaczenia w tej części aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-709">When linking to another part of the app, you don't want to carry over route values that have no meaning in that part of the app.</span></span>

<span data-ttu-id="3660c-710">Wywołania do `LinkGenerator` lub `IUrlHelper` zwracane `null` są zwykle spowodowane nieprawidłowym unieważnieniem wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-710">Calls to `LinkGenerator` or `IUrlHelper` that return `null` are usually caused by not understanding route value invalidation.</span></span> <span data-ttu-id="3660c-711">Rozwiązywanie problemów dotyczących unieważniania wartości trasy przez jawne określenie większej liczby wartości trasy, aby sprawdzić, czy rozwiązanie to rozwiązuje problem.</span><span class="sxs-lookup"><span data-stu-id="3660c-711">Troubleshoot route value invalidation by explicitly specifying more of the route values to see if that solves the problem.</span></span>

<span data-ttu-id="3660c-712">Unieważnianie wartości trasy działa zgodnie z założeniem, że schemat adresu URL aplikacji jest hierarchiczny, z hierarchią utworzoną od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="3660c-712">Route value invalidation works on the assumption that the app's URL scheme is hierarchical, with a hierarchy formed from left-to-right.</span></span> <span data-ttu-id="3660c-713">Rozważmy szablon trasy podstawowego kontrolera, `{controller}/{action}/{id?}` Aby uzyskać intuicyjny opis tego, jak to działa.</span><span class="sxs-lookup"><span data-stu-id="3660c-713">Consider the basic controller route template `{controller}/{action}/{id?}` to get an intuitive sense of how this works in practice.</span></span> <span data-ttu-id="3660c-714">**Zmiana** wartości powoduje **unieważnienie** wszystkich wartości tras, które pojawiają się po prawej stronie.</span><span class="sxs-lookup"><span data-stu-id="3660c-714">A **change** to a value **invalidates** all of the route values that appear to the right.</span></span> <span data-ttu-id="3660c-715">Odzwierciedla to założenie hierarchii.</span><span class="sxs-lookup"><span data-stu-id="3660c-715">This reflects the assumption about hierarchy.</span></span> <span data-ttu-id="3660c-716">Jeśli aplikacja ma wartość otoczenia dla `id` , a operacja określa inną wartość dla `controller` :</span><span class="sxs-lookup"><span data-stu-id="3660c-716">If the app has an ambient value for `id`, and the operation specifies a different value for the `controller`:</span></span>

* <span data-ttu-id="3660c-717">`id` nie będzie ponownie używany `{controller}` , ponieważ jest z lewej strony `{id?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-717">`id` won't be reused because `{controller}` is to the left of `{id?}`.</span></span>

<span data-ttu-id="3660c-718">Przykłady ukazujące tę zasadę:</span><span class="sxs-lookup"><span data-stu-id="3660c-718">Some examples demonstrating this principle:</span></span>

* <span data-ttu-id="3660c-719">Jeśli jawne wartości zawierają wartość dla `id` , wartość otoczenia dla `id` jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-719">If the explicit values contain a value for `id`, the ambient value for `id` is ignored.</span></span> <span data-ttu-id="3660c-720">Wartości otoczenia dla `controller` i `action` mogą być używane.</span><span class="sxs-lookup"><span data-stu-id="3660c-720">The ambient values for `controller` and `action` can be used.</span></span>
* <span data-ttu-id="3660c-721">Jeśli jawne wartości zawierają wartość dla `action` , jakakolwiek wartość otoczenia dla `action` jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-721">If the explicit values contain a value for `action`, any ambient value for `action` is ignored.</span></span> <span data-ttu-id="3660c-722">Można użyć wartości otoczenia `controller` .</span><span class="sxs-lookup"><span data-stu-id="3660c-722">The ambient values for `controller` can be used.</span></span> <span data-ttu-id="3660c-723">Jeśli wartość Explicit dla `action` jest inna niż wartość otoczenia dla `action` , `id` wartość nie zostanie użyta.</span><span class="sxs-lookup"><span data-stu-id="3660c-723">If the explicit value for `action` is different from the ambient value for `action`, the `id` value won't be used.</span></span>  <span data-ttu-id="3660c-724">Jeśli wartość Explicit dla `action` jest taka sama jak wartość otoczenia dla `action` , `id` można użyć wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-724">If the explicit value for `action` is the same as the ambient value for `action`, the `id` value can be used.</span></span>
* <span data-ttu-id="3660c-725">Jeśli jawne wartości zawierają wartość dla `controller` , jakakolwiek wartość otoczenia dla `controller` jest ignorowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-725">If the explicit values contain a value for `controller`, any ambient value for `controller` is ignored.</span></span> <span data-ttu-id="3660c-726">Jeśli wartość Explicit dla różni `controller` się od wartości otoczenia dla `controller` , `action` wartości i nie będą `id` używane.</span><span class="sxs-lookup"><span data-stu-id="3660c-726">If the explicit value for `controller` is different from the ambient value for `controller`, the `action` and `id` values won't be used.</span></span> <span data-ttu-id="3660c-727">Jeśli wartość Explicit dla `controller` jest taka sama jak wartość otoczenia dla `controller` , `action` `id` można użyć wartości i.</span><span class="sxs-lookup"><span data-stu-id="3660c-727">If the explicit value for `controller` is the same as the ambient value for `controller`, the `action` and `id` values can be used.</span></span>

<span data-ttu-id="3660c-728">Ten proces jest bardziej skomplikowany przez istnienie tras atrybutów i dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="3660c-728">This process is further complicated by the existence of attribute routes and dedicated conventional routes.</span></span> <span data-ttu-id="3660c-729">Konwencjonalne trasy kontrolerów, takie jak `{controller}/{action}/{id?}` Określanie hierarchii przy użyciu parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-729">Controller conventional routes such as `{controller}/{action}/{id?}` specify a hierarchy using route parameters.</span></span> <span data-ttu-id="3660c-730">W przypadku [dedykowanych tras konwencjonalnych](xref:mvc/controllers/routing#dcr) i [tras atrybutów](xref:mvc/controllers/routing#ar) do kontrolerów i Razor stron:</span><span class="sxs-lookup"><span data-stu-id="3660c-730">For [dedicated conventional routes](xref:mvc/controllers/routing#dcr) and [attribute routes](xref:mvc/controllers/routing#ar) to controllers and Razor Pages:</span></span>

* <span data-ttu-id="3660c-731">Istnieje hierarchia wartości tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-731">There is a hierarchy of route values.</span></span>
* <span data-ttu-id="3660c-732">Nie są one wyświetlane w szablonie.</span><span class="sxs-lookup"><span data-stu-id="3660c-732">They don't appear in the template.</span></span>

<span data-ttu-id="3660c-733">W takich przypadkach generowanie adresów URL definiuje **wymagane wartości** koncepcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-733">For these cases, URL generation defines the **required values** concept.</span></span> <span data-ttu-id="3660c-734">Punkty końcowe utworzone przez kontrolery i Razor strony mają określone wartości, które zezwalają na działanie unieważniania wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-734">Endpoints created by controllers and Razor Pages have required values specified that allow route value invalidation to work.</span></span>

<span data-ttu-id="3660c-735">Nieszczegółowy algorytm unieważniania wartości trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-735">The route value invalidation algorithm in detail:</span></span>

* <span data-ttu-id="3660c-736">Nazwy wymaganych wartości są łączone z parametrami trasy, a następnie przetwarzane od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="3660c-736">The required value names are combined with the route parameters, then processed from left-to-right.</span></span>
* <span data-ttu-id="3660c-737">Dla każdego parametru wartość otoczenia i wartość jawna są porównywane:</span><span class="sxs-lookup"><span data-stu-id="3660c-737">For each parameter, the ambient value and explicit value are compared:</span></span>
    * <span data-ttu-id="3660c-738">Jeśli wartość otoczenia i wartość jawna są takie same, proces jest kontynuowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-738">If the ambient value and explicit value are the same, the process continues.</span></span>
    * <span data-ttu-id="3660c-739">Jeśli wartość otoczenia jest obecna i wartość jawna nie jest, podczas generowania adresu URL zostanie użyta wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-739">If the ambient value is present and the explicit value isn't, the ambient value is used when generating the URL.</span></span>
    * <span data-ttu-id="3660c-740">Jeśli wartość otoczenia nie jest obecna, a wartość jawna to, Odrzuć wartość otoczenia i wszystkie kolejne wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-740">If the ambient value isn't present and the explicit value is, reject the ambient value and all subsequent ambient values.</span></span>
    * <span data-ttu-id="3660c-741">Jeśli wartość otoczenia i wartość jawna są obecne, a dwie wartości są różne, Odrzuć wartość otoczenia i wszystkie kolejne wartości otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-741">If the ambient value and the explicit value are present, and the two values are different, reject the ambient value and all subsequent ambient values.</span></span>

<span data-ttu-id="3660c-742">W tym momencie operacja generowania adresu URL jest gotowa do oszacowania ograniczeń trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-742">At this point, the URL generation operation is ready to evaluate route constraints.</span></span> <span data-ttu-id="3660c-743">Zestaw zaakceptowanych wartości jest połączony z wartościami domyślnymi parametrów, które są dostarczane do ograniczeń.</span><span class="sxs-lookup"><span data-stu-id="3660c-743">The set of accepted values is combined with the parameter default values, which is provided to constraints.</span></span> <span data-ttu-id="3660c-744">Jeśli wszystkie ograniczenia są przekazywane, operacja będzie kontynuowana.</span><span class="sxs-lookup"><span data-stu-id="3660c-744">If the constraints all pass, the operation continues.</span></span>

<span data-ttu-id="3660c-745">Następnie **zaakceptowane wartości** mogą służyć do rozwinięcia szablonu trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-745">Next, the **accepted values** can be used to expand the route template.</span></span> <span data-ttu-id="3660c-746">Szablon trasy jest przetwarzany:</span><span class="sxs-lookup"><span data-stu-id="3660c-746">The route template is processed:</span></span>

* <span data-ttu-id="3660c-747">Od lewej do prawej.</span><span class="sxs-lookup"><span data-stu-id="3660c-747">From left-to-right.</span></span>
* <span data-ttu-id="3660c-748">Każdy parametr ma zaakceptowaną wartość.</span><span class="sxs-lookup"><span data-stu-id="3660c-748">Each parameter has its accepted value substituted.</span></span>
* <span data-ttu-id="3660c-749">W przypadku następujących specjalnych przypadków:</span><span class="sxs-lookup"><span data-stu-id="3660c-749">With the following special cases:</span></span>
  * <span data-ttu-id="3660c-750">Jeśli w zaakceptowanych wartości brakuje wartości, a parametr ma wartość domyślną, zostanie użyta wartość domyślna.</span><span class="sxs-lookup"><span data-stu-id="3660c-750">If the accepted values is missing a value and the parameter has a default value, the default value is used.</span></span>
  * <span data-ttu-id="3660c-751">Jeśli w zaakceptowanych wartości brakuje wartości, a parametr jest opcjonalny, przetwarzanie jest kontynuowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-751">If the accepted values is missing a value and the parameter is optional, processing continues.</span></span>
  * <span data-ttu-id="3660c-752">Jeśli którykolwiek z parametrów trasy po prawej stronie brakującego parametru opcjonalnego ma wartość, operacja kończy się niepowodzeniem.</span><span class="sxs-lookup"><span data-stu-id="3660c-752">If any route parameter to the right of a missing optional parameter has a value, the operation fails.</span></span>
  * <!-- review default-valued parameters optional parameters --> <span data-ttu-id="3660c-753">W miarę możliwości są zwijane ciągłe parametry wartości domyślnych i parametry opcjonalne.</span><span class="sxs-lookup"><span data-stu-id="3660c-753">Contiguous default-valued parameters and optional parameters are collapsed where possible.</span></span>

<span data-ttu-id="3660c-754">Wartości jawnie podane, które nie pasują do segmentu trasy, są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="3660c-754">Values explicitly provided that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="3660c-755">W poniższej tabeli przedstawiono wynik przy użyciu szablonu trasy `{controller}/{action}/{id?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-755">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="3660c-756">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="3660c-756">Ambient Values</span></span>                     | <span data-ttu-id="3660c-757">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="3660c-757">Explicit Values</span></span>                        | <span data-ttu-id="3660c-758">Wynik</span><span class="sxs-lookup"><span data-stu-id="3660c-758">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="3660c-759">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-759">controller = "Home"</span></span>                | <span data-ttu-id="3660c-760">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-760">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-761">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-761">controller = "Home"</span></span>                | <span data-ttu-id="3660c-762">Controller = "Order", Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-762">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="3660c-763">Controller = "Home", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-763">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="3660c-764">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-764">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-765">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-765">controller = "Home"</span></span>                | <span data-ttu-id="3660c-766">Action = "informacje", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-766">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

### <a name="problems-with-route-value-invalidation"></a><span data-ttu-id="3660c-767">Problemy z nieprawidłową wartością trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-767">Problems with route value invalidation</span></span>

<span data-ttu-id="3660c-768">W ASP.NET Core 3,0 niektóre schematy generacji adresów URL używane we wcześniejszych wersjach ASP.NET Core nie działają poprawnie z generowaniem adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-768">As of ASP.NET Core 3.0, some URL generation schemes used in earlier ASP.NET Core versions don't work well with URL generation.</span></span> <span data-ttu-id="3660c-769">Zespół ASP.NET Core planuje dodać funkcje, aby rozwiązać te potrzeby w przyszłej wersji.</span><span class="sxs-lookup"><span data-stu-id="3660c-769">The ASP.NET Core team plans to add features to address these needs in a future release.</span></span> <span data-ttu-id="3660c-770">Teraz najlepszym rozwiązaniem jest użycie starszego routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-770">For now the best solution is to use legacy routing.</span></span>

<span data-ttu-id="3660c-771">Poniższy kod przedstawia przykładowy Schemat generowania adresu URL, który nie jest obsługiwany przez Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-771">The following code shows an example of a URL generation scheme that's not supported by routing.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupUnsupported.cs?name=snippet)]

<span data-ttu-id="3660c-772">W powyższym kodzie, `culture` parametr trasy jest używany do lokalizacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-772">In the preceding code, the `culture` route parameter is used for localization.</span></span> <span data-ttu-id="3660c-773">Chcemy, aby parametr był `culture` zawsze akceptowany jako wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-773">The desire is to have the `culture` parameter always accepted as an ambient value.</span></span> <span data-ttu-id="3660c-774">Jednak `culture` parametr nie jest akceptowany jako wartość otoczenia ze względu na sposób działania wymaganych wartości:</span><span class="sxs-lookup"><span data-stu-id="3660c-774">However, the `culture` parameter is not accepted as an ambient value because of the way required values work:</span></span>

* <span data-ttu-id="3660c-775">W `"default"` szablonie trasy `culture` parametr trasy jest z lewej strony `controller` , więc zmiany `controller` nie zostaną unieważnione `culture` .</span><span class="sxs-lookup"><span data-stu-id="3660c-775">In the `"default"` route template, the `culture` route parameter is to the left of `controller`, so changes to `controller` won't invalidate `culture`.</span></span>
* <span data-ttu-id="3660c-776">W `"blog"` szablonie trasy `culture` parametr trasy jest uznawany za z prawej strony `controller` , która jest wyświetlana w wymaganych wartościach.</span><span class="sxs-lookup"><span data-stu-id="3660c-776">In the `"blog"` route template, the `culture` route parameter is considered to be to the right of `controller`, which appears in the required values.</span></span>

## <a name="configuring-endpoint-metadata"></a><span data-ttu-id="3660c-777">Konfigurowanie metadanych punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="3660c-777">Configuring endpoint metadata</span></span>

<span data-ttu-id="3660c-778">Poniższe linki zawierają informacje dotyczące konfigurowania metadanych punktu końcowego:</span><span class="sxs-lookup"><span data-stu-id="3660c-778">The following links provide information on configuring endpoint metadata:</span></span>

* [<span data-ttu-id="3660c-779">Włączanie mechanizmu CORS przy użyciu routingu punktu końcowego</span><span class="sxs-lookup"><span data-stu-id="3660c-779">Enable Cors with endpoint routing</span></span>](xref:security/cors#enable-cors-with-endpoint-routing)
* <span data-ttu-id="3660c-780">[Przykład IAuthorizationPolicyProvider](https://github.com/dotnet/AspNetCore/tree/release/3.1/src/Security/samples/CustomPolicyProvider) przy użyciu `[MinimumAgeAuthorize]` atrybutu niestandardowego</span><span class="sxs-lookup"><span data-stu-id="3660c-780">[IAuthorizationPolicyProvider sample](https://github.com/dotnet/AspNetCore/tree/release/3.1/src/Security/samples/CustomPolicyProvider) using a custom `[MinimumAgeAuthorize]` attribute</span></span>
* <span data-ttu-id="3660c-781">[Testowanie uwierzytelniania przy użyciu atrybutu [autoryzuje]](xref:security/authentication/identity#test-identity)</span><span class="sxs-lookup"><span data-stu-id="3660c-781">[Test authentication with the [Authorize] attribute](xref:security/authentication/identity#test-identity)</span></span>
* <xref:Microsoft.AspNetCore.Builder.AuthorizationEndpointConventionBuilderExtensions.RequireAuthorization*>
* <span data-ttu-id="3660c-782">[Wybieranie schematu z atrybutem [autoryzuje]](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span><span class="sxs-lookup"><span data-stu-id="3660c-782">[Selecting the scheme with the [Authorize] attribute](xref:security/authorization/limitingidentitybyscheme#selecting-the-scheme-with-the-authorize-attribute)</span></span>
* <span data-ttu-id="3660c-783">[Stosowanie zasad przy użyciu atrybutu [autoryzuje]](xref:security/authorization/policies#apply-policies-to-mvc-controllers)</span><span class="sxs-lookup"><span data-stu-id="3660c-783">[Apply policies using the [Authorize] attribute](xref:security/authorization/policies#apply-policies-to-mvc-controllers)</span></span>
* <xref:security/authorization/roles>

<a name="hostmatch"></a>

## <a name="host-matching-in-routes-with-requirehost"></a><span data-ttu-id="3660c-784">Pasujące hosty w trasach z RequireHost</span><span class="sxs-lookup"><span data-stu-id="3660c-784">Host matching in routes with RequireHost</span></span>

<span data-ttu-id="3660c-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> stosuje ograniczenie do trasy wymagającej określonego hosta.</span><span class="sxs-lookup"><span data-stu-id="3660c-785"><xref:Microsoft.AspNetCore.Builder.RoutingEndpointConventionBuilderExtensions.RequireHost*> applies a constraint to the route which requires the specified host.</span></span> <span data-ttu-id="3660c-786">`RequireHost`Parametrem lub [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) może być:</span><span class="sxs-lookup"><span data-stu-id="3660c-786">The `RequireHost` or [[Host]](xref:Microsoft.AspNetCore.Routing.HostAttribute) parameter can be:</span></span>

* <span data-ttu-id="3660c-787">Host: `www.domain.com` , dopasowuje `www.domain.com` się do dowolnego portu.</span><span class="sxs-lookup"><span data-stu-id="3660c-787">Host: `www.domain.com`, matches `www.domain.com` with any port.</span></span>
* <span data-ttu-id="3660c-788">Host z symbolami wieloznacznymi: `*.domain.com` , dopasowań `www.domain.com` , `subdomain.domain.com` lub `www.subdomain.domain.com` na dowolnym porcie.</span><span class="sxs-lookup"><span data-stu-id="3660c-788">Host with wildcard: `*.domain.com`, matches `www.domain.com`, `subdomain.domain.com`, or `www.subdomain.domain.com` on any port.</span></span>
* <span data-ttu-id="3660c-789">Port: `*:5000` , jest zgodny z portem 5000 z dowolnym hostem.</span><span class="sxs-lookup"><span data-stu-id="3660c-789">Port: `*:5000`, matches port 5000 with any host.</span></span>
* <span data-ttu-id="3660c-790">Host i port: `www.domain.com:5000` lub `*.domain.com:5000` , dopasowuje hosta i port.</span><span class="sxs-lookup"><span data-stu-id="3660c-790">Host and port: `www.domain.com:5000` or `*.domain.com:5000`, matches host and port.</span></span>

<span data-ttu-id="3660c-791">Można określić wiele parametrów przy użyciu `RequireHost` lub `[Host]` .</span><span class="sxs-lookup"><span data-stu-id="3660c-791">Multiple parameters can be specified using `RequireHost` or `[Host]`.</span></span> <span data-ttu-id="3660c-792">Ograniczenie jest zgodne z hostami prawidłowymi dla któregokolwiek z parametrów.</span><span class="sxs-lookup"><span data-stu-id="3660c-792">The constraint  matches hosts valid for any of the parameters.</span></span> <span data-ttu-id="3660c-793">Na przykład `[Host("domain.com", "*.domain.com")]` dopasowuje `domain.com` , `www.domain.com` , i `subdomain.domain.com` .</span><span class="sxs-lookup"><span data-stu-id="3660c-793">For example, `[Host("domain.com", "*.domain.com")]` matches `domain.com`, `www.domain.com`, and `subdomain.domain.com`.</span></span>

<span data-ttu-id="3660c-794">Następujący kod używa `RequireHost` do żądania określonego hosta trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-794">The following code uses `RequireHost` to require the specified host on the route:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupRequireHost.cs?name=snippet)]

<span data-ttu-id="3660c-795">Poniższy kod używa `[Host]` atrybutu na kontrolerze, aby wymagać któregokolwiek z określonych hostów:</span><span class="sxs-lookup"><span data-stu-id="3660c-795">The following code uses the `[Host]` attribute on the controller to require any of the specified hosts:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/Controllers/ProductController.cs?name=snippet)]

<span data-ttu-id="3660c-796">Gdy `[Host]` atrybut jest stosowany do obu metod:</span><span class="sxs-lookup"><span data-stu-id="3660c-796">When the `[Host]` attribute is applied to both the controller and action method:</span></span>

* <span data-ttu-id="3660c-797">Atrybut akcji jest używany.</span><span class="sxs-lookup"><span data-stu-id="3660c-797">The attribute on the action is used.</span></span>
* <span data-ttu-id="3660c-798">Atrybut Controller jest ignorowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-798">The controller attribute is ignored.</span></span>

## <a name="performance-guidance-for-routing"></a><span data-ttu-id="3660c-799">Wskazówki dotyczące wydajności routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-799">Performance guidance for routing</span></span>

<span data-ttu-id="3660c-800">Większość routingu została zaktualizowana w ASP.NET Core 3,0, aby zwiększyć wydajność.</span><span class="sxs-lookup"><span data-stu-id="3660c-800">Most of routing was updated in ASP.NET Core 3.0 to increase performance.</span></span>

<span data-ttu-id="3660c-801">Gdy aplikacja ma problemy z wydajnością, routing jest często podejrzany o problem.</span><span class="sxs-lookup"><span data-stu-id="3660c-801">When an app has performance problems, routing is often suspected as the problem.</span></span> <span data-ttu-id="3660c-802">Podejrzenie, że Routing jest podejrzany, że platformy, takie jak kontrolery i Razor strony, zgłaszają czas spędzony w ramach struktury w swoich komunikatach rejestrowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-802">The reason routing is suspected is that frameworks like controllers and Razor Pages report the amount of time spent inside the framework in their logging messages.</span></span> <span data-ttu-id="3660c-803">Gdy istnieje znacząca różnica między czasem zgłoszonym przez kontrolery i łącznym czasem żądania:</span><span class="sxs-lookup"><span data-stu-id="3660c-803">When there's a significant difference between the time reported by controllers and the total time of the request:</span></span>

* <span data-ttu-id="3660c-804">Deweloperzy eliminują kod aplikacji jako źródło problemu.</span><span class="sxs-lookup"><span data-stu-id="3660c-804">Developers eliminate their app code as the source of the problem.</span></span>
* <span data-ttu-id="3660c-805">Zakłada się, że kierowanie jest przyczyną.</span><span class="sxs-lookup"><span data-stu-id="3660c-805">It's common to assume routing is the cause.</span></span>

<span data-ttu-id="3660c-806">Routing jest testowaną wydajnością przy użyciu tysięcy punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-806">Routing is performance tested using thousands of endpoints.</span></span> <span data-ttu-id="3660c-807">Jest mało prawdopodobne, że w typowej aplikacji wystąpi problem z wydajnością, tylko jest zbyt duży.</span><span class="sxs-lookup"><span data-stu-id="3660c-807">It's unlikely that a typical app will encounter a performance problem just by being too large.</span></span> <span data-ttu-id="3660c-808">Najbardziej powszechną przyczyną niskiej wydajności routingu jest zwykle nieprawidłowo działające niestandardowe oprogramowanie pośredniczące.</span><span class="sxs-lookup"><span data-stu-id="3660c-808">The most common root cause of slow routing performance is usually a badly-behaving custom middleware.</span></span>

<span data-ttu-id="3660c-809">Poniższy przykładowy kod demonstruje podstawową technikę zawężania źródła opóźnienia:</span><span class="sxs-lookup"><span data-stu-id="3660c-809">This following code sample demonstrates a basic technique for narrowing down the source of delay:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupDelay.cs?name=snippet)]

<span data-ttu-id="3660c-810">Do routingu czasu:</span><span class="sxs-lookup"><span data-stu-id="3660c-810">To time routing:</span></span>

* <span data-ttu-id="3660c-811">Pozostawij każde oprogramowanie pośredniczące z kopią oprogramowania pośredniczącego w poprzednim kodzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-811">Interleave each middleware with a copy of the timing middleware shown in the preceding code.</span></span>
* <span data-ttu-id="3660c-812">Dodaj unikatowy identyfikator w celu skorelowania danych chronometrażu z kodem.</span><span class="sxs-lookup"><span data-stu-id="3660c-812">Add a unique identifier to correlate the timing data with the code.</span></span>

<span data-ttu-id="3660c-813">Jest to podstawowy sposób na zawężenie opóźnień, gdy jest to istotne, na przykład więcej niż `10ms` .</span><span class="sxs-lookup"><span data-stu-id="3660c-813">This is a basic way to narrow down the delay when it's significant, for example, more than `10ms`.</span></span>  <span data-ttu-id="3660c-814">Odejmowanie `Time 2` od `Time 1` raportów czasu spędzonego w oprogramowaniu `UseRouting` pośredniczącym.</span><span class="sxs-lookup"><span data-stu-id="3660c-814">Subtracting `Time 2` from `Time 1` reports the time spent inside the `UseRouting` middleware.</span></span>

<span data-ttu-id="3660c-815">Poniższy kod używa bardziej kompaktowego podejścia do poprzedniego kodu czasu:</span><span class="sxs-lookup"><span data-stu-id="3660c-815">The following code uses a more compact approach to the preceding timing code:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippetSW)]

[!code-csharp[](routing/samples/3.x/RoutingSample/StartupSW.cs?name=snippet)]

### <a name="potentially-expensive-routing-features"></a><span data-ttu-id="3660c-816">Potencjalnie kosztowna Funkcja routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-816">Potentially expensive routing features</span></span>

<span data-ttu-id="3660c-817">Poniższa lista zawiera szczegółowe informacje o funkcjach routingu, które są stosunkowo kosztowne w porównaniu z podstawowymi szablonami tras:</span><span class="sxs-lookup"><span data-stu-id="3660c-817">The following list provides some insight into routing features that are relatively expensive compared with basic route templates:</span></span>

* <span data-ttu-id="3660c-818">Wyrażenia regularne: można pisać wyrażenia regularne, które są złożone, lub długi czas wykonywania z niewielką ilością danych wejściowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-818">Regular expressions: It's possible to write regular expressions that are complex, or have long running time with a small amount of input.</span></span>

* <span data-ttu-id="3660c-819">Złożone segmenty ( `{x}-{y}-{z}` ):</span><span class="sxs-lookup"><span data-stu-id="3660c-819">Complex segments (`{x}-{y}-{z}`):</span></span> 
  * <span data-ttu-id="3660c-820">Są znacznie droższe niż analizowanie zwykłego segmentu ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-820">Are significantly more expensive than parsing a regular URL path segment.</span></span>
  * <span data-ttu-id="3660c-821">Powoduje przydzielenie wielu podciągów.</span><span class="sxs-lookup"><span data-stu-id="3660c-821">Result in many more substrings being allocated.</span></span>
  * <span data-ttu-id="3660c-822">Logika złożonego segmentu nie została zaktualizowana w ramach aktualizacji wydajności ASP.NET Core 3,0.</span><span class="sxs-lookup"><span data-stu-id="3660c-822">The complex segment logic was not updated in ASP.NET Core 3.0 routing performance update.</span></span>

* <span data-ttu-id="3660c-823">Synchroniczny dostęp do danych: wiele złożonych aplikacji ma dostęp do bazy danych w ramach ich routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-823">Synchronous data access: Many complex apps have database access as part of their routing.</span></span> <span data-ttu-id="3660c-824">ASP.NET Core 2,2 i wcześniejsze routinge mogą nie zapewniać odpowiednich punktów rozszerzalności do obsługi routingu dostępu do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="3660c-824">ASP.NET Core 2.2 and earlier routing might not provide the right extensibility points to support database access routing.</span></span> <span data-ttu-id="3660c-825">Na przykład, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> i <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> są synchroniczne.</span><span class="sxs-lookup"><span data-stu-id="3660c-825">For example, <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, and <xref:Microsoft.AspNetCore.Mvc.ActionConstraints.IActionConstraint> are synchronous.</span></span> <span data-ttu-id="3660c-826">Punkty rozszerzalności, takie jak <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> i, <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> są asynchroniczne.</span><span class="sxs-lookup"><span data-stu-id="3660c-826">Extensibility points such as <xref:Microsoft.AspNetCore.Routing.MatcherPolicy> and <xref:Microsoft.AspNetCore.Routing.EndpointSelectorContext> are asynchronous.</span></span>

## <a name="guidance-for-library-authors"></a><span data-ttu-id="3660c-827">Wskazówki dla autorów biblioteki</span><span class="sxs-lookup"><span data-stu-id="3660c-827">Guidance for library authors</span></span>

<span data-ttu-id="3660c-828">Ta sekcja zawiera wskazówki dla autorów biblioteki, które są tworzone w oparciu o Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-828">This section contains guidance for library authors building on top of routing.</span></span> <span data-ttu-id="3660c-829">Te szczegóły są przeznaczone do zapewnienia, że deweloperzy aplikacji mają dobre doświadczenie przy użyciu bibliotek i struktur, które poszerzają Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-829">These details are intended to ensure that app developers have a good experience using libraries and frameworks that extend routing.</span></span>

### <a name="define-endpoints"></a><span data-ttu-id="3660c-830">Definiuj punkty końcowe</span><span class="sxs-lookup"><span data-stu-id="3660c-830">Define endpoints</span></span>

<span data-ttu-id="3660c-831">Aby utworzyć platformę, która używa routingu do dopasowywania adresów URL, Zacznij od zdefiniowania środowiska użytkownika, które kompiluje się w górę <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-831">To create a framework that uses routing for URL matching, start by defining a user experience that builds on top of <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span>

<span data-ttu-id="3660c-832">**Wykonaj** kompilację w usłudze <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-832">**DO** build on top of <xref:Microsoft.AspNetCore.Routing.IEndpointRouteBuilder>.</span></span> <span data-ttu-id="3660c-833">Dzięki temu użytkownicy mogą redagować swoją strukturę przy użyciu innych funkcji ASP.NET Core bez pomyłek.</span><span class="sxs-lookup"><span data-stu-id="3660c-833">This allows users to compose your framework with other ASP.NET Core features without confusion.</span></span> <span data-ttu-id="3660c-834">Każdy szablon ASP.NET Core obejmuje Routing.</span><span class="sxs-lookup"><span data-stu-id="3660c-834">Every ASP.NET Core template includes routing.</span></span> <span data-ttu-id="3660c-835">Załóżmy, że Routing jest obecny i znany użytkownikom.</span><span class="sxs-lookup"><span data-stu-id="3660c-835">Assume routing is present and familiar for users.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="3660c-836">**Należy** zwrócić zapieczętowany Typ konkretny z wywołania do `MapMyFramework(...)` tego implementującego <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-836">**DO** return a sealed concrete type from a call to `MapMyFramework(...)` that implements <xref:Microsoft.AspNetCore.Builder.IEndpointConventionBuilder>.</span></span> <span data-ttu-id="3660c-837">Większość metod struktury jest `Map...` zgodna z tym wzorcem.</span><span class="sxs-lookup"><span data-stu-id="3660c-837">Most framework `Map...` methods follow this pattern.</span></span> <span data-ttu-id="3660c-838">`IEndpointConventionBuilder`Interfejs:</span><span class="sxs-lookup"><span data-stu-id="3660c-838">The `IEndpointConventionBuilder` interface:</span></span>

* <span data-ttu-id="3660c-839">Umożliwia tworzenie metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-839">Allows composability of metadata.</span></span>
* <span data-ttu-id="3660c-840">Jest przeznaczony dla różnych metod rozszerzających.</span><span class="sxs-lookup"><span data-stu-id="3660c-840">Is targeted by a variety of extension methods.</span></span>

<span data-ttu-id="3660c-841">Deklarowanie własnego typu pozwala na dodanie własnych funkcji specyficznych dla platformy do konstruktora.</span><span class="sxs-lookup"><span data-stu-id="3660c-841">Declaring your own type allows you to add your own framework-specific functionality to the builder.</span></span> <span data-ttu-id="3660c-842">Jest to możliwe, aby otoczyć Konstruktor zadeklarowany przez platformę i przekazać do niego wywołania.</span><span class="sxs-lookup"><span data-stu-id="3660c-842">It's ok to wrap a framework-declared builder and forward calls to it.</span></span>

```csharp
app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequireAuthorization()
                                 .WithMyFrameworkFeature(awesome: true);

    endpoints.MapHealthChecks("/healthz");
});
```

<span data-ttu-id="3660c-843">**Rozważ** napisanie własnych <xref:Microsoft.AspNetCore.Routing.EndpointDataSource> .</span><span class="sxs-lookup"><span data-stu-id="3660c-843">**CONSIDER** writing your own <xref:Microsoft.AspNetCore.Routing.EndpointDataSource>.</span></span> <span data-ttu-id="3660c-844">`EndpointDataSource` to element podstawowy niskiego poziomu służący do deklarowania i aktualizowania kolekcji punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-844">`EndpointDataSource` is the low-level primitive for declaring and updating a collection of endpoints.</span></span> <span data-ttu-id="3660c-845">`EndpointDataSource` to zaawansowany interfejs API używany przez kontrolery i Razor strony.</span><span class="sxs-lookup"><span data-stu-id="3660c-845">`EndpointDataSource` is a powerful API used by controllers and Razor Pages.</span></span>

<span data-ttu-id="3660c-846">Testy routingu mają [podstawowy przykład](https://github.com/dotnet/AspNetCore/blob/main/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) źródła danych, które nie są aktualizowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-846">The routing tests have a [basic example](https://github.com/dotnet/AspNetCore/blob/main/src/Http/Routing/test/testassets/RoutingSandbox/Framework/FrameworkEndpointDataSource.cs#L17) of a non-updating data source.</span></span>

<span data-ttu-id="3660c-847">**Nie** należy próbować rejestrować `EndpointDataSource` domyślnie.</span><span class="sxs-lookup"><span data-stu-id="3660c-847">**DO NOT** attempt to register an `EndpointDataSource` by default.</span></span> <span data-ttu-id="3660c-848">Wymagaj od użytkowników zarejestrowania struktury w programie <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-848">Require users to register your framework in <xref:Microsoft.AspNetCore.Builder.EndpointRoutingApplicationBuilderExtensions.UseEndpoints*>.</span></span> <span data-ttu-id="3660c-849">Wyznaczanie trasy polega na tym, że nic nie jest uwzględniane domyślnie, a `UseEndpoints` to miejsce do rejestrowania punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-849">The philosophy of routing is that nothing is included by default, and that `UseEndpoints` is the place to register endpoints.</span></span>

### <a name="creating-routing-integrated-middleware"></a><span data-ttu-id="3660c-850">Tworzenie oprogramowania pośredniczącego zintegrowanego z routingiem</span><span class="sxs-lookup"><span data-stu-id="3660c-850">Creating routing-integrated middleware</span></span>

<span data-ttu-id="3660c-851">**Należy rozważyć** Definiowanie typów metadanych jako interfejsu.</span><span class="sxs-lookup"><span data-stu-id="3660c-851">**CONSIDER** defining metadata types as an interface.</span></span>

<span data-ttu-id="3660c-852">**Czy** można używać typów metadanych jako atrybutu dla klas i metod.</span><span class="sxs-lookup"><span data-stu-id="3660c-852">**DO** make it possible to use metadata types as an attribute on classes and methods.</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet2)]

<span data-ttu-id="3660c-853">Platformy, takie jak kontrolery i Razor strony, obsługują stosowanie atrybutów metadanych do typów i metod.</span><span class="sxs-lookup"><span data-stu-id="3660c-853">Frameworks like controllers and Razor Pages support applying metadata attributes to types and methods.</span></span> <span data-ttu-id="3660c-854">W przypadku deklarowania typów metadanych:</span><span class="sxs-lookup"><span data-stu-id="3660c-854">If you declare metadata types:</span></span>

* <span data-ttu-id="3660c-855">Udostępnij je jako [atrybuty](/dotnet/csharp/programming-guide/concepts/attributes/).</span><span class="sxs-lookup"><span data-stu-id="3660c-855">Make them accessible as [attributes](/dotnet/csharp/programming-guide/concepts/attributes/).</span></span>
* <span data-ttu-id="3660c-856">Większość użytkowników zna zastosowanie atrybutów.</span><span class="sxs-lookup"><span data-stu-id="3660c-856">Most users are familiar with applying attributes.</span></span>

<span data-ttu-id="3660c-857">Deklarowanie typu metadanych jako interfejsu dodaje kolejną warstwę elastyczność:</span><span class="sxs-lookup"><span data-stu-id="3660c-857">Declaring a metadata type as an interface adds another layer of flexibility:</span></span>

* <span data-ttu-id="3660c-858">Interfejsy są umożliwiające tworzenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-858">Interfaces are composable.</span></span>
* <span data-ttu-id="3660c-859">Deweloperzy mogą zadeklarować własne typy, które łączą wiele zasad.</span><span class="sxs-lookup"><span data-stu-id="3660c-859">Developers can declare their own types that combine multiple policies.</span></span>

<span data-ttu-id="3660c-860">**Czy** można zastąpić metadane, jak pokazano w następującym przykładzie:</span><span class="sxs-lookup"><span data-stu-id="3660c-860">**DO** make it possible to override metadata, as shown in the following example:</span></span>

[!code-csharp[](routing/samples/3.x/RoutingSample/ICoolMetadata.cs?name=snippet)]

<span data-ttu-id="3660c-861">Najlepszym sposobem postępowania z tymi wskazówkami jest uniknięcie definiowania **metadanych znacznika**:</span><span class="sxs-lookup"><span data-stu-id="3660c-861">The best way to follow these guidelines is to avoid defining **marker metadata**:</span></span>

* <span data-ttu-id="3660c-862">Nie wyszukuj tylko obecności typu metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-862">Don't just look for the presence of a metadata type.</span></span>
* <span data-ttu-id="3660c-863">Zdefiniuj Właściwość metadanych i sprawdź właściwość.</span><span class="sxs-lookup"><span data-stu-id="3660c-863">Define a property on the metadata and check the property.</span></span>

<span data-ttu-id="3660c-864">Zbieranie metadanych jest uporządkowane i obsługuje zastępowanie według priorytetu.</span><span class="sxs-lookup"><span data-stu-id="3660c-864">The metadata collection is ordered and supports overriding by priority.</span></span> <span data-ttu-id="3660c-865">W przypadku kontrolerów metadane metody akcji są najbardziej specyficzne.</span><span class="sxs-lookup"><span data-stu-id="3660c-865">In the case of controllers, metadata on the action method is most specific.</span></span>

<span data-ttu-id="3660c-866">**Zrób** oprogramowanie pośredniczące przydatne w przypadku routingu i bez niego.</span><span class="sxs-lookup"><span data-stu-id="3660c-866">**DO** make middleware useful with and without routing.</span></span>

```csharp
app.UseRouting();

app.UseAuthorization(new AuthorizationPolicy() { ... });

app.UseEndpoints(endpoints =>
{
    // Your framework
    endpoints.MapMyFramework(...).RequireAuthorization();
});
```

<span data-ttu-id="3660c-867">Na przykład w tych wytycznych należy wziąć pod uwagę `UseAuthorization` oprogramowanie pośredniczące.</span><span class="sxs-lookup"><span data-stu-id="3660c-867">As an example of this guideline, consider the `UseAuthorization` middleware.</span></span> <span data-ttu-id="3660c-868">Oprogramowanie pośredniczące autoryzacji umożliwia przekazywanie zasad powrotu.</span><span class="sxs-lookup"><span data-stu-id="3660c-868">The authorization middleware allows you to pass in a fallback policy.</span></span> <!-- shown where?  (shown here) --> <span data-ttu-id="3660c-869">Zasady powrotu, jeśli są określone, mają zastosowanie do obu:</span><span class="sxs-lookup"><span data-stu-id="3660c-869">The fallback policy, if specified, applies to both:</span></span>

* <span data-ttu-id="3660c-870">Punkty końcowe bez określonych zasad.</span><span class="sxs-lookup"><span data-stu-id="3660c-870">Endpoints without a specified policy.</span></span>
* <span data-ttu-id="3660c-871">Żądania, które nie pasują do punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-871">Requests that don't match an endpoint.</span></span>

<span data-ttu-id="3660c-872">Dzięki temu oprogramowanie pośredniczące autoryzacji jest przydatne poza kontekstem routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-872">This makes the authorization middleware useful outside of the context of routing.</span></span> <span data-ttu-id="3660c-873">Oprogramowanie pośredniczące autoryzacji może być używane na potrzeby tradycyjnego programowania oprogramowania pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-873">The authorization middleware can be used for traditional middleware programming.</span></span>

[!INCLUDE[](~/includes/dbg-route.md)]

::: moniker-end

::: moniker range="= aspnetcore-2.2"

<span data-ttu-id="3660c-874">Routing jest odpowiedzialny za mapowanie identyfikatorów URI żądań na punkty końcowe i wysyłanie żądań przychodzących do tych punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-874">Routing is responsible for mapping request URIs to endpoints and dispatching incoming requests to those endpoints.</span></span> <span data-ttu-id="3660c-875">Trasy są zdefiniowane w aplikacji i konfigurowane podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-875">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="3660c-876">Trasa może opcjonalnie wyodrębnić wartości z adresu URL zawartego w żądaniu. te wartości mogą być następnie używane do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="3660c-876">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="3660c-877">Przy użyciu informacji o trasie z aplikacji Routing jest również w stanie generować adresy URL mapowane na punkty końcowe.</span><span class="sxs-lookup"><span data-stu-id="3660c-877">Using route information from the app, routing is also able to generate URLs that map to endpoints.</span></span>

<span data-ttu-id="3660c-878">Aby użyć najnowszych scenariuszy routingu w ASP.NET Core 2,2, określ [wersję zgodności](xref:mvc/compatibility-version) do rejestracji usług MVC w `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-878">To use the latest routing scenarios in ASP.NET Core 2.2, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="3660c-879"><xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting>Opcja określa, czy funkcja routingu powinna wewnętrznie używać logiki opartej na punkcie końcowym lub <xref:Microsoft.AspNetCore.Routing.IRouter> logiki opartej na ASP.NET Core 2,1 lub starszej.</span><span class="sxs-lookup"><span data-stu-id="3660c-879">The <xref:Microsoft.AspNetCore.Mvc.MvcOptions.EnableEndpointRouting> option determines if routing should internally use endpoint-based logic or the <xref:Microsoft.AspNetCore.Routing.IRouter>-based logic of ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="3660c-880">Gdy wersja zgodności jest ustawiona na 2,2 lub nowszej, wartość domyślna to `true` .</span><span class="sxs-lookup"><span data-stu-id="3660c-880">When the compatibility version is set to 2.2 or later, the default value is `true`.</span></span> <span data-ttu-id="3660c-881">Ustaw wartość na, aby `false` użyć poprzedniej logiki routingu:</span><span class="sxs-lookup"><span data-stu-id="3660c-881">Set the value to `false` to use the prior routing logic:</span></span>

```csharp
// Use the routing logic of ASP.NET Core 2.1 or earlier:
services.AddMvc(options => options.EnableEndpointRouting = false)
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_2);
```

<span data-ttu-id="3660c-882">Więcej informacji na temat <xref:Microsoft.AspNetCore.Routing.IRouter> routingu opartego na usłudze można znaleźć w [wersji ASP.NET Core 2,1 tego tematu](?view=aspnetcore-2.1).</span><span class="sxs-lookup"><span data-stu-id="3660c-882">For more information on <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, see the [ASP.NET Core 2.1 version of this topic](?view=aspnetcore-2.1).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3660c-883">Ten dokument obejmuje Routing ASP.NET Core niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="3660c-883">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="3660c-884">Aby uzyskać informacje na temat ASP.NET Core routingu MVC, zobacz <xref:mvc/controllers/routing> .</span><span class="sxs-lookup"><span data-stu-id="3660c-884">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="3660c-885">Aby uzyskać informacje na temat Konwencji routingu na Razor stronach, zobacz <xref:razor-pages/razor-pages-conventions> .</span><span class="sxs-lookup"><span data-stu-id="3660c-885">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="3660c-886">[Wyświetl lub pobierz przykładowy kod](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="3660c-886">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="3660c-887">Podstawy routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-887">Routing basics</span></span>

<span data-ttu-id="3660c-888">Większość aplikacji powinna wybrać podstawowy i opisowy schemat routingu, aby adresy URL były czytelne i zrozumiałe.</span><span class="sxs-lookup"><span data-stu-id="3660c-888">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="3660c-889">Domyślna trasa konwencjonalna `{controller=Home}/{action=Index}/{id?}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-889">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="3660c-890">Obsługuje podstawowy i opisowy schemat routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-890">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="3660c-891">Jest użytecznym punktem wyjścia dla aplikacji opartych na interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3660c-891">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="3660c-892">Deweloperzy często dodają dodatkowe trasy zwięzła do obszarów o dużym ruchu w aplikacji w wyspecjalizowanych sytuacjach przy użyciu [routingu atrybutów](xref:mvc/controllers/routing#attribute-routing) lub dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="3660c-892">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span> <span data-ttu-id="3660c-893">Wyspecjalizowane sytuacje obejmują m.in. punkty końcowe, blog i handlu elektronicznego.</span><span class="sxs-lookup"><span data-stu-id="3660c-893">Specialized situations examples include, blog and ecommerce endpoints.</span></span>

<span data-ttu-id="3660c-894">Interfejsy API sieci Web powinny używać routingu atrybutów do modelowania funkcjonalności aplikacji jako zestawu zasobów, w których operacje są reprezentowane przez zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="3660c-894">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="3660c-895">Oznacza to, że wiele operacji, na przykład GET i POST, dla tego samego zasobu logicznego używa tego samego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-895">This means that many operations, for example, GET, and POST, on the same logical resource use the same URL.</span></span> <span data-ttu-id="3660c-896">Routing atrybutu zapewnia poziom kontroli, który jest wymagany do dokładnego projektowania układu publicznego punktu końcowego interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="3660c-896">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="3660c-897">Razor Aplikacje stron używają domyślnego routingu konwencjonalnego do obsłużenia nazwanych zasobów w folderze *strony* aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-897">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="3660c-898">Dostępne są dodatkowe konwencje umożliwiające dostosowywanie Razor zachowania routingu stron.</span><span class="sxs-lookup"><span data-stu-id="3660c-898">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="3660c-899">Aby uzyskać więcej informacji, zobacz <xref:razor-pages/index> i <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="3660c-899">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="3660c-900">Obsługa generowania adresów URL umożliwia tworzenie aplikacji bez adresów URL, które mają być połączone ze sobą.</span><span class="sxs-lookup"><span data-stu-id="3660c-900">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="3660c-901">Ta obsługa pozwala rozpocząć od podstawowej konfiguracji routingu i zmodyfikować trasy po ustaleniu układu zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-901">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="3660c-902">Routing używa *punktów końcowych* ( `Endpoint` ) do reprezentowania logicznych punktów końcowych w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-902">Routing uses *endpoints* (`Endpoint`) to represent logical endpoints in an app.</span></span>

<span data-ttu-id="3660c-903">Punkt końcowy definiuje delegata do przetwarzania żądań i kolekcji dowolnych metadanych.</span><span class="sxs-lookup"><span data-stu-id="3660c-903">An endpoint defines a delegate to process requests and a collection of arbitrary metadata.</span></span> <span data-ttu-id="3660c-904">Metadane są używane w celu zaimplementowania zagadnień związanych z wycinaniem w oparciu o zasady i konfigurację dołączone do każdego punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-904">The metadata is used implement cross-cutting concerns based on policies and configuration attached to each endpoint.</span></span>

<span data-ttu-id="3660c-905">System routingu ma następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="3660c-905">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="3660c-906">Składnia szablonu trasy służy do definiowania tras z parametrami trasy z tokenami.</span><span class="sxs-lookup"><span data-stu-id="3660c-906">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="3660c-907">Dozwolona jest konfiguracja języka końcowego w stylu konwencjonalnym i stylu atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3660c-907">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="3660c-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> służy do określenia, czy parametr adresu URL zawiera prawidłową wartość dla danego ograniczenia punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-908"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="3660c-909">Modele aplikacji, takie jak MVC/ Razor Pages, rejestrują wszystkie punkty końcowe, które mają przewidywalne implementację scenariuszy routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-909">App models, such as MVC/Razor Pages, register all of their endpoints, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="3660c-910">Implementacja routingu podejmuje decyzje dotyczące routingu w dowolnym miejscu w potoku programu pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-910">The routing implementation makes routing decisions wherever desired in the middleware pipeline.</span></span>
* <span data-ttu-id="3660c-911">Oprogramowanie pośredniczące, które pojawia się po utworzeniu oprogramowania pośredniczącego, może sprawdzić wynik decyzji punktu końcowego usługi routingu dla danego identyfikatora URI żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-911">Middleware that appears after a Routing Middleware can inspect the result of the Routing Middleware's endpoint decision for a given request URI.</span></span>
* <span data-ttu-id="3660c-912">Można wyliczyć wszystkie punkty końcowe w aplikacji w dowolnym miejscu w potoku programu pośredniczącego.</span><span class="sxs-lookup"><span data-stu-id="3660c-912">It's possible to enumerate all of the endpoints in the app anywhere in the middleware pipeline.</span></span>
* <span data-ttu-id="3660c-913">Aplikacja może używać routingu do generowania adresów URL (na przykład w przypadku przekierowania lub linków) na podstawie informacji o punkcie końcowym, a tym samym unikania zakodowanych adresów URL, co ułatwia łatwość utrzymania.</span><span class="sxs-lookup"><span data-stu-id="3660c-913">An app can use routing to generate URLs (for example, for redirection or links) based on endpoint information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="3660c-914">Generowanie adresów URL jest oparte na adresach, które obsługują arbitralną rozszerzalność:</span><span class="sxs-lookup"><span data-stu-id="3660c-914">URL generation is based on addresses, which support arbitrary extensibility:</span></span>

  * <span data-ttu-id="3660c-915">Interfejs API generatora linków ( <xref:Microsoft.AspNetCore.Routing.LinkGenerator> ) można rozpoznać w dowolnym miejscu przy użyciu [iniekcji zależności (di)](xref:fundamentals/dependency-injection) do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-915">The Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>) can be resolved anywhere using [dependency injection (DI)](xref:fundamentals/dependency-injection) to generate URLs.</span></span>
  * <span data-ttu-id="3660c-916">Gdy interfejs API generatora linków nie jest dostępny za pośrednictwem programu DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> oferuje metody tworzenia adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-916">Where the Link Generator API isn't available via DI, <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>

> [!NOTE]
> <span data-ttu-id="3660c-917">Dzięki wydaniu routingu punktów końcowych w ASP.NET Core 2,2, łączenie punktów końcowych jest ograniczone do Razor akcji i stron MVC/Pages.</span><span class="sxs-lookup"><span data-stu-id="3660c-917">With the release of endpoint routing in ASP.NET Core 2.2, endpoint linking is limited to MVC/Razor Pages actions and pages.</span></span> <span data-ttu-id="3660c-918">Rozszerzenia punktów końcowych konsolidacji są planowane dla przyszłych wersji.</span><span class="sxs-lookup"><span data-stu-id="3660c-918">The expansions of endpoint-linking capabilities is planned for future releases.</span></span>

<span data-ttu-id="3660c-919">Routing jest połączony z potokiem [pośredniczącym](xref:fundamentals/middleware/index) przez <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> klasę.</span><span class="sxs-lookup"><span data-stu-id="3660c-919">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="3660c-920">[ASP.NET Core MVC](xref:mvc/overview) dodaje Routing do potoku oprogramowania pośredniczącego w ramach swojej konfiguracji i obsługuje routing w aplikacjach MVC i Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="3660c-920">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="3660c-921">Aby dowiedzieć się, jak używać routingu jako składnika autonomicznego, zapoznaj się z sekcją [Korzystanie z oprogramowania do routingu](#use-routing-middleware) .</span><span class="sxs-lookup"><span data-stu-id="3660c-921">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="3660c-922">Dopasowanie adresu URL</span><span class="sxs-lookup"><span data-stu-id="3660c-922">URL matching</span></span>

<span data-ttu-id="3660c-923">Dopasowywanie adresów URL to proces, za pomocą którego Routing wysyła żądanie przychodzące do *punktu końcowego*.</span><span class="sxs-lookup"><span data-stu-id="3660c-923">URL matching is the process by which routing dispatches an incoming request to an *endpoint*.</span></span> <span data-ttu-id="3660c-924">Ten proces jest oparty na danych w ścieżce URL, ale można go rozszerzyć w celu uwzględnienia wszelkich danych w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="3660c-924">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="3660c-925">Możliwość wysyłania żądań do oddzielnych programów obsługi jest kluczem do skalowania rozmiaru i złożoności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-925">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="3660c-926">System routingu w ramach routingu punktów końcowych jest odpowiedzialny za wszystkie decyzje dotyczące wysyłania.</span><span class="sxs-lookup"><span data-stu-id="3660c-926">The routing system in endpoint routing is responsible for all dispatching decisions.</span></span> <span data-ttu-id="3660c-927">Ponieważ oprogramowanie pośredniczące stosuje zasady oparte na wybranym punkcie końcowym, ważne jest, aby wszystkie decyzje, które mogą mieć wpływ na wysyłanie lub stosowanie zasad zabezpieczeń, zostały wprowadzone w systemie routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-927">Since the middleware applies policies based on the selected endpoint, it's important that any decision that can affect dispatching or the application of security policies is made inside the routing system.</span></span>

<span data-ttu-id="3660c-928">Po wykonaniu delegata punktu końcowego właściwości [RouteContext. RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) są ustawiane na odpowiednie wartości na podstawie przetwarzania żądania wykonanego do tej pory.</span><span class="sxs-lookup"><span data-stu-id="3660c-928">When the endpoint delegate is executed, the properties of [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) are set to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="3660c-929">[RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) to słownik *wartości tras* uzyskanych z trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-929">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="3660c-930">Te wartości są zwykle określane przez tokenizowanie jako adres URL i mogą służyć do akceptowania danych wejściowych użytkownika lub do dalszej akceptacji decyzji w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-930">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="3660c-931">[RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) to zbiór właściwości dodatkowych danych dotyczących dopasowanej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-931">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="3660c-932"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> zapewnia obsługę kojarzenia danych stanu z każdą trasą, dzięki czemu aplikacja może podejmować decyzje na podstawie dopasowanej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-932"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="3660c-933">Te wartości są zdefiniowane przez dewelopera i **nie** mają wpływu na zachowanie routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-933">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="3660c-934">Ponadto wartości umieszczane w [RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) mogą być dowolnego typu, w przeciwieństwie do [RouteData. wartości](xref:Microsoft.AspNetCore.Routing.RouteData.Values), które muszą być konwertowane do i z ciągów.</span><span class="sxs-lookup"><span data-stu-id="3660c-934">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="3660c-935">[RouteData. routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) to lista tras, które brały udział w pomyślnie dopasowane do żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-935">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="3660c-936">Trasy mogą być zagnieżdżone wewnątrz siebie.</span><span class="sxs-lookup"><span data-stu-id="3660c-936">Routes can be nested inside of one another.</span></span> <span data-ttu-id="3660c-937"><xref:Microsoft.AspNetCore.Routing.RouteData.Routers>Właściwość odzwierciedla ścieżkę przez logiczne drzewo tras, które spowodowały dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-937">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="3660c-938">Ogólnie rzecz biorąc, pierwszy element w <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> jest kolekcją tras i powinien być używany do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-938">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="3660c-939">Ostatnim elementem w programie <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> jest program obsługi trasy, który został dopasowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-939">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation-with-linkgenerator"></a><span data-ttu-id="3660c-940">Generowanie adresu URL za pomocą LinkGenerator</span><span class="sxs-lookup"><span data-stu-id="3660c-940">URL generation with LinkGenerator</span></span>

<span data-ttu-id="3660c-941">Generowanie adresu URL to proces, za pomocą którego Routing może utworzyć ścieżkę URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-941">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="3660c-942">Pozwala to na logiczne rozdzielenie między punktami końcowymi i adresami URL, które uzyskują do nich dostęp.</span><span class="sxs-lookup"><span data-stu-id="3660c-942">This allows for a logical separation between your endpoints and the URLs that access them.</span></span>

<span data-ttu-id="3660c-943">Routing punktów końcowych obejmuje interfejs API generatora linków ( <xref:Microsoft.AspNetCore.Routing.LinkGenerator> ).</span><span class="sxs-lookup"><span data-stu-id="3660c-943">Endpoint routing includes the Link Generator API (<xref:Microsoft.AspNetCore.Routing.LinkGenerator>).</span></span> <span data-ttu-id="3660c-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> jest usługą singleton, którą można pobrać z programu [di](xref:fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="3660c-944"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is a singleton service that can be retrieved from [DI](xref:fundamentals/dependency-injection).</span></span> <span data-ttu-id="3660c-945">Interfejsu API można używać poza kontekstem żądania wykonania.</span><span class="sxs-lookup"><span data-stu-id="3660c-945">The API can be used outside of the context of an executing request.</span></span> <span data-ttu-id="3660c-946">MVC <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> i scenariusze, które opierają <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> się na, takie jak [pomocnicy tagów](xref:mvc/views/tag-helpers/intro), pomocników HTML i [wyniki akcji](xref:mvc/controllers/actions), używają generatora linków, aby zapewnić możliwości generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-946">MVC's <xref:Microsoft.AspNetCore.Mvc.IUrlHelper> and scenarios that rely on <xref:Microsoft.AspNetCore.Mvc.IUrlHelper>, such as [Tag Helpers](xref:mvc/views/tag-helpers/intro), HTML Helpers, and [Action Results](xref:mvc/controllers/actions), use the link generator to provide link generating capabilities.</span></span>

<span data-ttu-id="3660c-947">Generator łącza jest objęty koncepcją i *schematami* *adresów.*</span><span class="sxs-lookup"><span data-stu-id="3660c-947">The link generator is backed by the concept of an *address* and *address schemes*.</span></span> <span data-ttu-id="3660c-948">Schemat adresów jest sposobem określania punktów końcowych, które należy wziąć pod uwagę podczas generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-948">An address scheme is a way of determining the endpoints that should be considered for link generation.</span></span> <span data-ttu-id="3660c-949">Na przykład nazwa trasy i wartości trasy scenariusze wielu użytkowników są znane ze względu na to, że z MVC/ Razor Pages są implementowane jako schemat adresów.</span><span class="sxs-lookup"><span data-stu-id="3660c-949">For example, the route name and route values scenarios many users are familiar with from MVC/Razor Pages are implemented as an address scheme.</span></span>

<span data-ttu-id="3660c-950">Generator łącza umożliwia łączenie z Razor akcjami i stronami MVC/Pages za pomocą następujących metod rozszerzających:</span><span class="sxs-lookup"><span data-stu-id="3660c-950">The link generator can link to MVC/Razor Pages actions and pages via the following extension methods:</span></span>

* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetPathByAction*>
* <xref:Microsoft.AspNetCore.Routing.ControllerLinkGeneratorExtensions.GetUriByAction*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetPathByPage*>
* <xref:Microsoft.AspNetCore.Routing.PageLinkGeneratorExtensions.GetUriByPage*>

<span data-ttu-id="3660c-951">Przeciążenie tych metod przyjmuje argumenty, które zawierają `HttpContext` .</span><span class="sxs-lookup"><span data-stu-id="3660c-951">An overload of these methods accepts arguments that include the `HttpContext`.</span></span> <span data-ttu-id="3660c-952">Metody te są funkcjonalnie równoważne z `Url.Action` i `Url.Page` oferują dodatkową elastyczność i opcje.</span><span class="sxs-lookup"><span data-stu-id="3660c-952">These methods are functionally equivalent to `Url.Action` and `Url.Page` but offer additional flexibility and options.</span></span>

<span data-ttu-id="3660c-953">`GetPath*`Metody są najbardziej podobne do `Url.Action` i `Url.Page` w tym, że generują identyfikator URI zawierający ścieżkę bezwzględną.</span><span class="sxs-lookup"><span data-stu-id="3660c-953">The `GetPath*` methods are most similar to `Url.Action` and `Url.Page` in that they generate a URI containing an absolute path.</span></span> <span data-ttu-id="3660c-954">`GetUri*`Metody zawsze generują bezwzględny identyfikator URI zawierający schemat i hosta.</span><span class="sxs-lookup"><span data-stu-id="3660c-954">The `GetUri*` methods always generate an absolute URI containing a scheme and host.</span></span> <span data-ttu-id="3660c-955">Metody, które akceptują `HttpContext` Identyfikator URI w kontekście żądania wykonania.</span><span class="sxs-lookup"><span data-stu-id="3660c-955">The methods that accept an `HttpContext` generate a URI in the context of the executing request.</span></span> <span data-ttu-id="3660c-956">Użycie wartości tras w otoczeniu, ścieżki podstawowej adresu URL, schematu i hosta z żądania wykonania jest używane, chyba że zostaną zastąpione.</span><span class="sxs-lookup"><span data-stu-id="3660c-956">The ambient route values, URL base path, scheme, and host from the executing request are used unless overridden.</span></span>

<span data-ttu-id="3660c-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> jest wywoływana przy użyciu adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-957"><xref:Microsoft.AspNetCore.Routing.LinkGenerator> is called with an address.</span></span> <span data-ttu-id="3660c-958">Generowanie identyfikatora URI występuje w dwóch krokach:</span><span class="sxs-lookup"><span data-stu-id="3660c-958">Generating a URI occurs in two steps:</span></span>

1. <span data-ttu-id="3660c-959">Adres jest powiązany z listą punktów końcowych, które pasują do adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-959">An address is bound to a list of endpoints that match the address.</span></span>
1. <span data-ttu-id="3660c-960">Wszystkie punkty końcowe `RoutePattern` są oceniane do momentu znalezienia wzorca tras pasującego do dostarczonych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-960">Each endpoint's `RoutePattern` is evaluated until a route pattern that matches the supplied values is found.</span></span> <span data-ttu-id="3660c-961">Wynikowe dane wyjściowe są łączone z innymi częściami identyfikatora URI dostarczanymi do generatora linków i zwracanymi.</span><span class="sxs-lookup"><span data-stu-id="3660c-961">The resulting output is combined with the other URI parts supplied to the link generator and returned.</span></span>

<span data-ttu-id="3660c-962">Metody zapewniane przez <xref:Microsoft.AspNetCore.Routing.LinkGenerator> obsługę funkcji generowania linków standardowych dla dowolnego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-962">The methods provided by <xref:Microsoft.AspNetCore.Routing.LinkGenerator> support standard link generation capabilities for any type of address.</span></span> <span data-ttu-id="3660c-963">Najbardziej wygodnym sposobem korzystania z generatora łączy są metody rozszerzające, które wykonują operacje dla określonego typu adresu.</span><span class="sxs-lookup"><span data-stu-id="3660c-963">The most convenient way to use the link generator is through extension methods that perform operations for a specific address type.</span></span>

| <span data-ttu-id="3660c-964">Metoda rozszerzenia</span><span class="sxs-lookup"><span data-stu-id="3660c-964">Extension Method</span></span>   | <span data-ttu-id="3660c-965">Opis</span><span class="sxs-lookup"><span data-stu-id="3660c-965">Description</span></span>                                                         |
| ------------------ | ------------------------------------------------------------------- |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetPathByAddress*> | <span data-ttu-id="3660c-966">Generuje identyfikator URI z ścieżką bezwzględną na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-966">Generates a URI with an absolute path based on the provided values.</span></span> |
| <xref:Microsoft.AspNetCore.Routing.LinkGenerator.GetUriByAddress*> | <span data-ttu-id="3660c-967">Generuje bezwzględny identyfikator URI na podstawie podanych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-967">Generates an absolute URI based on the provided values.</span></span>             |

> [!WARNING]
> <span data-ttu-id="3660c-968">Należy zwrócić uwagę na następujące konsekwencje wywoływania <xref:Microsoft.AspNetCore.Routing.LinkGenerator> metod:</span><span class="sxs-lookup"><span data-stu-id="3660c-968">Pay attention to the following implications of calling <xref:Microsoft.AspNetCore.Routing.LinkGenerator> methods:</span></span>
>
> * <span data-ttu-id="3660c-969">Użyj `GetUri*` metod rozszerzających z zachowaniem ostrożności w konfiguracji aplikacji, która nie weryfikuje `Host` nagłówka żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="3660c-969">Use `GetUri*` extension methods with caution in an app configuration that doesn't validate the `Host` header of incoming requests.</span></span> <span data-ttu-id="3660c-970">Jeśli `Host` nagłówek żądań przychodzących nie jest zweryfikowany, dane wejściowe żądania niezaufanego mogą być wysyłane z powrotem do klienta w identyfikatorach URI w widoku/stronie.</span><span class="sxs-lookup"><span data-stu-id="3660c-970">If the `Host` header of incoming requests isn't validated, untrusted request input can be sent back to the client in URIs in a view/page.</span></span> <span data-ttu-id="3660c-971">Zaleca się, aby wszystkie aplikacje produkcyjne skonfigurowali swój serwer do sprawdzania poprawności `Host` nagłówka pod kątem znanych prawidłowych wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-971">We recommend that all production apps configure their server to validate the `Host` header against known valid values.</span></span>
>
> * <span data-ttu-id="3660c-972">Należy używać <xref:Microsoft.AspNetCore.Routing.LinkGenerator> z zachowaniem ostrożności w oprogramowaniu pośredniczącym w połączeniu z `Map` lub `MapWhen` .</span><span class="sxs-lookup"><span data-stu-id="3660c-972">Use <xref:Microsoft.AspNetCore.Routing.LinkGenerator> with caution in middleware in combination with `Map` or `MapWhen`.</span></span> <span data-ttu-id="3660c-973">`Map*` zmienia ścieżkę podstawową żądania wykonania, która ma wpływ na dane wyjściowe generowania łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-973">`Map*` changes the base path of the executing request, which affects the output of link generation.</span></span> <span data-ttu-id="3660c-974">Wszystkie <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsy API umożliwiają określanie ścieżki podstawowej.</span><span class="sxs-lookup"><span data-stu-id="3660c-974">All of the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> APIs allow specifying a base path.</span></span> <span data-ttu-id="3660c-975">Zawsze określaj pustą ścieżkę bazową, która ma `Map*` wpływ na generowanie linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-975">Always specify an empty base path to undo `Map*`'s affect on link generation.</span></span>

## <a name="differences-from-earlier-versions-of-routing"></a><span data-ttu-id="3660c-976">Różnice wynikające z wcześniejszych wersji usługi Routing</span><span class="sxs-lookup"><span data-stu-id="3660c-976">Differences from earlier versions of routing</span></span>

<span data-ttu-id="3660c-977">Istnieje kilka różnic między routingiem punktu końcowego w ASP.NET Core 2,2 lub nowszym i wcześniejszymi wersjami routingu w programie ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3660c-977">A few differences exist between endpoint routing in ASP.NET Core 2.2 or later and earlier versions of routing in ASP.NET Core:</span></span>

* <span data-ttu-id="3660c-978">System routingu punktu końcowego nie obsługuje <xref:Microsoft.AspNetCore.Routing.IRouter> rozszerzalności opartej na systemie, w tym dziedziczenie z <xref:Microsoft.AspNetCore.Routing.Route> .</span><span class="sxs-lookup"><span data-stu-id="3660c-978">The endpoint routing system doesn't support <xref:Microsoft.AspNetCore.Routing.IRouter>-based extensibility, including inheriting from <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>

* <span data-ttu-id="3660c-979">Routing punktów końcowych nie obsługuje [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span><span class="sxs-lookup"><span data-stu-id="3660c-979">Endpoint routing doesn't support [WebApiCompatShim](https://www.nuget.org/packages/Microsoft.AspNetCore.Mvc.WebApiCompatShim).</span></span> <span data-ttu-id="3660c-980">Użyj [wersji zgodności](xref:mvc/compatibility-version) 2,1 ( `.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)` ), aby nadal korzystać z podkładki zgodności.</span><span class="sxs-lookup"><span data-stu-id="3660c-980">Use the 2.1 [compatibility version](xref:mvc/compatibility-version) (`.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)`) to continue using the compatibility shim.</span></span>

* <span data-ttu-id="3660c-981">Routing punktów końcowych ma inne zachowanie dla wielkości liter wygenerowanych identyfikatorów URI podczas korzystania z konwencjonalnych tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-981">Endpoint Routing has different behavior for the casing of generated URIs when using conventional routes.</span></span>

  <span data-ttu-id="3660c-982">Rozważmy następujący szablon trasy domyślnej:</span><span class="sxs-lookup"><span data-stu-id="3660c-982">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="3660c-983">Załóżmy, że generujesz link do akcji przy użyciu następującej trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-983">Suppose you generate a link to an action using the following route:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "blog", new { id = 17, });
  ```

  <span data-ttu-id="3660c-984">W przypadku <xref:Microsoft.AspNetCore.Routing.IRouter> routingu opartego na systemie ten kod generuje identyfikator URI `/blog/ReadPost/17` , który uwzględnia wielkość liter podanej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-984">With <xref:Microsoft.AspNetCore.Routing.IRouter>-based routing, this code generates a URI of `/blog/ReadPost/17`, which respects the casing of the provided route value.</span></span> <span data-ttu-id="3660c-985">Routing punktów końcowych w ASP.NET Core 2,2 lub późniejszych produkuje `/Blog/ReadPost/17` ("blog" jest pisane wielkimi literami).</span><span class="sxs-lookup"><span data-stu-id="3660c-985">Endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` ("Blog" is capitalized).</span></span> <span data-ttu-id="3660c-986">Routing punktów końcowych udostępnia `IOutboundParameterTransformer` interfejs, którego można użyć do dostosowania tego zachowania globalnie lub w celu zastosowania różnych konwencji do mapowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-986">Endpoint routing provides the `IOutboundParameterTransformer` interface that can be used to customize this behavior globally or to apply different conventions for mapping URLs.</span></span>

  <span data-ttu-id="3660c-987">Aby uzyskać więcej informacji, zobacz sekcję [informacje dotyczące transformatora parametrów](#parameter-transformer-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-987">For more information, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

* <span data-ttu-id="3660c-988">Generowanie linków używane przez strony MVC/ Razor Pages z trasami konwencjonalnymi działa inaczej podczas próby połączenia z kontrolerem/akcją lub stroną, która nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="3660c-988">Link Generation used by MVC/Razor Pages with conventional routes behaves differently when attempting to link to an controller/action or page that doesn't exist.</span></span>

  <span data-ttu-id="3660c-989">Rozważmy następujący szablon trasy domyślnej:</span><span class="sxs-lookup"><span data-stu-id="3660c-989">Consider the following default route template:</span></span>

  ```csharp
  app.UseMvc(routes =>
  {
      routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");
  });
  ```

  <span data-ttu-id="3660c-990">Załóżmy, że generowany jest link do akcji przy użyciu szablonu domyślnego z następującymi:</span><span class="sxs-lookup"><span data-stu-id="3660c-990">Suppose you generate a link to an action using the default template with the following:</span></span>

  ```csharp
  var link = Url.Action("ReadPost", "Blog", new { id = 17, });
  ```

  <span data-ttu-id="3660c-991">W przypadku `IRouter` routingu opartego na systemie wynik jest zawsze `/Blog/ReadPost/17` , nawet jeśli `BlogController` nie istnieje lub nie ma `ReadPost` metody akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-991">With `IRouter`-based routing, the result is always `/Blog/ReadPost/17`, even if the `BlogController` doesn't exist or doesn't have a `ReadPost` action method.</span></span> <span data-ttu-id="3660c-992">Zgodnie z oczekiwaniami Routing punktów końcowych w ASP.NET Core 2,2 lub nowszej generuje, `/Blog/ReadPost/17` czy istnieje metoda akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-992">As expected, endpoint routing in ASP.NET Core 2.2 or later produces `/Blog/ReadPost/17` if the action method exists.</span></span> <span data-ttu-id="3660c-993">*Jednak w przypadku, gdy akcja nie istnieje, routing punktu końcowego tworzy pusty ciąg.*</span><span class="sxs-lookup"><span data-stu-id="3660c-993">*However, endpoint routing produces an empty string if the action doesn't exist.*</span></span> <span data-ttu-id="3660c-994">Koncepcyjnie, routing punktu końcowego nie zakłada, że punkt końcowy istnieje, jeśli akcja nie istnieje.</span><span class="sxs-lookup"><span data-stu-id="3660c-994">Conceptually, endpoint routing doesn't assume that the endpoint exists if the action doesn't exist.</span></span>

* <span data-ttu-id="3660c-995">*Algorytm unieważniania wartości otoczenia* generacji linku działa inaczej, gdy jest używany z routingiem punktów końcowych.</span><span class="sxs-lookup"><span data-stu-id="3660c-995">The link generation *ambient value invalidation algorithm* behaves differently when used with endpoint routing.</span></span>

  <span data-ttu-id="3660c-996">*Nieprawidłowa wartość otoczenia* , która decyduje o tym, które wartości trasy z aktualnie wykonywanego żądania (wartości otoczenia) mogą być używane w operacjach generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-996">*Ambient value invalidation* is the algorithm that decides which route values from the currently executing request (the ambient values) can be used in link generation operations.</span></span> <span data-ttu-id="3660c-997">Routowanie konwencjonalne zawsze unieważnia dodatkowe wartości trasy podczas łączenia z inną akcją.</span><span class="sxs-lookup"><span data-stu-id="3660c-997">Conventional routing always invalidated extra route values when linking to a different action.</span></span> <span data-ttu-id="3660c-998">Routing atrybutów nie miał tego zachowania przed wydaniem ASP.NET Core 2,2.</span><span class="sxs-lookup"><span data-stu-id="3660c-998">Attribute routing didn't have this behavior prior to the release of ASP.NET Core 2.2.</span></span> <span data-ttu-id="3660c-999">We wcześniejszych wersjach ASP.NET Core linki do innej akcji, która używa tych samych nazw parametrów trasy, spowodowały błędy generacji łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-999">In earlier versions of ASP.NET Core, links to another action that use the same route parameter names resulted in link generation errors.</span></span> <span data-ttu-id="3660c-1000">W ASP.NET Core 2,2 lub nowszej, obie formy routingu unieważnią wartości podczas łączenia z inną akcją.</span><span class="sxs-lookup"><span data-stu-id="3660c-1000">In ASP.NET Core 2.2 or later, both forms of routing invalidate values when linking to another action.</span></span>

  <span data-ttu-id="3660c-1001">Rozważmy następujący przykład w ASP.NET Core 2,1 lub starszej.</span><span class="sxs-lookup"><span data-stu-id="3660c-1001">Consider the following example in ASP.NET Core 2.1 or earlier.</span></span> <span data-ttu-id="3660c-1002">W przypadku łączenia z inną akcją (lub inną stroną) wartości trasy mogą być ponownie używane na różne sposoby.</span><span class="sxs-lookup"><span data-stu-id="3660c-1002">When linking to another action (or another page), route values can be reused in undesirable ways.</span></span>

  <span data-ttu-id="3660c-1003">W */Pages/Store/Product.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="3660c-1003">In */Pages/Store/Product.cshtml*:</span></span>

  ```cshtml
  @page "{id}"
  @Url.Page("/Login")
  ```

  <span data-ttu-id="3660c-1004">W */Pages/login.cshtml*:</span><span class="sxs-lookup"><span data-stu-id="3660c-1004">In */Pages/Login.cshtml*:</span></span>

  ```cshtml
  @page "{id?}"
  ```

  <span data-ttu-id="3660c-1005">Jeśli identyfikator URI znajduje się `/Store/Product/18` w ASP.NET Core 2,1 lub starszej, link wygenerowany na stronie Sklep/informacje w usłudze `@Url.Page("/Login")` ma wartość `/Login/18` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1005">If the URI is `/Store/Product/18` in ASP.NET Core 2.1 or earlier, the link generated on the Store/Info page by `@Url.Page("/Login")` is `/Login/18`.</span></span> <span data-ttu-id="3660c-1006">`id`Wartość 18 jest ponownie używana, mimo że miejsce docelowe linku jest częścią aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1006">The `id` value of 18 is reused, even though the link destination is different part of the app entirely.</span></span> <span data-ttu-id="3660c-1007">`id`Wartość trasy w kontekście `/Login` strony jest prawdopodobnie wartością identyfikatora użytkownika, a nie wartością identyfikatora produktu w sklepie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1007">The `id` route value in the context of the `/Login` page is probably a user ID value, not a store product ID value.</span></span>

  <span data-ttu-id="3660c-1008">W przypadku routingu punktów końcowych z ASP.NET Core 2,2 lub nowszym wynik jest `/Login` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1008">In endpoint routing with ASP.NET Core 2.2 or later, the result is `/Login`.</span></span> <span data-ttu-id="3660c-1009">Wartości otoczenia nie są ponownie używane, gdy połączone miejsce docelowe jest inną akcją lub stroną.</span><span class="sxs-lookup"><span data-stu-id="3660c-1009">Ambient values aren't reused when the linked destination is a different action or page.</span></span>

* <span data-ttu-id="3660c-1010">Składnia parametru trasy okrężnej: ukośniki nie są kodowane przy użyciu podwójnej gwiazdki ( `**` ) składni parametrów.</span><span class="sxs-lookup"><span data-stu-id="3660c-1010">Round-tripping route parameter syntax: Forward slashes aren't encoded when using a double-asterisk (`**`) catch-all parameter syntax.</span></span>

  <span data-ttu-id="3660c-1011">Podczas generowania łącza system routingu koduje wartość przechwyconą w dwugwiazdkowym ( `**` ) parametrem catch-all (na przykład), `{**myparametername}` z wyjątkiem ukośników.</span><span class="sxs-lookup"><span data-stu-id="3660c-1011">During link generation, the routing system encodes the value captured in a double-asterisk (`**`) catch-all parameter (for example, `{**myparametername}`) except the forward slashes.</span></span> <span data-ttu-id="3660c-1012">Podwójna gwiazdka catch-all jest obsługiwana w przypadku `IRouter` routingu opartego na systemie ASP.NET Core 2,2 lub nowszym.</span><span class="sxs-lookup"><span data-stu-id="3660c-1012">The double-asterisk catch-all is supported with `IRouter`-based routing in ASP.NET Core 2.2 or later.</span></span>

  <span data-ttu-id="3660c-1013">Pojedyncza gwiazdka "catch-all" w poprzednich wersjach ASP.NET Core ( `{*myparametername}` ) pozostanie obsługiwana, a ukośniki są zakodowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1013">The single asterisk catch-all parameter syntax in prior versions of ASP.NET Core (`{*myparametername}`) remains supported, and forward slashes are encoded.</span></span>

  | <span data-ttu-id="3660c-1014">Trasa</span><span class="sxs-lookup"><span data-stu-id="3660c-1014">Route</span></span>              | <span data-ttu-id="3660c-1015">Wygenerowano łącze</span><span class="sxs-lookup"><span data-stu-id="3660c-1015">Link generated with</span></span><br>`Url.Action(new { category = "admin/products" })`&hellip; |
  | ------------------ | --------------------------------------------------------------------- |
  | `/search/{*page}`  | <span data-ttu-id="3660c-1016">`/search/admin%2Fproducts` (ukośnik zostanie zakodowany)</span><span class="sxs-lookup"><span data-stu-id="3660c-1016">`/search/admin%2Fproducts` (the forward slash is encoded)</span></span>             |
  | `/search/{**page}` | `/search/admin/products`                                              |

### <a name="middleware-example"></a><span data-ttu-id="3660c-1017">Przykład oprogramowania pośredniczącego</span><span class="sxs-lookup"><span data-stu-id="3660c-1017">Middleware example</span></span>

<span data-ttu-id="3660c-1018">W poniższym przykładzie oprogramowanie pośredniczące używa <xref:Microsoft.AspNetCore.Routing.LinkGenerator> interfejsu API do tworzenia linku do metody akcji, która wyświetla listę produktów ze sklepu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1018">In the following example, a middleware uses the <xref:Microsoft.AspNetCore.Routing.LinkGenerator> API to create link to an action method that lists store products.</span></span> <span data-ttu-id="3660c-1019">Przy użyciu generatora linków poprzez wstrzyknięcie go do klasy i wywołanie `GenerateLink` jest dostępne dla dowolnej klasy w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1019">Using the link generator by injecting it into a class and calling `GenerateLink` is available to any class in an app.</span></span>

```csharp
using Microsoft.AspNetCore.Routing;

public class ProductsLinkMiddleware
{
    private readonly LinkGenerator _linkGenerator;

    public ProductsLinkMiddleware(RequestDelegate next, LinkGenerator linkGenerator)
    {
        _linkGenerator = linkGenerator;
    }

    public async Task InvokeAsync(HttpContext httpContext)
    {
        var url = _linkGenerator.GetPathByAction("ListProducts", "Store");

        httpContext.Response.ContentType = "text/plain";

        await httpContext.Response.WriteAsync($"Go to {url} to see our products.");
    }
}
```

### <a name="create-routes"></a><span data-ttu-id="3660c-1020">Tworzenie tras</span><span class="sxs-lookup"><span data-stu-id="3660c-1020">Create routes</span></span>

<span data-ttu-id="3660c-1021">Większość aplikacji tworzy trasy przez wywołanie <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> lub jedną z podobnych metod rozszerzających zdefiniowanych w systemie <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1021">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="3660c-1022">Dowolna z <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> metod rozszerzających tworzy wystąpienie <xref:Microsoft.AspNetCore.Routing.Route> i dodaje je do kolekcji tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1022">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="3660c-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nie akceptuje parametru procedury obsługi trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1023"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="3660c-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> dodaje tylko trasy, które są obsługiwane przez <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1024"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="3660c-1025">Aby dowiedzieć się więcej na temat routingu w MVC, zobacz <xref:mvc/controllers/routing> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1025">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="3660c-1026">Poniższy przykład kodu jest przykładem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wywołania używanego przez typową definicję trasy MVC ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3660c-1026">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="3660c-1027">Ten szablon dopasowuje ścieżkę URL i wyodrębnia wartości tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1027">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="3660c-1028">Na przykład ścieżka `/Products/Details/17` generuje następujące wartości trasy: `{ controller = Products, action = Details, id = 17 }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1028">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="3660c-1029">Wartości tras są określane przez podzielenie ścieżki URL na segmenty i dopasowanie do każdego segmentu przy użyciu nazwy *parametru trasy* w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1029">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="3660c-1030">Parametry trasy są nazywane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1030">Route parameters are named.</span></span> <span data-ttu-id="3660c-1031">Parametry zdefiniowane przez ujęcie nazwy parametru w nawiasach klamrowych `{ ... }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1031">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="3660c-1032">Poprzedni szablon może również pasować do ścieżki URL `/` i generować wartości `{ controller = Home, action = Index }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1032">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="3660c-1033">Dzieje się tak, `{controller}` ponieważ `{action}` Parametry i trasy mają wartości domyślne, a `id` parametr trasy jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1033">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="3660c-1034">Znak równości ( `=` ), po którym następuje wartość po nazwie parametru trasy definiuje wartość domyślną dla parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1034">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="3660c-1035">Znak zapytania ( `?` ) po nazwie parametru trasy definiuje opcjonalny parametr.</span><span class="sxs-lookup"><span data-stu-id="3660c-1035">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="3660c-1036">Parametry trasy z wartością domyślną *zawsze* generują wartość trasy w przypadku dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1036">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="3660c-1037">Parametry opcjonalne nie generują wartości trasy, jeśli nie ma odpowiedniego segmentu ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1037">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="3660c-1038">Szczegółowe opisy scenariuszy i składni szablonów tras można znaleźć w sekcji [Dokumentacja dotycząca szablonu trasy](#route-template-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1038">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="3660c-1039">W poniższym przykładzie definicja parametru trasy `{id:int}` definiuje [ograniczenie trasy](#route-constraint-reference) dla `id` parametru trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1039">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="3660c-1040">Ten szablon dopasowuje ścieżkę URL, taką jak, `/Products/Details/17` ale nie `/Products/Details/Apples` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1040">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="3660c-1041">Ograniczenia trasy implementują <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> i sprawdzają wartości routingu w celu ich zweryfikowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1041">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="3660c-1042">W tym przykładzie wartość trasy `id` musi być możliwa do przekonwertowania na liczbę całkowitą.</span><span class="sxs-lookup"><span data-stu-id="3660c-1042">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="3660c-1043">Aby uzyskać wyjaśnienie ograniczeń trasy dostarczonych przez platformę, zobacz temat [ograniczenia trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1043">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="3660c-1044">Dodatkowe przeciążenia <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wartości akceptują dla `constraints` , `dataTokens` i `defaults` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1044">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="3660c-1045">Typowym użyciem tych parametrów jest przekazanie anonimowo wpisanego obiektu, gdzie nazwy właściwości typu anonimowego są zgodne z nazwami parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1045">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="3660c-1046">Poniższe <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykłady tworzą równoważne trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1046">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="3660c-1047">Wbudowana Składnia służąca do definiowania ograniczeń i wartości domyślnych może być wygodna dla prostych tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1047">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="3660c-1048">Istnieją jednak scenariusze, takie jak tokeny danych, które nie są obsługiwane przez składnię wbudowaną.</span><span class="sxs-lookup"><span data-stu-id="3660c-1048">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="3660c-1049">Poniższy przykład ilustruje kilka dodatkowych scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1049">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{**article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="3660c-1050">Poprzedni szablon pasuje do ścieżki URL, tak jak `/Blog/All-About-Routing/Introduction` i wyodrębnia wartości `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1050">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="3660c-1051">Domyślne wartości trasy dla `controller` i `action` są generowane przez trasę, nawet jeśli w szablonie nie ma odpowiednich parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1051">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="3660c-1052">Wartości domyślne można określić w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1052">Default values can be specified in the route template.</span></span> <span data-ttu-id="3660c-1053">`article`Parametr Route jest zdefiniowany jako *przechwycenie* przez wygląd podwójnej gwiazdki ( `**` ) przed nazwą parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1053">The `article` route parameter is defined as a *catch-all* by the appearance of an double asterisk (`**`) before the route parameter name.</span></span> <span data-ttu-id="3660c-1054">Catch-wszystkie parametry tras przechwytują resztę ścieżki URL i mogą również pasować do pustego ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1054">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="3660c-1055">Poniższy przykład dodaje ograniczenia trasy i tokeny danych:</span><span class="sxs-lookup"><span data-stu-id="3660c-1055">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="3660c-1056">Poprzedni szablon pasuje do ścieżki URL, na przykład `/en-US/Products/5` i wyodrębnia wartości `{ controller = Products, action = Details, id = 5 }` i tokeny danych `{ locale = en-US }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1056">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Lokalne tokeny systemu Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="3660c-1058">Generowanie adresu URL klasy trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1058">Route class URL generation</span></span>

<span data-ttu-id="3660c-1059"><xref:Microsoft.AspNetCore.Routing.Route>Klasa może również wykonywać generowanie adresów URL przez połączenie zestawu wartości tras z jego szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1059">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="3660c-1060">Jest to logicznie proces odwrotny pasujący do ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1060">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="3660c-1061">Aby lepiej zrozumieć generowanie adresów URL, Załóżmy, jaki adres URL ma zostać wygenerowany, a następnie pomyśl o sposobie dopasowania szablonu trasy do tego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1061">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="3660c-1062">Jakie wartości zostałyby wygenerowane?</span><span class="sxs-lookup"><span data-stu-id="3660c-1062">What values would be produced?</span></span> <span data-ttu-id="3660c-1063">Jest to sztywny odpowiednik działania generowania adresów URL w <xref:Microsoft.AspNetCore.Routing.Route> klasie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1063">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="3660c-1064">Poniższy przykład używa ogólnej trasy domyślnej ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="3660c-1064">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="3660c-1065">W przypadku wartości trasy `{ controller = Products, action = List }` `/Products/List` zostanie wygenerowany adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1065">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="3660c-1066">Wartości trasy są zastępowane odpowiednimi parametrami trasy w celu utworzenia ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1066">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="3660c-1067">Ponieważ `id` jest to opcjonalny parametr trasy, adres URL został pomyślnie wygenerowany bez wartości dla `id` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1067">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="3660c-1068">W przypadku wartości trasy `{ controller = Home, action = Index }` `/` zostanie wygenerowany adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1068">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="3660c-1069">Podane wartości trasy są zgodne z wartościami domyślnymi, a segmenty odpowiadające wartościom domyślnym są bezpiecznie pomijane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1069">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="3660c-1070">Oba adresy URL wygenerowały rundę z następującą definicją trasy ( `/Home/Index` i `/` ) tworzą te same wartości trasy, które zostały użyte do WYGENEROWANIA adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1070">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="3660c-1071">Aplikacja używająca ASP.NET Core MVC powinna używać <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> do generowania adresów URL zamiast bezpośredniego wywoływania routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1071">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="3660c-1072">Aby uzyskać więcej informacji na temat generowania adresów URL, zobacz sekcję [informacje dotyczące generowania adresów URL](#url-generation-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1072">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="3660c-1073">Korzystanie z oprogramowania pośredniczącego routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-1073">Use Routing Middleware</span></span>

<span data-ttu-id="3660c-1074">Odwołuje się do [pakietu Microsoft. AspNetCore. app](xref:fundamentals/metapackage-app) w pliku projektu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1074">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="3660c-1075">Dodaj Routing do kontenera usługi w `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-1075">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="3660c-1076">Trasy muszą być skonfigurowane w `Startup.Configure` metodzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1076">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="3660c-1077">Przykładowa aplikacja używa następujących interfejsów API:</span><span class="sxs-lookup"><span data-stu-id="3660c-1077">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="3660c-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Dopasowuje tylko żądania HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="3660c-1078"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="3660c-1079">W poniższej tabeli przedstawiono odpowiedzi z podanym identyfikatorem URI.</span><span class="sxs-lookup"><span data-stu-id="3660c-1079">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="3660c-1080">URI</span><span class="sxs-lookup"><span data-stu-id="3660c-1080">URI</span></span>                    | <span data-ttu-id="3660c-1081">Reakcja</span><span class="sxs-lookup"><span data-stu-id="3660c-1081">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="3660c-1082">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1082">Hello!</span></span> <span data-ttu-id="3660c-1083">Wartości trasy: [Operation, Create], [ID, 3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1083">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="3660c-1084">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1084">Hello!</span></span> <span data-ttu-id="3660c-1085">Wartości trasy: [Operation, Track], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1085">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="3660c-1086">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1086">Hello!</span></span> <span data-ttu-id="3660c-1087">Wartości trasy: [Operation, Track], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1087">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="3660c-1088">Żądanie przepada w, brak dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1088">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="3660c-1089">Witaj, Jan!</span><span class="sxs-lookup"><span data-stu-id="3660c-1089">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="3660c-1090">Żądanie przepada w, dopasowuje tylko HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="3660c-1090">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="3660c-1091">Żądanie przepada w, brak dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1091">The request falls through, no match.</span></span>              |

<span data-ttu-id="3660c-1092">Struktura zawiera zestaw metod rozszerzających do tworzenia tras ( <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions> ):</span><span class="sxs-lookup"><span data-stu-id="3660c-1092">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="3660c-1093">`Map[Verb]`Metody służą do ograniczania trasy do zlecenia HTTP w nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="3660c-1093">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="3660c-1094">Na przykład zobacz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> i <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="3660c-1094">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="3660c-1095">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1095">Route template reference</span></span>

<span data-ttu-id="3660c-1096">Tokeny w nawiasach klamrowych ( `{ ... }` ) definiują *Parametry trasy* , które są powiązane w przypadku dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1096">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="3660c-1097">Można zdefiniować więcej niż jeden parametr trasy w segmencie trasy, ale muszą one być oddzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="3660c-1097">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="3660c-1098">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie ma wartości literału między `{controller}` i `{action}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1098">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="3660c-1099">Te parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="3660c-1099">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="3660c-1100">Tekst literału inny niż parametry trasy (na przykład `{id}` ) i separator ścieżki `/` muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1100">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="3660c-1101">W dopasowaniu do tekstu nie jest rozróżniana wielkość liter i w oparciu o zdekodowaną reprezentację ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1101">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="3660c-1102">Aby dopasować Ogranicznik parametru trasy literału ( `{` lub `}` ), należy wprowadzić ogranicznik przez powtórzenie znaku ( `{{` lub `}}` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1102">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="3660c-1103">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="3660c-1103">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="3660c-1104">Rozważmy na przykład szablon `files/{filename}.{ext?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1104">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="3660c-1105">Gdy wartości obu `filename` i `ext` istnieją, są wypełniane obie wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-1105">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="3660c-1106">Jeśli `filename` w adresie URL znajduje się tylko wartość parametru, trasa pasuje do, ponieważ końcowy okres ( `.` ) jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1106">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="3660c-1107">Następujące adresy URL pasują do tej trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1107">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="3660c-1108">Możesz użyć gwiazdki ( `*` ) lub podwójnej gwiazdki ( `**` ) jako prefiksu do parametru trasy, aby powiązać z pozostałą częścią identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="3660c-1108">You can use an asterisk (`*`) or double asterisk (`**`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="3660c-1109">Są one nazywane parametrami *przechwycenia* .</span><span class="sxs-lookup"><span data-stu-id="3660c-1109">These are called a *catch-all* parameters.</span></span> <span data-ttu-id="3660c-1110">Na przykład `blog/{**slug}` dopasowuje dowolny identyfikator URI, który rozpoczyna się od `/blog` i ma dowolną wartość, która jest przypisana do `slug` wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1110">For example, `blog/{**slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="3660c-1111">Catch-wszystkie parametry można także dopasować do pustego ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1111">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="3660c-1112">Parametr catch-all wyprowadza odpowiednie znaki, gdy trasa jest używana do generowania adresu URL, włącznie z separatorami ścieżki ( `/` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1112">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="3660c-1113">Na przykład trasa `foo/{*path}` z wartościami trasy jest `{ path = "my/path" }` generowana `foo/my%2Fpath` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1113">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="3660c-1114">Zwróć uwagę na odwrócony ukośnik.</span><span class="sxs-lookup"><span data-stu-id="3660c-1114">Note the escaped forward slash.</span></span> <span data-ttu-id="3660c-1115">Aby zaokrąglić znaki separatora ścieżki, użyj `**` prefiksu parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1115">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="3660c-1116">Trasa `foo/{**path}` z `{ path = "my/path" }` generowaniem `foo/my/path` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1116">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

<span data-ttu-id="3660c-1117">Parametry trasy mogą mieć *wartości domyślne* , określając wartość domyślną po nazwie parametru oddzielone znakiem równości ( `=` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1117">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="3660c-1118">Na przykład `{controller=Home}` definiuje `Home` jako wartość domyślną dla `controller` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1118">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="3660c-1119">Wartość domyślna jest używana, jeśli żadna wartość nie jest obecna w adresie URL dla parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1119">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="3660c-1120">Parametry trasy są opcjonalne przez dołączenie znaku zapytania ( `?` ) na końcu nazwy parametru, jak w `id?` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1120">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="3660c-1121">Różnica między wartościami opcjonalnymi i domyślnymi parametrami trasy polega na tym, że parametr trasy z wartością domyślną zawsze tworzy wartość, &mdash; a opcjonalny parametr ma wartość tylko wtedy, gdy wartość jest dostarczana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1121">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="3660c-1122">Parametry trasy mogą mieć ograniczenia, które muszą być zgodne z wartością trasy powiązaną z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1122">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="3660c-1123">Dodanie dwukropka ( `:` ) i nazwy ograniczenia po nazwie parametru trasy określa *ograniczenie wbudowane* dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1123">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="3660c-1124">Jeśli ograniczenie wymaga argumentów, są one ujęte w nawiasy ( `(...)` ) po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1124">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="3660c-1125">Można określić wiele ograniczeń wbudowanych, dołączając inną dwukropek ( `:` ) i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1125">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="3660c-1126">Nazwa i argumenty ograniczenia są przekazane do usługi w <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> celu utworzenia wystąpienia <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> do użycia w przetwarzaniu adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1126">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="3660c-1127">Na przykład szablon trasy `blog/{article:minlength(10)}` określa `minlength` ograniczenie z argumentem `10` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1127">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="3660c-1128">Aby uzyskać więcej informacji na temat ograniczeń trasy i listę ograniczeń zapewnianych przez platformę, zobacz sekcję [odwołanie do ograniczenia trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1128">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="3660c-1129">Parametry trasy mogą także mieć Transformatory parametrów, które przekształcają wartość parametru podczas generowania linków i dopasowywania stron do adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1129">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URLs.</span></span> <span data-ttu-id="3660c-1130">Podobnie jak ograniczenia, transformatory parametrów mogą być dodawane wewnętrznie do parametru trasy przez dodanie dwukropka ( `:` ) i nazwy transformatora po nazwie parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1130">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="3660c-1131">Na przykład szablon trasy `blog/{article:slugify}` określa `slugify` transformator.</span><span class="sxs-lookup"><span data-stu-id="3660c-1131">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span> <span data-ttu-id="3660c-1132">Aby uzyskać więcej informacji na temat transformatorów parametrów, zobacz sekcję [informacje dotyczące transformatora parametrów](#parameter-transformer-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1132">For more information on parameter transformers, see the [Parameter transformer reference](#parameter-transformer-reference) section.</span></span>

<span data-ttu-id="3660c-1133">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1133">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="3660c-1134">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1134">Route Template</span></span>                           | <span data-ttu-id="3660c-1135">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="3660c-1135">Example Matching URI</span></span>    | <span data-ttu-id="3660c-1136">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="3660c-1136">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="3660c-1137">Dopasowuje tylko jedną ścieżkę `/hello` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1137">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="3660c-1138">Dopasowuje i ustawia `Page` jako `Home` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1138">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="3660c-1139">Dopasowuje i ustawia `Page` jako `Contact` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1139">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="3660c-1140">Mapuje do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1140">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="3660c-1141">Mapuje do `Products` kontrolera i  `Details` akcji ( `id` ustawienie na 123).</span><span class="sxs-lookup"><span data-stu-id="3660c-1141">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="3660c-1142">Mapuje na `Home` kontroler i `Index` metodę ( `id` jest ignorowana).</span><span class="sxs-lookup"><span data-stu-id="3660c-1142">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="3660c-1143">Użycie szablonu jest ogólnie najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1143">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="3660c-1144">Ograniczenia i wartości domyślne można także określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1144">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="3660c-1145">Włącz [Rejestrowanie](xref:fundamentals/logging/index) , aby zobaczyć, jak wbudowane implementacje routingu, takie jak <xref:Microsoft.AspNetCore.Routing.Route> , dopasowują żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1145">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="3660c-1146">Zastrzeżone nazwy routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-1146">Reserved routing names</span></span>

<span data-ttu-id="3660c-1147">Następujące słowa kluczowe są nazwami zarezerwowanymi i nie mogą być używane jako nazwy tras lub parametry:</span><span class="sxs-lookup"><span data-stu-id="3660c-1147">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="3660c-1148">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1148">Route constraint reference</span></span>

<span data-ttu-id="3660c-1149">Ograniczenia trasy są wykonywane, gdy nastąpiło dopasowanie do przychodzącego adresu URL, a Ścieżka adresu URL jest zgodna z wartościami trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1149">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="3660c-1150">Ograniczenia trasy zwykle sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują decyzję o tym, czy wartość jest akceptowalna.</span><span class="sxs-lookup"><span data-stu-id="3660c-1150">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="3660c-1151">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby uwzględnić, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1151">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="3660c-1152">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> może akceptować lub odrzucać żądanie na podstawie jego zlecenia http.</span><span class="sxs-lookup"><span data-stu-id="3660c-1152">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="3660c-1153">Ograniczenia są używane w żądaniach routingu i generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1153">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="3660c-1154">Nie używaj ograniczeń **sprawdzania poprawności danych wejściowych**.</span><span class="sxs-lookup"><span data-stu-id="3660c-1154">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="3660c-1155">Jeśli ograniczenia są używane do **sprawdzania poprawności danych wejściowych**, nieprawidłowe dane wejściowe w odpowiedzi *404 — nie znaleziono* , zamiast *żądania 400-złe* z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1155">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="3660c-1156">Ograniczenia trasy są **używane do** odróżniania podobnych tras, a nie do sprawdzania danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1156">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="3660c-1157">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1157">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="3660c-1158">Typu</span><span class="sxs-lookup"><span data-stu-id="3660c-1158">Constraint</span></span> | <span data-ttu-id="3660c-1159">Przykład</span><span class="sxs-lookup"><span data-stu-id="3660c-1159">Example</span></span> | <span data-ttu-id="3660c-1160">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-1160">Example matches</span></span> | <span data-ttu-id="3660c-1161">Uwagi</span><span class="sxs-lookup"><span data-stu-id="3660c-1161">Notes</span></span> |
|------------|---------|-----------------|-------|
| `int` | `{id:int}` | <span data-ttu-id="3660c-1162">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-1162">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-1163">Dopasowuje dowolną liczbę całkowitą.</span><span class="sxs-lookup"><span data-stu-id="3660c-1163">Matches any integer.</span></span>|
| `bool` | `{active:bool}` | <span data-ttu-id="3660c-1164">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="3660c-1164">`true`, `FALSE`</span></span> | <span data-ttu-id="3660c-1165">Dopasowuje `true` lub `false` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1165">Matches `true` or `false`.</span></span> <span data-ttu-id="3660c-1166">Bez uwzględniania wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="3660c-1166">Case-insensitive.</span></span>|
| `datetime` | `{dob:datetime}` | <span data-ttu-id="3660c-1167">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="3660c-1167">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="3660c-1168">Dopasowuje prawidłową `DateTime` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1168">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1169">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1169">See preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="3660c-1170">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="3660c-1170">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="3660c-1171">Dopasowuje prawidłową `decimal` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1171">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1172">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1172">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="3660c-1173">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-1173">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-1174">Dopasowuje prawidłową `double` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1174">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1175">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1175">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="3660c-1176">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-1176">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-1177">Dopasowuje prawidłową `float` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1177">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1178">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1178">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="3660c-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="3660c-1179">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="3660c-1180">Pasuje do prawidłowej `Guid` wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-1180">Matches a valid `Guid` value.</span></span>|
| `long` | `{ticks:long}` | <span data-ttu-id="3660c-1181">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-1181">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-1182">Pasuje do prawidłowej `long` wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-1182">Matches a valid `long` value.</span></span>|
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="3660c-1183">Ciąg musi składać się z co najmniej 4 znaków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1183">String must be at least 4 characters.</span></span>|
| `maxlength(value)` | `{filename:maxlength(8)}` | `MyFile` | <span data-ttu-id="3660c-1184">Ciąg ma maksymalnie 8 znaków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1184">String has maximum of 8 characters.</span></span>|
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="3660c-1185">Ciąg musi zawierać dokładnie 12 znaków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1185">String must be exactly 12 characters long.</span></span>|
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="3660c-1186">Ciąg musi zawierać co najmniej 8 znaków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1186">String must be at least 8 and has maximum of 16 characters.</span></span>|
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="3660c-1187">Wartość całkowita musi być równa co najmniej 18.</span><span class="sxs-lookup"><span data-stu-id="3660c-1187">Integer value must be at least 18.</span></span>|
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="3660c-1188">Wartość całkowita z maksymalną 120.</span><span class="sxs-lookup"><span data-stu-id="3660c-1188">Integer value maximum of 120.</span></span>|
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="3660c-1189">Wartość całkowita musi być równa co najmniej 18 i maksymalnie 120.</span><span class="sxs-lookup"><span data-stu-id="3660c-1189">Integer value must be at least 18 and maximum of 120.</span></span>|
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="3660c-1190">Ciąg musi składać się z co najmniej jednego znaku alfabetycznego `a` - `z` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1190">String must consist of one or more alphabetical characters `a`-`z`.</span></span> <span data-ttu-id="3660c-1191">Bez uwzględniania wielkości liter.</span><span class="sxs-lookup"><span data-stu-id="3660c-1191">Case-insensitive.</span></span>|
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="3660c-1192">Ciąg musi być zgodny z wyrażeniem regularnym.</span><span class="sxs-lookup"><span data-stu-id="3660c-1192">String must match the regular expression.</span></span> <span data-ttu-id="3660c-1193">Zapoznaj się z poradami dotyczącymi definiowania wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1193">See tips about defining a regular expression.</span></span>|
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="3660c-1194">Służy do wymuszania, że podczas generowania adresu URL jest obecna wartość, która nie jest wartością parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1194">Used to enforce that a non-parameter value is present during URL generation.</span></span>|

<span data-ttu-id="3660c-1195">Wielokrotne ograniczenia rozdzielane średnikami można zastosować do jednego parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1195">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="3660c-1196">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub wyższej:</span><span class="sxs-lookup"><span data-stu-id="3660c-1196">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="3660c-1197">Ograniczenia trasy, które weryfikują adres URL i są konwertowane na typ CLR (takie jak `int` lub `DateTime` ), zawsze używają niezmiennej kultury.</span><span class="sxs-lookup"><span data-stu-id="3660c-1197">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="3660c-1198">W tych ograniczeniach przyjęto założenie, że adres URL nie jest Lokalizowalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1198">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="3660c-1199">Ograniczenia trasy dostarczone przez platformę nie modyfikują wartości przechowywanych w wartościach trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1199">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="3660c-1200">Wszystkie wartości tras analizowane na podstawie adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="3660c-1200">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="3660c-1201">Na przykład, `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy może być konwertowana na typ float.</span><span class="sxs-lookup"><span data-stu-id="3660c-1201">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="3660c-1202">Wyrażenia regularne</span><span class="sxs-lookup"><span data-stu-id="3660c-1202">Regular expressions</span></span>

<span data-ttu-id="3660c-1203">ASP.NET Core Framework dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1203">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="3660c-1204"><xref:System.Text.RegularExpressions.RegexOptions>Aby uzyskać opis tych elementów członkowskich, zobacz.</span><span class="sxs-lookup"><span data-stu-id="3660c-1204">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="3660c-1205">Wyrażenia regularne używają ograniczników i tokenów podobnie jak w przypadku routingu i języka C#.</span><span class="sxs-lookup"><span data-stu-id="3660c-1205">Regular expressions use delimiters and tokens similar to those used by routing and the C# language.</span></span> <span data-ttu-id="3660c-1206">Tokeny wyrażenia regularnego muszą być zmienione.</span><span class="sxs-lookup"><span data-stu-id="3660c-1206">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="3660c-1207">Aby użyć wyrażenia regularnego `^\d{3}-\d{2}-\d{4}$` w routingu:</span><span class="sxs-lookup"><span data-stu-id="3660c-1207">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing:</span></span>

* <span data-ttu-id="3660c-1208">Wyrażenie musi mieć pojedyncze ukośniki odwrotne `\` podane w ciągu jako podwójne ukośniki odwrotne `\\` w kodzie źródłowym.</span><span class="sxs-lookup"><span data-stu-id="3660c-1208">The expression must have the single backslash `\` characters provided in the string as double backslash `\\` characters in the source code.</span></span>
* <span data-ttu-id="3660c-1209">`\\`Aby można było użyć znaku ucieczki ciągu, musi nam istnieć wyrażenie regularne `\` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1209">The regular expression must us `\\` in order to escape the `\` string escape character.</span></span>
* <span data-ttu-id="3660c-1210">Wyrażenie regularne nie jest wymagane w `\\` przypadku używania [literałów ciągu Verbatim](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="3660c-1210">The regular expression doesn't require `\\` when using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span>

<span data-ttu-id="3660c-1211">Na znaki ogranicznika parametru routingu ucieczki,,,, `{` `}` `[` `]` podwójne znaki w wyrażeniu `{{` ,, `}` `[[` , `]]` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1211">To escape routing parameter delimiter characters `{`, `}`, `[`, `]`, double the characters in the expression `{{`, `}`, `[[`, `]]`.</span></span> <span data-ttu-id="3660c-1212">W poniższej tabeli przedstawiono wyrażenie regularne i wersja o zmienionym znaczeniu:</span><span class="sxs-lookup"><span data-stu-id="3660c-1212">The following table shows a regular expression and the escaped version:</span></span>

| <span data-ttu-id="3660c-1213">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="3660c-1213">Regular Expression</span></span>    | <span data-ttu-id="3660c-1214">Wyrażenie regularne o zmienionym znaczeniu</span><span class="sxs-lookup"><span data-stu-id="3660c-1214">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="3660c-1215">Wyrażenia regularne używane w routingu często zaczynają się od `^` znaku karetki i dopasowują pozycję początkową ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1215">Regular expressions used in routing often start with the caret `^` character and match starting position of the string.</span></span> <span data-ttu-id="3660c-1216">Wyrażenia często kończą się znakiem dolara `$` i pasują do końca ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1216">The expressions often end with the dollar sign `$` character and match end of the string.</span></span> <span data-ttu-id="3660c-1217">`^`Znaki i `$` zapewniają, że wyrażenie regularne dopasowuje całą wartość parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1217">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="3660c-1218">Bez `^` znaków i `$` wyrażenie regularne dopasowuje dowolny podciąg w ciągu, co jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1218">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="3660c-1219">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są one zgodne lub niezgodne.</span><span class="sxs-lookup"><span data-stu-id="3660c-1219">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="3660c-1220">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="3660c-1220">Expression</span></span>   | <span data-ttu-id="3660c-1221">Ciąg</span><span class="sxs-lookup"><span data-stu-id="3660c-1221">String</span></span>    | <span data-ttu-id="3660c-1222">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="3660c-1222">Match</span></span> | <span data-ttu-id="3660c-1223">Komentarz</span><span class="sxs-lookup"><span data-stu-id="3660c-1223">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1224">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-1224">hello</span></span>     | <span data-ttu-id="3660c-1225">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1225">Yes</span></span>   | <span data-ttu-id="3660c-1226">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-1226">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1227">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-1227">123abc456</span></span> | <span data-ttu-id="3660c-1228">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1228">Yes</span></span>   | <span data-ttu-id="3660c-1229">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-1229">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1230">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-1230">mz</span></span>        | <span data-ttu-id="3660c-1231">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1231">Yes</span></span>   | <span data-ttu-id="3660c-1232">Wyrażenie dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-1232">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1233">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-1233">MZ</span></span>        | <span data-ttu-id="3660c-1234">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1234">Yes</span></span>   | <span data-ttu-id="3660c-1235">Bez uwzględniania wielkości liter</span><span class="sxs-lookup"><span data-stu-id="3660c-1235">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-1236">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-1236">hello</span></span>     | <span data-ttu-id="3660c-1237">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-1237">No</span></span>    | <span data-ttu-id="3660c-1238">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-1238">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-1239">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-1239">123abc456</span></span> | <span data-ttu-id="3660c-1240">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-1240">No</span></span>    | <span data-ttu-id="3660c-1241">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-1241">See `^` and `$` above</span></span> |

<span data-ttu-id="3660c-1242">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework wyrażeń regularnych](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="3660c-1242">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="3660c-1243">Aby ograniczyć parametr do znanego zestawu możliwych wartości, użyj wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1243">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="3660c-1244">Na przykład `{action:regex(^(list|get|create)$)}` dopasowuje `action` wartość trasy do `list` , `get` , lub `create` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1244">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="3660c-1245">Jeśli przeszedł do słownika ograniczeń, ciąg `^(list|get|create)$` jest równoważny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1245">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="3660c-1246">Ograniczenia, które są przesyłane w słowniku ograniczenia (nie wbudowane w szablon), które nie pasują do jednego ze znanych ograniczeń, są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="3660c-1246">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="3660c-1247">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1247">Custom route constraints</span></span>

<span data-ttu-id="3660c-1248">Oprócz wbudowanych ograniczeń trasy niestandardowe ograniczenia trasy mogą być tworzone przez implementację <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1248">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="3660c-1249"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>Interfejs zawiera jedną metodę, `Match` która zwraca, `true` Jeśli ograniczenie jest spełnione i `false` w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1249">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="3660c-1250">Aby użyć niestandardowego <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> , typ ograniczenia trasy musi być zarejestrowany <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> w aplikacji w kontenerze usługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1250">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="3660c-1251"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>Jest słownikiem, który mapuje klucze ograniczeń trasy do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementacji, które weryfikują te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1251">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="3660c-1252">Aplikację <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> można zaktualizować w `Startup.ConfigureServices` ramach [usług. Wywołanie addrouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub przez skonfigurowanie <xref:Microsoft.AspNetCore.Routing.RouteOptions> bezpośrednio w usłudze `services.Configure<RouteOptions>` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1252">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="3660c-1253">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3660c-1253">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="3660c-1254">Ograniczenie można następnie zastosować do tras w zwykły sposób, przy użyciu nazwy określonej podczas rejestrowania typu ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1254">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="3660c-1255">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3660c-1255">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="parameter-transformer-reference"></a><span data-ttu-id="3660c-1256">Odwołanie do transformatora parametrów</span><span class="sxs-lookup"><span data-stu-id="3660c-1256">Parameter transformer reference</span></span>

<span data-ttu-id="3660c-1257">Transformatory parametrów:</span><span class="sxs-lookup"><span data-stu-id="3660c-1257">Parameter transformers:</span></span>

* <span data-ttu-id="3660c-1258">Wykonaj podczas generowania linku dla elementu <xref:Microsoft.AspNetCore.Routing.Route> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1258">Execute when generating a link for a <xref:Microsoft.AspNetCore.Routing.Route>.</span></span>
* <span data-ttu-id="3660c-1259">Implementacja `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1259">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="3660c-1260">Są konfigurowane przy użyciu <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1260">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="3660c-1261">Wypełnij wartość trasy parametru i Przekształć ją na nową wartość ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1261">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="3660c-1262">Wynikiem jest użycie przekształconej wartości w wygenerowanym łączu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1262">Result in using the transformed value in the generated link.</span></span>

<span data-ttu-id="3660c-1263">Na przykład niestandardowy `slugify` transformator parametrów w wzorcu trasy `blog\{article:slugify}` z `Url.Action(new { article = "MyTestArticle" })` generowaniem `blog\my-test-article` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1263">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="3660c-1264">Aby użyć transformatora parametrów w wzorcu trasy, skonfiguruj go najpierw za pomocą polecenia <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> w programie `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-1264">To use a parameter transformer in a route pattern, configure it first using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddRouting(options =>
{
    // Replace the type and the name used to refer to it with your own
    // IOutboundParameterTransformer implementation
    options.ConstraintMap["slugify"] = typeof(SlugifyParameterTransformer);
});
```

<span data-ttu-id="3660c-1265">Transformatory parametrów są używane przez platformę do przekształcania identyfikatora URI, w którym jest rozpoznawany punkt końcowy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1265">Parameter transformers are used by the framework to transform the URI where an endpoint resolves.</span></span> <span data-ttu-id="3660c-1266">Na przykład ASP.NET Core MVC używa transformatorów parametrów do przekształcenia wartości trasy używanej do dopasowania do `area` , `controller` , `action` , i `page` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1266">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller:slugify=Home}/{action:slugify=Index}/{id?}");
```

<span data-ttu-id="3660c-1267">W przypadku poprzedniej trasy Akcja `SubscriptionManagementController.GetAll` jest dopasowywana do identyfikatora URI `/subscription-management/get-all` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1267">With the preceding route, the action `SubscriptionManagementController.GetAll` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="3660c-1268">Transformator parametrów nie zmienia wartości trasy użytych do wygenerowania linku.</span><span class="sxs-lookup"><span data-stu-id="3660c-1268">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="3660c-1269">Na przykład dane `Url.Action("GetAll", "SubscriptionManagement")` wyjściowe `/subscription-management/get-all` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1269">For example, `Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="3660c-1270">ASP.NET Core udostępnia konwencje interfejsu API do używania transformatorów parametrów z wygenerowanymi trasami:</span><span class="sxs-lookup"><span data-stu-id="3660c-1270">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="3660c-1271">ASP.NET Core MVC ma `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` Konwencję interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="3660c-1271">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="3660c-1272">Ta Konwencja stosuje określony transformator parametrów do wszystkich tras atrybutów w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1272">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="3660c-1273">Transformator parametrów przekształca tokeny trasy atrybutów po ich wymianie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1273">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="3660c-1274">Aby uzyskać więcej informacji, zobacz [używanie transformatora parametrów do dostosowywania zastępowania tokenu](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="3660c-1274">For more information, see [Use a parameter transformer to customize token replacement](xref:mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="3660c-1275">Razor Strony mają `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` Konwencję interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="3660c-1275">Razor Pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="3660c-1276">Ta Konwencja stosuje określony transformator parametrów do wszystkich automatycznie odnalezionych Razor stron.</span><span class="sxs-lookup"><span data-stu-id="3660c-1276">This convention applies a specified parameter transformer to all automatically discovered Razor Pages.</span></span> <span data-ttu-id="3660c-1277">Transformator parametrów przekształca folder i segmenty nazw plików Razor tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1277">The parameter transformer transforms the folder and file name segments of Razor Pages routes.</span></span> <span data-ttu-id="3660c-1278">Aby uzyskać więcej informacji, zobacz [używanie transformatora parametrów do dostosowywania tras stron](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="3660c-1278">For more information, see [Use a parameter transformer to customize page routes](xref:razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

## <a name="url-generation-reference"></a><span data-ttu-id="3660c-1279">Odwołanie do generacji adresów URL</span><span class="sxs-lookup"><span data-stu-id="3660c-1279">URL generation reference</span></span>

<span data-ttu-id="3660c-1280">Poniższy przykład pokazuje, jak wygenerować link do trasy, używając słownika wartości tras i <xref:Microsoft.AspNetCore.Routing.RouteCollection> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1280">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="3660c-1281"><xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath>Wygenerowano na końcu powyższego przykładu `/package/create/123` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1281">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="3660c-1282">Słownik zawiera `operation` `id` wartości i trasy szablonu "śledzenie trasy pakietu" `package/{operation}/{id}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1282">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="3660c-1283">Aby uzyskać szczegółowe informacje, zapoznaj się z przykładowym kodem w sekcji [Używanie oprogramowania pośredniczącego usługi routingu](#use-routing-middleware) lub [przykładowej aplikacji](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="3660c-1283">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="3660c-1284">Drugi parametr <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> konstruktora jest kolekcją *wartości otoczenia*.</span><span class="sxs-lookup"><span data-stu-id="3660c-1284">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="3660c-1285">Wartości otoczenia są wygodne do użycia, ponieważ ograniczają liczbę wartości, które Deweloper musi określić w kontekście żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1285">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="3660c-1286">Bieżące wartości trasy bieżącego żądania są uznawane za wartości otoczenia dla generacji łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-1286">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="3660c-1287">W akcji aplikacji ASP.NET Core MVC `About` `HomeController` , nie trzeba określać wartości trasy kontrolera do łączenia z `Index` akcją, &mdash; w której `Home` jest używana wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1287">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="3660c-1288">Wartości otoczenia, które nie pasują do parametru, są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1288">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="3660c-1289">Wartości otoczenia są również ignorowane, gdy jawnie podana wartość przesłania wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1289">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="3660c-1290">Dopasowanie występuje od lewej do prawej w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1290">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="3660c-1291">Wartości jawnie podane, ale które nie pasują do segmentu trasy, są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1291">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="3660c-1292">W poniższej tabeli przedstawiono wynik przy użyciu szablonu trasy `{controller}/{action}/{id?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1292">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="3660c-1293">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="3660c-1293">Ambient Values</span></span>                     | <span data-ttu-id="3660c-1294">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="3660c-1294">Explicit Values</span></span>                        | <span data-ttu-id="3660c-1295">Wynik</span><span class="sxs-lookup"><span data-stu-id="3660c-1295">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="3660c-1296">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1296">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1297">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1297">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-1298">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1298">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1299">Controller = "Order", Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1299">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="3660c-1300">Controller = "Home", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-1300">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="3660c-1301">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1301">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-1302">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1302">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1303">Action = "informacje", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-1303">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="3660c-1304">Jeśli trasa ma wartość domyślną, która nie odpowiada parametrowi, a ta wartość jest jawnie określona, musi być zgodna z wartością domyślną:</span><span class="sxs-lookup"><span data-stu-id="3660c-1304">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="3660c-1305">Generowanie linku generuje tylko łącze do tej trasy, gdy zostaną podane pasujące wartości dla `controller` i `action` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1305">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="3660c-1306">Złożone segmenty</span><span class="sxs-lookup"><span data-stu-id="3660c-1306">Complex segments</span></span>

<span data-ttu-id="3660c-1307">Złożone segmenty (na przykład `[Route("/x{token}y")]` ) są przetwarzane przez dopasowanie literałów z prawej strony do lewej w sposób niezachłanney.</span><span class="sxs-lookup"><span data-stu-id="3660c-1307">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="3660c-1308">[Ten kod](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) zawiera szczegółowy opis sposobu dopasowywania segmentów złożonych.</span><span class="sxs-lookup"><span data-stu-id="3660c-1308">See [this code](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="3660c-1309">[Przykład kodu](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) nie jest używany przez ASP.NET Core, ale zapewnia dobre wyjaśnienie złożonych segmentów.</span><span class="sxs-lookup"><span data-stu-id="3660c-1309">The [code sample](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>
<!-- While that code is no longer used by ASP.NET Core for complex segment matching, it provides a good match to the current algorithm. The [current code](https://github.com/dotnet/AspNetCore/blob/91514c9af7e0f4c44029b51f05a01c6fe4c96e4c/src/Http/Routing/src/Matching/DfaMatcherBuilder.cs#L227-L244) is too abstracted from matching to be useful for understanding complex segment matching.
-->

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="3660c-1310">Routing jest odpowiedzialny za mapowanie identyfikatorów URI żądań w celu rozesłania procedur obsługi i wysyłania żądań przychodzących.</span><span class="sxs-lookup"><span data-stu-id="3660c-1310">Routing is responsible for mapping request URIs to route handlers and dispatching an incoming requests.</span></span> <span data-ttu-id="3660c-1311">Trasy są zdefiniowane w aplikacji i konfigurowane podczas uruchamiania aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1311">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="3660c-1312">Trasa może opcjonalnie wyodrębnić wartości z adresu URL zawartego w żądaniu. te wartości mogą być następnie używane do przetwarzania żądań.</span><span class="sxs-lookup"><span data-stu-id="3660c-1312">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="3660c-1313">Przy użyciu skonfigurowanych tras z aplikacji Routing jest w stanie generować adresy URL mapowane na procedury obsługi tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1313">Using configured routes from the app, routing is able to generate URLs that map to route handlers.</span></span>

<span data-ttu-id="3660c-1314">Aby użyć najnowszych scenariuszy routingu w ASP.NET Core 2,1, określ [wersję zgodności](xref:mvc/compatibility-version) do rejestracji usług MVC w `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-1314">To use the latest routing scenarios in ASP.NET Core 2.1, specify the [compatibility version](xref:mvc/compatibility-version) to the MVC services registration in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddMvc()
    .SetCompatibilityVersion(CompatibilityVersion.Version_2_1);
```

> [!IMPORTANT]
> <span data-ttu-id="3660c-1315">Ten dokument obejmuje Routing ASP.NET Core niskiego poziomu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1315">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="3660c-1316">Aby uzyskać informacje na temat ASP.NET Core routingu MVC, zobacz <xref:mvc/controllers/routing> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1316">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span> <span data-ttu-id="3660c-1317">Aby uzyskać informacje na temat Konwencji routingu na Razor stronach, zobacz <xref:razor-pages/razor-pages-conventions> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1317">For information on routing conventions in Razor Pages, see <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="3660c-1318">[Wyświetl lub pobierz przykładowy kod](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples) ([jak pobrać](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="3660c-1318">[View or download sample code](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="3660c-1319">Podstawy routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-1319">Routing basics</span></span>

<span data-ttu-id="3660c-1320">Większość aplikacji powinna wybrać podstawowy i opisowy schemat routingu, aby adresy URL były czytelne i zrozumiałe.</span><span class="sxs-lookup"><span data-stu-id="3660c-1320">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="3660c-1321">Domyślna trasa konwencjonalna `{controller=Home}/{action=Index}/{id?}` :</span><span class="sxs-lookup"><span data-stu-id="3660c-1321">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="3660c-1322">Obsługuje podstawowy i opisowy schemat routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1322">Supports a basic and descriptive routing scheme.</span></span>
* <span data-ttu-id="3660c-1323">Jest użytecznym punktem wyjścia dla aplikacji opartych na interfejsie użytkownika.</span><span class="sxs-lookup"><span data-stu-id="3660c-1323">Is a useful starting point for UI-based apps.</span></span>

<span data-ttu-id="3660c-1324">Deweloperzy często dodają dodatkowe trasy zwięzła do obszarów o dużym ruchu w aplikacji w wyspecjalizowanych sytuacjach (na przykład blog i punkty końcowe handlu elektronicznego) przy użyciu [routingu atrybutów](xref:mvc/controllers/routing#attribute-routing) lub dedykowanych tras konwencjonalnych.</span><span class="sxs-lookup"><span data-stu-id="3660c-1324">Developers commonly add additional terse routes to high-traffic areas of an app in specialized situations (for example, blog and ecommerce endpoints) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="3660c-1325">Interfejsy API sieci Web powinny używać routingu atrybutów do modelowania funkcjonalności aplikacji jako zestawu zasobów, w których operacje są reprezentowane przez zlecenia HTTP.</span><span class="sxs-lookup"><span data-stu-id="3660c-1325">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="3660c-1326">Oznacza to, że wiele operacji (na przykład GET, POST) dla tego samego zasobu logicznego będzie używać tego samego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1326">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="3660c-1327">Routing atrybutu zapewnia poziom kontroli, który jest wymagany do dokładnego projektowania układu publicznego punktu końcowego interfejsu API.</span><span class="sxs-lookup"><span data-stu-id="3660c-1327">Attribute routing provides a level of control that's needed to carefully design an API's public endpoint layout.</span></span>

<span data-ttu-id="3660c-1328">Razor Aplikacje stron używają domyślnego routingu konwencjonalnego do obsłużenia nazwanych zasobów w folderze *strony* aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1328">Razor Pages apps use default conventional routing to serve named resources in the *Pages* folder of an app.</span></span> <span data-ttu-id="3660c-1329">Dostępne są dodatkowe konwencje umożliwiające dostosowywanie Razor zachowania routingu stron.</span><span class="sxs-lookup"><span data-stu-id="3660c-1329">Additional conventions are available that allow you to customize Razor Pages routing behavior.</span></span> <span data-ttu-id="3660c-1330">Aby uzyskać więcej informacji, zobacz <xref:razor-pages/index> i <xref:razor-pages/razor-pages-conventions>.</span><span class="sxs-lookup"><span data-stu-id="3660c-1330">For more information, see <xref:razor-pages/index> and <xref:razor-pages/razor-pages-conventions>.</span></span>

<span data-ttu-id="3660c-1331">Obsługa generowania adresów URL umożliwia tworzenie aplikacji bez adresów URL, które mają być połączone ze sobą.</span><span class="sxs-lookup"><span data-stu-id="3660c-1331">URL generation support allows the app to be developed without hard-coding URLs to link the app together.</span></span> <span data-ttu-id="3660c-1332">Ta obsługa pozwala rozpocząć od podstawowej konfiguracji routingu i zmodyfikować trasy po ustaleniu układu zasobów aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1332">This support allows for starting with a basic routing configuration and modifying the routes after the app's resource layout is determined.</span></span>

<span data-ttu-id="3660c-1333">Routing używa implementacji tras programu <xref:Microsoft.AspNetCore.Routing.IRouter> do:</span><span class="sxs-lookup"><span data-stu-id="3660c-1333">Routing uses routes implementations of <xref:Microsoft.AspNetCore.Routing.IRouter> to:</span></span>

* <span data-ttu-id="3660c-1334">Mapuj przychodzące żądania do *obsługi tras*.</span><span class="sxs-lookup"><span data-stu-id="3660c-1334">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="3660c-1335">Generuj adresy URL używane w odpowiedziach.</span><span class="sxs-lookup"><span data-stu-id="3660c-1335">Generate the URLs used in responses.</span></span>

<span data-ttu-id="3660c-1336">Domyślnie aplikacja ma jedną kolekcję tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1336">By default, an app has a single collection of routes.</span></span> <span data-ttu-id="3660c-1337">Po nadejściu żądania trasy w kolekcji są przetwarzane w kolejności, w jakiej istnieją w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1337">When a request arrives, the routes in the collection are processed in the order that they exist in the collection.</span></span> <span data-ttu-id="3660c-1338">Platforma próbuje dopasować przychodzący adres URL żądania do trasy w kolekcji, wywołując <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> metodę dla każdej trasy w kolekcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1338">The framework attempts to match an incoming request URL to a route in the collection by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in the collection.</span></span> <span data-ttu-id="3660c-1339">Odpowiedź może używać routingu do generowania adresów URL (na przykład w przypadku przekierowania lub linków) na podstawie informacji o trasach i w ten sposób unikania zakodowanych adresów URL, co ułatwia łatwość utrzymania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1339">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>

<span data-ttu-id="3660c-1340">System routingu ma następujące cechy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1340">The routing system has the following characteristics:</span></span>

* <span data-ttu-id="3660c-1341">Składnia szablonu trasy służy do definiowania tras z parametrami trasy z tokenami.</span><span class="sxs-lookup"><span data-stu-id="3660c-1341">Route template syntax is used to define routes with tokenized route parameters.</span></span>
* <span data-ttu-id="3660c-1342">Dozwolona jest konfiguracja języka końcowego w stylu konwencjonalnym i stylu atrybutu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1342">Conventional-style and attribute-style endpoint configuration is permitted.</span></span>
* <span data-ttu-id="3660c-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> służy do określenia, czy parametr adresu URL zawiera prawidłową wartość dla danego ograniczenia punktu końcowego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1343"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint> is used to determine whether a URL parameter contains a valid value for a given endpoint constraint.</span></span>
* <span data-ttu-id="3660c-1344">Modele aplikacji, takie jak MVC/ Razor Pages, rejestrują wszystkie swoje trasy, które mają przewidywalne implementację scenariuszy routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1344">App models, such as MVC/Razor Pages, register all of their routes, which have a predictable implementation of routing scenarios.</span></span>
* <span data-ttu-id="3660c-1345">Odpowiedź może używać routingu do generowania adresów URL (na przykład w przypadku przekierowania lub linków) na podstawie informacji o trasach i w ten sposób unikania zakodowanych adresów URL, co ułatwia łatwość utrzymania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1345">A response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid hard-coded URLs, which helps maintainability.</span></span>
* <span data-ttu-id="3660c-1346">Generacja adresów URL jest oparta na trasach, które obsługują arbitralną rozszerzalność.</span><span class="sxs-lookup"><span data-stu-id="3660c-1346">URL generation is based on routes, which support arbitrary extensibility.</span></span> <span data-ttu-id="3660c-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> oferuje metody do kompilowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1347"><xref:Microsoft.AspNetCore.Mvc.IUrlHelper> offers methods to build URLs.</span></span>
<!-- fix [middleware](xref:fundamentals/middleware/index) -->
<span data-ttu-id="3660c-1348">Routing jest połączony z potokiem [pośredniczącym](xref:fundamentals/middleware/index) przez <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> klasę.</span><span class="sxs-lookup"><span data-stu-id="3660c-1348">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="3660c-1349">[ASP.NET Core MVC](xref:mvc/overview) dodaje Routing do potoku oprogramowania pośredniczącego w ramach swojej konfiguracji i obsługuje routing w aplikacjach MVC i Razor Pages.</span><span class="sxs-lookup"><span data-stu-id="3660c-1349">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration and handles routing in MVC and Razor Pages apps.</span></span> <span data-ttu-id="3660c-1350">Aby dowiedzieć się, jak używać routingu jako składnika autonomicznego, zapoznaj się z sekcją [Korzystanie z oprogramowania do routingu](#use-routing-middleware) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1350">To learn how to use routing as a standalone component, see the [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="3660c-1351">Dopasowanie adresu URL</span><span class="sxs-lookup"><span data-stu-id="3660c-1351">URL matching</span></span>

<span data-ttu-id="3660c-1352">Dopasowywanie adresów URL to proces, za pomocą którego Routing wysyła żądanie przychodzące do *procedury obsługi*.</span><span class="sxs-lookup"><span data-stu-id="3660c-1352">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="3660c-1353">Ten proces jest oparty na danych w ścieżce URL, ale można go rozszerzyć w celu uwzględnienia wszelkich danych w żądaniu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1353">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="3660c-1354">Możliwość wysyłania żądań do oddzielnych programów obsługi jest kluczem do skalowania rozmiaru i złożoności aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1354">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="3660c-1355">Żądania przychodzące wprowadzają <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> , który wywołuje <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> metodę dla każdej trasy w sekwencji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1355">Incoming requests enter the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="3660c-1356"><xref:Microsoft.AspNetCore.Routing.IRouter>Wystąpienie wybiera, czy *obsługiwać* żądanie przez ustawienie [RouteContext. Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) na wartość różną od null <xref:Microsoft.AspNetCore.Http.RequestDelegate> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1356">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="3660c-1357">Jeśli trasa ustawi procedurę obsługi dla żądania, przetwarzanie trasy zostanie zatrzymane, a procedura obsługi zostanie wywołana w celu przetworzenia żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1357">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="3660c-1358">Jeśli nie znaleziono procedury obsługi trasy do przetworzenia żądania, oprogramowanie pośredniczące przekazuje żądanie do następnego oprogramowania pośredniczącego w potoku żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1358">If no route handler is found to process the request, the middleware hands the request off to the next middleware in the request pipeline.</span></span>

<span data-ttu-id="3660c-1359">Podstawowe dane wejściowe <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> to [RouteContext. HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) skojarzone z bieżącym żądaniem.</span><span class="sxs-lookup"><span data-stu-id="3660c-1359">The primary input to <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="3660c-1360">[RouteContext. Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) i [RouteContext. RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) są ustawiane jako wyjście po dopasowaniu trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1360">The [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler) and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route is matched.</span></span>

<span data-ttu-id="3660c-1361">Dopasowanie, które wywołuje <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> również ustawia właściwości [RouteContext. RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) na odpowiednie wartości na podstawie przetwarzania żądania wykonanego do tej pory.</span><span class="sxs-lookup"><span data-stu-id="3660c-1361">A match that calls <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> also sets the properties of the [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData) to appropriate values based on the request processing performed thus far.</span></span>

<span data-ttu-id="3660c-1362">[RouteData. Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) to słownik *wartości tras* uzyskanych z trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1362">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="3660c-1363">Te wartości są zwykle określane przez tokenizowanie jako adres URL i mogą służyć do akceptowania danych wejściowych użytkownika lub do dalszej akceptacji decyzji w aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1363">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="3660c-1364">[RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) to zbiór właściwości dodatkowych danych dotyczących dopasowanej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1364">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="3660c-1365"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> zapewnia obsługę kojarzenia danych stanu z każdą trasą, dzięki czemu aplikacja może podejmować decyzje na podstawie dopasowanej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1365"><xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*> are provided to support associating state data with each route so that the app can make decisions based on which route matched.</span></span> <span data-ttu-id="3660c-1366">Te wartości są zdefiniowane przez dewelopera i **nie** mają wpływu na zachowanie routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1366">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="3660c-1367">Ponadto wartości umieszczane w [RouteData. Datatokeny](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) mogą być dowolnego typu, w przeciwieństwie do [RouteData. wartości](xref:Microsoft.AspNetCore.Routing.RouteData.Values), które muszą być konwertowane do i z ciągów.</span><span class="sxs-lookup"><span data-stu-id="3660c-1367">Additionally, values stashed in [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) can be of any type, in contrast to [RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values), which must be convertible to and from strings.</span></span>

<span data-ttu-id="3660c-1368">[RouteData. routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) to lista tras, które brały udział w pomyślnie dopasowane do żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1368">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="3660c-1369">Trasy mogą być zagnieżdżone wewnątrz siebie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1369">Routes can be nested inside of one another.</span></span> <span data-ttu-id="3660c-1370"><xref:Microsoft.AspNetCore.Routing.RouteData.Routers>Właściwość odzwierciedla ścieżkę przez logiczne drzewo tras, które spowodowały dopasowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1370">The <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="3660c-1371">Ogólnie rzecz biorąc, pierwszy element w <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> jest kolekcją tras i powinien być używany do generowania adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1371">Generally, the first item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="3660c-1372">Ostatnim elementem w programie <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> jest program obsługi trasy, który został dopasowany.</span><span class="sxs-lookup"><span data-stu-id="3660c-1372">The last item in <xref:Microsoft.AspNetCore.Routing.RouteData.Routers> is the route handler that matched.</span></span>

<a name="lg"></a>

### <a name="url-generation"></a><span data-ttu-id="3660c-1373">Generowanie adresu URL</span><span class="sxs-lookup"><span data-stu-id="3660c-1373">URL generation</span></span>

<span data-ttu-id="3660c-1374">Generowanie adresu URL to proces, za pomocą którego Routing może utworzyć ścieżkę URL na podstawie zestawu wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1374">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="3660c-1375">Pozwala to na logiczne rozdzielenie między programami obsługi tras i adresami URL, które uzyskują do nich dostęp.</span><span class="sxs-lookup"><span data-stu-id="3660c-1375">This allows for a logical separation between route handlers and the URLs that access them.</span></span>

<span data-ttu-id="3660c-1376">Generowanie adresu URL następuje podobny proces iteracyjny, ale rozpoczyna się od kodu użytkownika lub struktury wywołującego <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> metodę kolekcji tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1376">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="3660c-1377">Każda *trasa* ma <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> metodę wywoływana w sekwencji do momentu zwrócenia wartości innej niż null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1377">Each *route* has its <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="3660c-1378">Podstawowe dane wejściowe <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> :</span><span class="sxs-lookup"><span data-stu-id="3660c-1378">The primary inputs to <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> are:</span></span>

* [<span data-ttu-id="3660c-1379">VirtualPathContext. HttpContext</span><span class="sxs-lookup"><span data-stu-id="3660c-1379">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext)
* [<span data-ttu-id="3660c-1380">VirtualPathContext. wartości</span><span class="sxs-lookup"><span data-stu-id="3660c-1380">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values)
* [<span data-ttu-id="3660c-1381">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="3660c-1381">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues)

<span data-ttu-id="3660c-1382">Trasy wykorzystują głównie wartości trasy dostarczone przez <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> i, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> Aby zdecydować, czy możliwe jest WYGENEROWANIE adresu URL i wartości do uwzględnienia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1382">Routes primarily use the route values provided by <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> and <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="3660c-1383"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues>Są to zbiór wartości tras, które zostały utworzone na podstawie dopasowania bieżącego żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1383">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues> are the set of route values that were produced from matching the current request.</span></span> <span data-ttu-id="3660c-1384">Z kolei <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> są wartościami trasy, które określają sposób generowania żądanego adresu URL dla bieżącej operacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1384">In contrast, <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values> are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="3660c-1385"><xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext>W przypadku trasy należy uzyskać usługi lub dodatkowe dane skojarzone z bieżącym kontekstem.</span><span class="sxs-lookup"><span data-stu-id="3660c-1385">The <xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext> is provided in case a route should obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="3660c-1386">Pomyśl o [VirtualPathContext. wartości](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) jako zestawu zastąpień dla [VirtualPathContext. AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="3660c-1386">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="3660c-1387">Generowanie adresów URL próbuje ponownie użyć wartości trasy z bieżącego żądania w celu wygenerowania adresów URL dla linków przy użyciu tych samych wartości trasy lub trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1387">URL generation attempts to reuse route values from the current request to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="3660c-1388">Wynik <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> jest <xref:Microsoft.AspNetCore.Routing.VirtualPathData> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1388">The output of <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is a <xref:Microsoft.AspNetCore.Routing.VirtualPathData>.</span></span> <span data-ttu-id="3660c-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> jest równoległe z <xref:Microsoft.AspNetCore.Routing.RouteData> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1389"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> is a parallel of <xref:Microsoft.AspNetCore.Routing.RouteData>.</span></span> <span data-ttu-id="3660c-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> zawiera wartość <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> dla wyjściowego adresu URL oraz kilka dodatkowych właściwości, które powinny być ustawiane przez trasę.</span><span class="sxs-lookup"><span data-stu-id="3660c-1390"><xref:Microsoft.AspNetCore.Routing.VirtualPathData> contains the <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="3660c-1391">Właściwość [VirtualPathData. VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) zawiera *ścieżkę wirtualną* wygenerowaną przez trasę.</span><span class="sxs-lookup"><span data-stu-id="3660c-1391">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="3660c-1392">W zależności od potrzeb może być konieczne dalsze przetworzenie ścieżki.</span><span class="sxs-lookup"><span data-stu-id="3660c-1392">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="3660c-1393">Jeśli chcesz renderować wygenerowany adres URL w formacie HTML, poprzedź ścieżkę podstawową aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1393">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="3660c-1394">[VirtualPathData. router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) jest odwołaniem do trasy, która pomyślnie wygenerowała adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1394">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="3660c-1395">Właściwości [VirtualPathData. DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) to słownik dodatkowych danych związanych z trasą, która wygenerowała adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1395">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="3660c-1396">Jest to równoległy [RouteData. DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="3660c-1396">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="create-routes"></a><span data-ttu-id="3660c-1397">Tworzenie tras</span><span class="sxs-lookup"><span data-stu-id="3660c-1397">Create routes</span></span>

<span data-ttu-id="3660c-1398">Routing udostępnia <xref:Microsoft.AspNetCore.Routing.Route> klasę jako standardową implementację programu <xref:Microsoft.AspNetCore.Routing.IRouter> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1398">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="3660c-1399"><xref:Microsoft.AspNetCore.Routing.Route> używa składni *szablonu trasy* do definiowania wzorców do dopasowania względem ścieżki URL, gdy <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="3660c-1399"><xref:Microsoft.AspNetCore.Routing.Route> uses the *route template* syntax to define patterns to match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="3660c-1400"><xref:Microsoft.AspNetCore.Routing.Route> używa tego samego szablonu trasy do wygenerowania adresu URL, gdy <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> jest wywoływana.</span><span class="sxs-lookup"><span data-stu-id="3660c-1400"><xref:Microsoft.AspNetCore.Routing.Route> uses the same route template to generate a URL when <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> is called.</span></span>

<span data-ttu-id="3660c-1401">Większość aplikacji tworzy trasy przez wywołanie <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> lub jedną z podobnych metod rozszerzających zdefiniowanych w systemie <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1401">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="3660c-1402">Dowolna z <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> metod rozszerzających tworzy wystąpienie <xref:Microsoft.AspNetCore.Routing.Route> i dodaje je do kolekcji tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1402">Any of the <xref:Microsoft.AspNetCore.Routing.IRouteBuilder> extension methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="3660c-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> nie akceptuje parametru procedury obsługi trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1403"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> doesn't accept a route handler parameter.</span></span> <span data-ttu-id="3660c-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> dodaje tylko trasy, które są obsługiwane przez <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1404"><xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="3660c-1405">Domyślna procedura obsługi to `IRouter` , a program obsługi może nie obsłużyć żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1405">The default handler is an `IRouter`, and the handler might not handle the request.</span></span> <span data-ttu-id="3660c-1406">Na przykład ASP.NET Core MVC jest zwykle skonfigurowany jako domyślny program obsługi, który obsługuje tylko żądania zgodne z dostępnym kontrolerem i akcją.</span><span class="sxs-lookup"><span data-stu-id="3660c-1406">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="3660c-1407">Aby dowiedzieć się więcej na temat routingu w MVC, zobacz <xref:mvc/controllers/routing> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1407">To learn more about routing in MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="3660c-1408">Poniższy przykład kodu jest przykładem <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wywołania używanego przez typową definicję trasy MVC ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="3660c-1408">The following code example is an example of a <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="3660c-1409">Ten szablon dopasowuje ścieżkę URL i wyodrębnia wartości tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1409">This template matches a URL path and extracts the route values.</span></span> <span data-ttu-id="3660c-1410">Na przykład ścieżka `/Products/Details/17` generuje następujące wartości trasy: `{ controller = Products, action = Details, id = 17 }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1410">For example, the path `/Products/Details/17` generates the following route values: `{ controller = Products, action = Details, id = 17 }`.</span></span>

<span data-ttu-id="3660c-1411">Wartości tras są określane przez podzielenie ścieżki URL na segmenty i dopasowanie do każdego segmentu przy użyciu nazwy *parametru trasy* w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1411">Route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="3660c-1412">Parametry trasy są nazywane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1412">Route parameters are named.</span></span> <span data-ttu-id="3660c-1413">Parametry zdefiniowane przez ujęcie nazwy parametru w nawiasach klamrowych `{ ... }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1413">The parameters defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="3660c-1414">Poprzedni szablon może również pasować do ścieżki URL `/` i generować wartości `{ controller = Home, action = Index }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1414">The preceding template could also match the URL path `/` and produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="3660c-1415">Dzieje się tak, `{controller}` ponieważ `{action}` Parametry i trasy mają wartości domyślne, a `id` parametr trasy jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1415">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="3660c-1416">Znak równości ( `=` ), po którym następuje wartość po nazwie parametru trasy definiuje wartość domyślną dla parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1416">An equals sign (`=`) followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="3660c-1417">Znak zapytania ( `?` ) po nazwie parametru trasy definiuje opcjonalny parametr.</span><span class="sxs-lookup"><span data-stu-id="3660c-1417">A question mark (`?`) after the route parameter name defines an optional parameter.</span></span>

<span data-ttu-id="3660c-1418">Parametry trasy z wartością domyślną *zawsze* generują wartość trasy w przypadku dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1418">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="3660c-1419">Parametry opcjonalne nie generują wartości trasy, jeśli nie ma odpowiedniego segmentu ścieżki adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1419">Optional parameters don't produce a route value if there is no corresponding URL path segment.</span></span> <span data-ttu-id="3660c-1420">Szczegółowe opisy scenariuszy i składni szablonów tras można znaleźć w sekcji [Dokumentacja dotycząca szablonu trasy](#route-template-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1420">See the [Route template reference](#route-template-reference) section for a thorough description of route template scenarios and syntax.</span></span>

<span data-ttu-id="3660c-1421">W poniższym przykładzie definicja parametru trasy `{id:int}` definiuje [ograniczenie trasy](#route-constraint-reference) dla `id` parametru trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1421">In the following example, the route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="3660c-1422">Ten szablon dopasowuje ścieżkę URL, taką jak, `/Products/Details/17` ale nie `/Products/Details/Apples` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1422">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="3660c-1423">Ograniczenia trasy implementują <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> i sprawdzają wartości routingu w celu ich zweryfikowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1423">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="3660c-1424">W tym przykładzie wartość trasy `id` musi być możliwa do przekonwertowania na liczbę całkowitą.</span><span class="sxs-lookup"><span data-stu-id="3660c-1424">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="3660c-1425">Aby uzyskać wyjaśnienie ograniczeń trasy dostarczonych przez platformę, zobacz temat [ograniczenia trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1425">See [route-constraint-reference](#route-constraint-reference) for an explanation of route constraints provided by the framework.</span></span>

<span data-ttu-id="3660c-1426">Dodatkowe przeciążenia <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> wartości akceptują dla `constraints` , `dataTokens` i `defaults` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1426">Additional overloads of <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="3660c-1427">Typowym użyciem tych parametrów jest przekazanie anonimowo wpisanego obiektu, gdzie nazwy właściwości typu anonimowego są zgodne z nazwami parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1427">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="3660c-1428">Poniższe <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> przykłady tworzą równoważne trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1428">The following <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="3660c-1429">Wbudowana Składnia służąca do definiowania ograniczeń i wartości domyślnych może być wygodna dla prostych tras.</span><span class="sxs-lookup"><span data-stu-id="3660c-1429">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="3660c-1430">Istnieją jednak scenariusze, takie jak tokeny danych, które nie są obsługiwane przez składnię wbudowaną.</span><span class="sxs-lookup"><span data-stu-id="3660c-1430">However, there are scenarios, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="3660c-1431">Poniższy przykład ilustruje kilka dodatkowych scenariuszy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1431">The following example demonstrates a few additional scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="3660c-1432">Poprzedni szablon pasuje do ścieżki URL, tak jak `/Blog/All-About-Routing/Introduction` i wyodrębnia wartości `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1432">The preceding template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="3660c-1433">Domyślne wartości trasy dla `controller` i `action` są generowane przez trasę, nawet jeśli w szablonie nie ma odpowiednich parametrów trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1433">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="3660c-1434">Wartości domyślne można określić w szablonie trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1434">Default values can be specified in the route template.</span></span> <span data-ttu-id="3660c-1435">`article`Parametr Route jest definiowany jako *przechwycenie* przez wygląd gwiazdki ( `*` ) przed nazwą parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1435">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk (`*`) before the route parameter name.</span></span> <span data-ttu-id="3660c-1436">Catch-wszystkie parametry tras przechwytują resztę ścieżki URL i mogą również pasować do pustego ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1436">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="3660c-1437">Poniższy przykład dodaje ograniczenia trasy i tokeny danych:</span><span class="sxs-lookup"><span data-stu-id="3660c-1437">The following example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="3660c-1438">Poprzedni szablon pasuje do ścieżki URL, na przykład `/en-US/Products/5` i wyodrębnia wartości `{ controller = Products, action = Details, id = 5 }` i tokeny danych `{ locale = en-US }` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1438">The preceding template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Lokalne tokeny systemu Windows](routing/_static/tokens.png)

### <a name="route-class-url-generation"></a><span data-ttu-id="3660c-1440">Generowanie adresu URL klasy trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1440">Route class URL generation</span></span>

<span data-ttu-id="3660c-1441"><xref:Microsoft.AspNetCore.Routing.Route>Klasa może również wykonywać generowanie adresów URL przez połączenie zestawu wartości tras z jego szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1441">The <xref:Microsoft.AspNetCore.Routing.Route> class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="3660c-1442">Jest to logicznie proces odwrotny pasujący do ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1442">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="3660c-1443">Aby lepiej zrozumieć generowanie adresów URL, Załóżmy, jaki adres URL ma zostać wygenerowany, a następnie pomyśl o sposobie dopasowania szablonu trasy do tego adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1443">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="3660c-1444">Jakie wartości zostałyby wygenerowane?</span><span class="sxs-lookup"><span data-stu-id="3660c-1444">What values would be produced?</span></span> <span data-ttu-id="3660c-1445">Jest to sztywny odpowiednik działania generowania adresów URL w <xref:Microsoft.AspNetCore.Routing.Route> klasie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1445">This is the rough equivalent of how URL generation works in the <xref:Microsoft.AspNetCore.Routing.Route> class.</span></span>

<span data-ttu-id="3660c-1446">Poniższy przykład używa ogólnej trasy domyślnej ASP.NET Core MVC:</span><span class="sxs-lookup"><span data-stu-id="3660c-1446">The following example uses a general ASP.NET Core MVC default route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="3660c-1447">W przypadku wartości trasy `{ controller = Products, action = List }` `/Products/List` zostanie wygenerowany adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1447">With the route values `{ controller = Products, action = List }`, the URL `/Products/List` is generated.</span></span> <span data-ttu-id="3660c-1448">Wartości trasy są zastępowane odpowiednimi parametrami trasy w celu utworzenia ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1448">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="3660c-1449">Ponieważ `id` jest to opcjonalny parametr trasy, adres URL został pomyślnie wygenerowany bez wartości dla `id` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1449">Since `id` is an optional route parameter, the URL is successfully generated without a value for `id`.</span></span>

<span data-ttu-id="3660c-1450">W przypadku wartości trasy `{ controller = Home, action = Index }` `/` zostanie wygenerowany adres URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1450">With the route values `{ controller = Home, action = Index }`, the URL `/` is generated.</span></span> <span data-ttu-id="3660c-1451">Podane wartości trasy są zgodne z wartościami domyślnymi, a segmenty odpowiadające wartościom domyślnym są bezpiecznie pomijane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1451">The provided route values match the default values, and the segments corresponding to the default values are safely omitted.</span></span>

<span data-ttu-id="3660c-1452">Oba adresy URL wygenerowały rundę z następującą definicją trasy ( `/Home/Index` i `/` ) tworzą te same wartości trasy, które zostały użyte do WYGENEROWANIA adresu URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1452">Both URLs generated round-trip with the following route definition (`/Home/Index` and `/`) produce the same route values that were used to generate the URL.</span></span>

> [!NOTE]
> <span data-ttu-id="3660c-1453">Aplikacja używająca ASP.NET Core MVC powinna używać <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> do generowania adresów URL zamiast bezpośredniego wywoływania routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1453">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="3660c-1454">Aby uzyskać więcej informacji na temat generowania adresów URL, zobacz sekcję [informacje dotyczące generowania adresów URL](#url-generation-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1454">For more information on URL generation, see the [Url generation reference](#url-generation-reference) section.</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="3660c-1455">Korzystanie z oprogramowania pośredniczącego routingu</span><span class="sxs-lookup"><span data-stu-id="3660c-1455">Use routing middleware</span></span>

<span data-ttu-id="3660c-1456">Odwołuje się do [pakietu Microsoft. AspNetCore. app](xref:fundamentals/metapackage-app) w pliku projektu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1456">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

<span data-ttu-id="3660c-1457">Dodaj Routing do kontenera usługi w `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="3660c-1457">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

<span data-ttu-id="3660c-1458">Trasy muszą być skonfigurowane w `Startup.Configure` metodzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1458">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="3660c-1459">Przykładowa aplikacja używa następujących interfejsów API:</span><span class="sxs-lookup"><span data-stu-id="3660c-1459">The sample app uses the following APIs:</span></span>

* <xref:Microsoft.AspNetCore.Routing.RouteBuilder>
* <span data-ttu-id="3660c-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Dopasowuje tylko żądania HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="3660c-1460"><xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>: Matches only HTTP GET requests.</span></span>
* <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

<span data-ttu-id="3660c-1461">W poniższej tabeli przedstawiono odpowiedzi z podanym identyfikatorem URI.</span><span class="sxs-lookup"><span data-stu-id="3660c-1461">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="3660c-1462">URI</span><span class="sxs-lookup"><span data-stu-id="3660c-1462">URI</span></span>                    | <span data-ttu-id="3660c-1463">Reakcja</span><span class="sxs-lookup"><span data-stu-id="3660c-1463">Response</span></span>                                          |
| ---------------------- | ------------------------------------------------- |
| `/package/create/3`    | <span data-ttu-id="3660c-1464">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1464">Hello!</span></span> <span data-ttu-id="3660c-1465">Wartości trasy: [Operation, Create], [ID, 3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1465">Route values: [operation, create], [id, 3]</span></span> |
| `/package/track/-3`    | <span data-ttu-id="3660c-1466">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1466">Hello!</span></span> <span data-ttu-id="3660c-1467">Wartości trasy: [Operation, Track], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1467">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/-3/`   | <span data-ttu-id="3660c-1468">Cześć!</span><span class="sxs-lookup"><span data-stu-id="3660c-1468">Hello!</span></span> <span data-ttu-id="3660c-1469">Wartości trasy: [Operation, Track], [ID,-3]</span><span class="sxs-lookup"><span data-stu-id="3660c-1469">Route values: [operation, track], [id, -3]</span></span> |
| `/package/track/`      | <span data-ttu-id="3660c-1470">Żądanie przepada w, brak dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1470">The request falls through, no match.</span></span>              |
| `GET /hello/Joe`       | <span data-ttu-id="3660c-1471">Witaj, Jan!</span><span class="sxs-lookup"><span data-stu-id="3660c-1471">Hi, Joe!</span></span>                                          |
| `POST /hello/Joe`      | <span data-ttu-id="3660c-1472">Żądanie przepada w, dopasowuje tylko HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="3660c-1472">The request falls through, matches HTTP GET only.</span></span> |
| `GET /hello/Joe/Smith` | <span data-ttu-id="3660c-1473">Żądanie przepada w, brak dopasowania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1473">The request falls through, no match.</span></span>              |

<span data-ttu-id="3660c-1474">W przypadku konfigurowania pojedynczej trasy Wywołaj <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> przekazywanie w `IRouter` wystąpieniu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1474">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="3660c-1475">Nie musisz używać <xref:Microsoft.AspNetCore.Routing.RouteBuilder> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1475">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="3660c-1476">Struktura zawiera zestaw metod rozszerzających do tworzenia tras ( <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions> ):</span><span class="sxs-lookup"><span data-stu-id="3660c-1476">The framework provides a set of extension methods for creating routes (<xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions>):</span></span>

* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareDelete*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareGet*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewarePut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapMiddlewareVerb*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPost*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapPut*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>
* <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>

<span data-ttu-id="3660c-1477">Niektóre z wymienionych metod, takie jak <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> , wymagają <xref:Microsoft.AspNetCore.Http.RequestDelegate> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1477">Some of listed methods, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*>, require a <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="3660c-1478"><xref:Microsoft.AspNetCore.Http.RequestDelegate>Jest używany jako *program obsługi trasy* , gdy trasa pasuje.</span><span class="sxs-lookup"><span data-stu-id="3660c-1478">The <xref:Microsoft.AspNetCore.Http.RequestDelegate> is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="3660c-1479">Inne metody w tej rodzinie umożliwiają skonfigurowanie potoku oprogramowania pośredniczącego, które ma być używane jako procedura obsługi trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1479">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="3660c-1480">Jeśli `Map*` Metoda nie akceptuje procedury obsługi, takiej jak <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*> , używa <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1480">If the `Map*` method doesn't accept a handler, such as <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapRoute*>, it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="3660c-1481">`Map[Verb]`Metody służą do ograniczania trasy do zlecenia HTTP w nazwie metody.</span><span class="sxs-lookup"><span data-stu-id="3660c-1481">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="3660c-1482">Na przykład zobacz <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> i <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="3660c-1482">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="3660c-1483">Odwołanie do szablonu trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1483">Route template reference</span></span>

<span data-ttu-id="3660c-1484">Tokeny w nawiasach klamrowych ( `{ ... }` ) definiują *Parametry trasy* , które są powiązane w przypadku dopasowania trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1484">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="3660c-1485">Można zdefiniować więcej niż jeden parametr trasy w segmencie trasy, ale muszą one być oddzielone wartością literału.</span><span class="sxs-lookup"><span data-stu-id="3660c-1485">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="3660c-1486">Na przykład `{controller=Home}{action=Index}` nie jest prawidłową trasą, ponieważ nie ma wartości literału między `{controller}` i `{action}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1486">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="3660c-1487">Te parametry trasy muszą mieć nazwę i mogą mieć określone dodatkowe atrybuty.</span><span class="sxs-lookup"><span data-stu-id="3660c-1487">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="3660c-1488">Tekst literału inny niż parametry trasy (na przykład `{id}` ) i separator ścieżki `/` muszą być zgodne z tekstem w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1488">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="3660c-1489">W dopasowaniu do tekstu nie jest rozróżniana wielkość liter i w oparciu o zdekodowaną reprezentację ścieżki URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1489">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="3660c-1490">Aby dopasować Ogranicznik parametru trasy literału ( `{` lub `}` ), należy wprowadzić ogranicznik przez powtórzenie znaku ( `{{` lub `}}` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1490">To match a literal route parameter delimiter (`{` or `}`), escape the delimiter by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="3660c-1491">Wzorce adresów URL, które próbują przechwycić nazwę pliku z opcjonalnym rozszerzeniem pliku, mają dodatkowe uwagi.</span><span class="sxs-lookup"><span data-stu-id="3660c-1491">URL patterns that attempt to capture a file name with an optional file extension have additional considerations.</span></span> <span data-ttu-id="3660c-1492">Rozważmy na przykład szablon `files/{filename}.{ext?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1492">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="3660c-1493">Gdy wartości obu `filename` i `ext` istnieją, są wypełniane obie wartości.</span><span class="sxs-lookup"><span data-stu-id="3660c-1493">When values for both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="3660c-1494">Jeśli `filename` w adresie URL znajduje się tylko wartość parametru, trasa pasuje do, ponieważ końcowy okres ( `.` ) jest opcjonalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1494">If only a value for `filename` exists in the URL, the route matches because the trailing period (`.`) is  optional.</span></span> <span data-ttu-id="3660c-1495">Następujące adresy URL pasują do tej trasy:</span><span class="sxs-lookup"><span data-stu-id="3660c-1495">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="3660c-1496">Możesz użyć gwiazdki ( `*` ) jako prefiksu do parametru trasy, aby powiązać z resztą identyfikatora URI.</span><span class="sxs-lookup"><span data-stu-id="3660c-1496">You can use the asterisk (`*`) as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="3660c-1497">Jest to nazywane parametrem *"catch-all"* .</span><span class="sxs-lookup"><span data-stu-id="3660c-1497">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="3660c-1498">Na przykład `blog/{*slug}` dopasowuje dowolny identyfikator URI, który rozpoczyna się od `/blog` i ma dowolną wartość, która jest przypisana do `slug` wartości trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1498">For example, `blog/{*slug}` matches any URI that starts with `/blog` and has any value following it, which is assigned to the `slug` route value.</span></span> <span data-ttu-id="3660c-1499">Catch-wszystkie parametry można także dopasować do pustego ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1499">Catch-all parameters can also match the empty string.</span></span>

<span data-ttu-id="3660c-1500">Parametr catch-all wyprowadza odpowiednie znaki, gdy trasa jest używana do generowania adresu URL, włącznie z separatorami ścieżki ( `/` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1500">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="3660c-1501">Na przykład trasa `foo/{*path}` z wartościami trasy jest `{ path = "my/path" }` generowana `foo/my%2Fpath` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1501">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="3660c-1502">Zwróć uwagę na odwrócony ukośnik.</span><span class="sxs-lookup"><span data-stu-id="3660c-1502">Note the escaped forward slash.</span></span>

<span data-ttu-id="3660c-1503">Parametry trasy mogą mieć *wartości domyślne* , określając wartość domyślną po nazwie parametru oddzielone znakiem równości ( `=` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1503">Route parameters may have *default values* designated by specifying the default value after the parameter name separated by an equals sign (`=`).</span></span> <span data-ttu-id="3660c-1504">Na przykład `{controller=Home}` definiuje `Home` jako wartość domyślną dla `controller` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1504">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="3660c-1505">Wartość domyślna jest używana, jeśli żadna wartość nie jest obecna w adresie URL dla parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1505">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="3660c-1506">Parametry trasy są opcjonalne przez dołączenie znaku zapytania ( `?` ) na końcu nazwy parametru, jak w `id?` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1506">Route parameters are made optional by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="3660c-1507">Różnica między wartościami opcjonalnymi i domyślnymi parametrami trasy polega na tym, że parametr trasy z wartością domyślną zawsze tworzy wartość, &mdash; a opcjonalny parametr ma wartość tylko wtedy, gdy wartość jest dostarczana przez adres URL żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1507">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value&mdash;an optional parameter has a value only when a value is provided by the request URL.</span></span>

<span data-ttu-id="3660c-1508">Parametry trasy mogą mieć ograniczenia, które muszą być zgodne z wartością trasy powiązaną z adresem URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1508">Route parameters may have constraints that must match the route value bound from the URL.</span></span> <span data-ttu-id="3660c-1509">Dodanie dwukropka ( `:` ) i nazwy ograniczenia po nazwie parametru trasy określa *ograniczenie wbudowane* dla parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1509">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="3660c-1510">Jeśli ograniczenie wymaga argumentów, są one ujęte w nawiasy ( `(...)` ) po nazwie ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1510">If the constraint requires arguments, they're enclosed in parentheses (`(...)`) after the constraint name.</span></span> <span data-ttu-id="3660c-1511">Można określić wiele ograniczeń wbudowanych, dołączając inną dwukropek ( `:` ) i nazwę ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1511">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span>

<span data-ttu-id="3660c-1512">Nazwa i argumenty ograniczenia są przekazane do usługi w <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> celu utworzenia wystąpienia <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> do użycia w przetwarzaniu adresów URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1512">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="3660c-1513">Na przykład szablon trasy `blog/{article:minlength(10)}` określa `minlength` ograniczenie z argumentem `10` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1513">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="3660c-1514">Aby uzyskać więcej informacji na temat ograniczeń trasy i listę ograniczeń zapewnianych przez platformę, zobacz sekcję [odwołanie do ograniczenia trasy](#route-constraint-reference) .</span><span class="sxs-lookup"><span data-stu-id="3660c-1514">For more information on route constraints and a list of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

<span data-ttu-id="3660c-1515">W poniższej tabeli przedstawiono przykładowe szablony tras i ich zachowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1515">The following table demonstrates example route templates and their behavior.</span></span>

| <span data-ttu-id="3660c-1516">Szablon trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1516">Route Template</span></span>                           | <span data-ttu-id="3660c-1517">Przykładowy pasujący identyfikator URI</span><span class="sxs-lookup"><span data-stu-id="3660c-1517">Example Matching URI</span></span>    | <span data-ttu-id="3660c-1518">Identyfikator URI żądania&hellip;</span><span class="sxs-lookup"><span data-stu-id="3660c-1518">The request URI&hellip;</span></span>                                                    |
| ---------------------------------------- | ----------------------- | -------------------------------------------------------------------------- |
| `hello`                                  | `/hello`                | <span data-ttu-id="3660c-1519">Dopasowuje tylko jedną ścieżkę `/hello` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1519">Only matches the single path `/hello`.</span></span>                                     |
| `{Page=Home}`                            | `/`                     | <span data-ttu-id="3660c-1520">Dopasowuje i ustawia `Page` jako `Home` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1520">Matches and sets `Page` to `Home`.</span></span>                                         |
| `{Page=Home}`                            | `/Contact`              | <span data-ttu-id="3660c-1521">Dopasowuje i ustawia `Page` jako `Contact` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1521">Matches and sets `Page` to `Contact`.</span></span>                                      |
| `{controller}/{action}/{id?}`            | `/Products/List`        | <span data-ttu-id="3660c-1522">Mapuje do `Products` kontrolera i `List` akcji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1522">Maps to the `Products` controller and `List` action.</span></span>                       |
| `{controller}/{action}/{id?}`            | `/Products/Details/123` | <span data-ttu-id="3660c-1523">Mapuje do `Products` kontrolera i  `Details` akcji ( `id` ustawienie na 123).</span><span class="sxs-lookup"><span data-stu-id="3660c-1523">Maps to the `Products` controller and  `Details` action (`id` set to 123).</span></span> |
| `{controller=Home}/{action=Index}/{id?}` | `/`                     | <span data-ttu-id="3660c-1524">Mapuje na `Home` kontroler i `Index` metodę ( `id` jest ignorowana).</span><span class="sxs-lookup"><span data-stu-id="3660c-1524">Maps to the `Home` controller and `Index` method (`id` is ignored).</span></span>        |

<span data-ttu-id="3660c-1525">Użycie szablonu jest ogólnie najprostszym podejściem do routingu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1525">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="3660c-1526">Ograniczenia i wartości domyślne można także określić poza szablonem trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1526">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="3660c-1527">Włącz [Rejestrowanie](xref:fundamentals/logging/index) , aby zobaczyć, jak wbudowane implementacje routingu, takie jak <xref:Microsoft.AspNetCore.Routing.Route> , dopasowują żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1527">Enable [Logging](xref:fundamentals/logging/index) to see how the built-in routing implementations, such as <xref:Microsoft.AspNetCore.Routing.Route>, match requests.</span></span>

## <a name="route-constraint-reference"></a><span data-ttu-id="3660c-1528">Odwołanie do ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1528">Route constraint reference</span></span>

<span data-ttu-id="3660c-1529">Ograniczenia trasy są wykonywane, gdy nastąpiło dopasowanie do przychodzącego adresu URL, a Ścieżka adresu URL jest zgodna z wartościami trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1529">Route constraints execute when a match has occurred to the incoming URL and the URL path is tokenized into route values.</span></span> <span data-ttu-id="3660c-1530">Ograniczenia trasy zwykle sprawdzają wartość trasy skojarzoną za pośrednictwem szablonu trasy i podejmują decyzję o tym, czy wartość jest akceptowalna.</span><span class="sxs-lookup"><span data-stu-id="3660c-1530">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="3660c-1531">Niektóre ograniczenia trasy używają danych poza wartością trasy, aby uwzględnić, czy żądanie może być kierowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1531">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="3660c-1532">Na przykład <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> może akceptować lub odrzucać żądanie na podstawie jego zlecenia http.</span><span class="sxs-lookup"><span data-stu-id="3660c-1532">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span> <span data-ttu-id="3660c-1533">Ograniczenia są używane w żądaniach routingu i generowania linków.</span><span class="sxs-lookup"><span data-stu-id="3660c-1533">Constraints are used in routing requests and link generation.</span></span>

> [!WARNING]
> <span data-ttu-id="3660c-1534">Nie używaj ograniczeń **sprawdzania poprawności danych wejściowych**.</span><span class="sxs-lookup"><span data-stu-id="3660c-1534">Don't use constraints for **input validation**.</span></span> <span data-ttu-id="3660c-1535">Jeśli ograniczenia są używane do **sprawdzania poprawności danych wejściowych**, nieprawidłowe dane wejściowe w odpowiedzi *404 — nie znaleziono* , zamiast *żądania 400-złe* z odpowiednim komunikatem o błędzie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1535">If constraints are used for **input validation**, invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="3660c-1536">Ograniczenia trasy są **używane do** odróżniania podobnych tras, a nie do sprawdzania danych wejściowych dla określonej trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1536">Route constraints are used to **disambiguate** similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="3660c-1537">W poniższej tabeli przedstawiono przykładowe ograniczenia trasy i ich oczekiwane zachowanie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1537">The following table demonstrates example route constraints and their expected behavior.</span></span>

| <span data-ttu-id="3660c-1538">ograniczenie</span><span class="sxs-lookup"><span data-stu-id="3660c-1538">constraint</span></span> | <span data-ttu-id="3660c-1539">Przykład</span><span class="sxs-lookup"><span data-stu-id="3660c-1539">Example</span></span> | <span data-ttu-id="3660c-1540">Przykładowe dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-1540">Example Matches</span></span> | <span data-ttu-id="3660c-1541">Uwagi</span><span class="sxs-lookup"><span data-stu-id="3660c-1541">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="3660c-1542">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-1542">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-1543">Dopasowuje dowolną liczbę całkowitą</span><span class="sxs-lookup"><span data-stu-id="3660c-1543">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="3660c-1544">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="3660c-1544">`true`, `FALSE`</span></span> | <span data-ttu-id="3660c-1545">Dopasowuje lub (bez uwzględniania `true` `false` wielkości liter)</span><span class="sxs-lookup"><span data-stu-id="3660c-1545">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="3660c-1546">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="3660c-1546">`2016-12-31`, `2016-12-31 7:32pm`</span></span> | <span data-ttu-id="3660c-1547">Dopasowuje prawidłową `DateTime` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1547">Matches a valid `DateTime` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1548">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1548">See  preceding warning.</span></span>|
| `decimal` | `{price:decimal}` | <span data-ttu-id="3660c-1549">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="3660c-1549">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="3660c-1550">Dopasowuje prawidłową `decimal` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1550">Matches a valid `decimal` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1551">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1551">See  preceding warning.</span></span>|
| `double` | `{weight:double}` | <span data-ttu-id="3660c-1552">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-1552">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-1553">Dopasowuje prawidłową `double` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1553">Matches a valid `double` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1554">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1554">See  preceding warning.</span></span>|
| `float` | `{weight:float}` | <span data-ttu-id="3660c-1555">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="3660c-1555">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="3660c-1556">Dopasowuje prawidłową `float` wartość w niezmiennej kulturze.</span><span class="sxs-lookup"><span data-stu-id="3660c-1556">Matches a valid `float` value in the invariant culture.</span></span> <span data-ttu-id="3660c-1557">Zobacz poprzednie ostrzeżenie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1557">See  preceding warning.</span></span>|
| `guid` | `{id:guid}` | <span data-ttu-id="3660c-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="3660c-1558">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="3660c-1559">Dopasowuje prawidłową `Guid` wartość</span><span class="sxs-lookup"><span data-stu-id="3660c-1559">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="3660c-1560">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="3660c-1560">`123456789`, `-123456789`</span></span> | <span data-ttu-id="3660c-1561">Dopasowuje prawidłową `long` wartość</span><span class="sxs-lookup"><span data-stu-id="3660c-1561">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="3660c-1562">Ciąg musi składać się z co najmniej 4 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-1562">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="3660c-1563">Ciąg nie może zawierać więcej niż 8 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-1563">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="3660c-1564">Ciąg musi zawierać dokładnie 12 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-1564">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="3660c-1565">Ciąg musi mieć długość co najmniej 8 znaków</span><span class="sxs-lookup"><span data-stu-id="3660c-1565">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="3660c-1566">Wartość całkowita musi być równa co najmniej 18</span><span class="sxs-lookup"><span data-stu-id="3660c-1566">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="3660c-1567">Wartość całkowita nie może być większa niż 120</span><span class="sxs-lookup"><span data-stu-id="3660c-1567">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="3660c-1568">Wartość całkowita musi być równa co najmniej 18, ale nie więcej niż 120</span><span class="sxs-lookup"><span data-stu-id="3660c-1568">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="3660c-1569">Ciąg musi zawierać co najmniej jeden znak alfabetyczny (bez `a` - `z` uwzględniania wielkości liter)</span><span class="sxs-lookup"><span data-stu-id="3660c-1569">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="3660c-1570">Ciąg musi być zgodny z wyrażeniem regularnym (zobacz Porady dotyczące definiowania wyrażenia regularnego)</span><span class="sxs-lookup"><span data-stu-id="3660c-1570">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` | <span data-ttu-id="3660c-1571">Służy do wymuszania, że podczas generowania adresu URL jest obecna wartość, która nie jest wartością parametru</span><span class="sxs-lookup"><span data-stu-id="3660c-1571">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="3660c-1572">Wielokrotne ograniczenia rozdzielane średnikami można zastosować do jednego parametru.</span><span class="sxs-lookup"><span data-stu-id="3660c-1572">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="3660c-1573">Na przykład następujące ograniczenie ogranicza parametr do wartości całkowitej 1 lub wyższej:</span><span class="sxs-lookup"><span data-stu-id="3660c-1573">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="3660c-1574">Ograniczenia trasy, które weryfikują adres URL i są konwertowane na typ CLR (takie jak `int` lub `DateTime` ), zawsze używają niezmiennej kultury.</span><span class="sxs-lookup"><span data-stu-id="3660c-1574">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="3660c-1575">W tych ograniczeniach przyjęto założenie, że adres URL nie jest Lokalizowalny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1575">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="3660c-1576">Ograniczenia trasy dostarczone przez platformę nie modyfikują wartości przechowywanych w wartościach trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1576">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="3660c-1577">Wszystkie wartości tras analizowane na podstawie adresu URL są przechowywane jako ciągi.</span><span class="sxs-lookup"><span data-stu-id="3660c-1577">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="3660c-1578">Na przykład, `float` ograniczenie próbuje przekonwertować wartość trasy na float, ale przekonwertowana wartość jest używana tylko do sprawdzenia, czy może być konwertowana na typ float.</span><span class="sxs-lookup"><span data-stu-id="3660c-1578">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="3660c-1579">Wyrażenia regularne</span><span class="sxs-lookup"><span data-stu-id="3660c-1579">Regular expressions</span></span>

<span data-ttu-id="3660c-1580">ASP.NET Core Framework dodaje `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` do konstruktora wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1580">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="3660c-1581"><xref:System.Text.RegularExpressions.RegexOptions>Aby uzyskać opis tych elementów członkowskich, zobacz.</span><span class="sxs-lookup"><span data-stu-id="3660c-1581">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="3660c-1582">Wyrażenia regularne używają ograniczników i tokenów podobnie jak w przypadku routingu i języka C#.</span><span class="sxs-lookup"><span data-stu-id="3660c-1582">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="3660c-1583">Tokeny wyrażenia regularnego muszą być zmienione.</span><span class="sxs-lookup"><span data-stu-id="3660c-1583">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="3660c-1584">Aby użyć wyrażenia regularnego `^\d{3}-\d{2}-\d{4}$` w routingu, wyrażenie musi mieć `\` (pojedynczy ukośnik odwrotny) podany w ciągu jako `\\` (podwójny ukośnik odwrotny) w pliku źródłowym C# w celu ucieczki `\` znaku ucieczki ciągu (chyba że używane są [literały ciągu Verbatim](/dotnet/csharp/language-reference/keywords/string)).</span><span class="sxs-lookup"><span data-stu-id="3660c-1584">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in routing, the expression must have the `\` (single backslash) characters provided in the string as `\\` (double backslash) characters in the C# source file in order to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string)).</span></span> <span data-ttu-id="3660c-1585">Na znaki ogranicznika parametru routingu ucieczki ( `{` , `}` , `[` , `]` ), podwójne znaki w wyrażeniu ( `{{` , `}` ,, `[[` `]]` ).</span><span class="sxs-lookup"><span data-stu-id="3660c-1585">To escape routing parameter delimiter characters (`{`, `}`, `[`, `]`), double the characters in the expression (`{{`, `}`, `[[`, `]]`).</span></span> <span data-ttu-id="3660c-1586">W poniższej tabeli przedstawiono wyrażenie regularne i wersja z ucieczką.</span><span class="sxs-lookup"><span data-stu-id="3660c-1586">The following table shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="3660c-1587">Wyrażenie regularne</span><span class="sxs-lookup"><span data-stu-id="3660c-1587">Regular Expression</span></span>    | <span data-ttu-id="3660c-1588">Wyrażenie regularne o zmienionym znaczeniu</span><span class="sxs-lookup"><span data-stu-id="3660c-1588">Escaped Regular Expression</span></span>     |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="3660c-1589">Wyrażenia regularne używane w routingu często zaczynają się od znaku daszka ( `^` ) i dopasowują pozycję początkową ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1589">Regular expressions used in routing often start with the caret (`^`) character and match starting position of the string.</span></span> <span data-ttu-id="3660c-1590">Wyrażenia często kończą się znakiem dolara ( `$` ) i końcem ciągu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1590">The expressions often end with the dollar sign (`$`) character and match end of the string.</span></span> <span data-ttu-id="3660c-1591">`^`Znaki i `$` zapewniają, że wyrażenie regularne dopasowuje całą wartość parametru trasy.</span><span class="sxs-lookup"><span data-stu-id="3660c-1591">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="3660c-1592">Bez `^` znaków i `$` wyrażenie regularne dopasowuje dowolny podciąg w ciągu, co jest często niepożądane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1592">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="3660c-1593">W poniższej tabeli przedstawiono przykłady i wyjaśniono, dlaczego są one zgodne lub niezgodne.</span><span class="sxs-lookup"><span data-stu-id="3660c-1593">The following table provides examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="3660c-1594">Wyrażenie</span><span class="sxs-lookup"><span data-stu-id="3660c-1594">Expression</span></span>   | <span data-ttu-id="3660c-1595">Ciąg</span><span class="sxs-lookup"><span data-stu-id="3660c-1595">String</span></span>    | <span data-ttu-id="3660c-1596">Dopasowanie</span><span class="sxs-lookup"><span data-stu-id="3660c-1596">Match</span></span> | <span data-ttu-id="3660c-1597">Komentarz</span><span class="sxs-lookup"><span data-stu-id="3660c-1597">Comment</span></span>               |
| ------------ | --------- | :---: |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1598">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-1598">hello</span></span>     | <span data-ttu-id="3660c-1599">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1599">Yes</span></span>   | <span data-ttu-id="3660c-1600">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-1600">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1601">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-1601">123abc456</span></span> | <span data-ttu-id="3660c-1602">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1602">Yes</span></span>   | <span data-ttu-id="3660c-1603">Dopasowania podciągów</span><span class="sxs-lookup"><span data-stu-id="3660c-1603">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1604">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-1604">mz</span></span>        | <span data-ttu-id="3660c-1605">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1605">Yes</span></span>   | <span data-ttu-id="3660c-1606">Wyrażenie dopasowania</span><span class="sxs-lookup"><span data-stu-id="3660c-1606">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="3660c-1607">MZ</span><span class="sxs-lookup"><span data-stu-id="3660c-1607">MZ</span></span>        | <span data-ttu-id="3660c-1608">Tak</span><span class="sxs-lookup"><span data-stu-id="3660c-1608">Yes</span></span>   | <span data-ttu-id="3660c-1609">Bez uwzględniania wielkości liter</span><span class="sxs-lookup"><span data-stu-id="3660c-1609">Not case sensitive</span></span>    |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-1610">hello</span><span class="sxs-lookup"><span data-stu-id="3660c-1610">hello</span></span>     | <span data-ttu-id="3660c-1611">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-1611">No</span></span>    | <span data-ttu-id="3660c-1612">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-1612">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="3660c-1613">123abc456</span><span class="sxs-lookup"><span data-stu-id="3660c-1613">123abc456</span></span> | <span data-ttu-id="3660c-1614">Nie</span><span class="sxs-lookup"><span data-stu-id="3660c-1614">No</span></span>    | <span data-ttu-id="3660c-1615">Zobacz `^` i `$` powyżej</span><span class="sxs-lookup"><span data-stu-id="3660c-1615">See `^` and `$` above</span></span> |

<span data-ttu-id="3660c-1616">Aby uzyskać więcej informacji na temat składni wyrażeń regularnych, zobacz [.NET Framework wyrażeń regularnych](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="3660c-1616">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="3660c-1617">Aby ograniczyć parametr do znanego zestawu możliwych wartości, użyj wyrażenia regularnego.</span><span class="sxs-lookup"><span data-stu-id="3660c-1617">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="3660c-1618">Na przykład `{action:regex(^(list|get|create)$)}` dopasowuje `action` wartość trasy do `list` , `get` , lub `create` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1618">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="3660c-1619">Jeśli przeszedł do słownika ograniczeń, ciąg `^(list|get|create)$` jest równoważny.</span><span class="sxs-lookup"><span data-stu-id="3660c-1619">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="3660c-1620">Ograniczenia, które są przesyłane w słowniku ograniczenia (nie wbudowane w szablon), które nie pasują do jednego ze znanych ograniczeń, są również traktowane jako wyrażenia regularne.</span><span class="sxs-lookup"><span data-stu-id="3660c-1620">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

## <a name="custom-route-constraints"></a><span data-ttu-id="3660c-1621">Niestandardowe ograniczenia trasy</span><span class="sxs-lookup"><span data-stu-id="3660c-1621">Custom Route Constraints</span></span>

<span data-ttu-id="3660c-1622">Oprócz wbudowanych ograniczeń trasy niestandardowe ograniczenia trasy mogą być tworzone przez implementację <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interfejsu.</span><span class="sxs-lookup"><span data-stu-id="3660c-1622">In addition to the built-in route constraints, custom route constraints can be created by implementing the <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface.</span></span> <span data-ttu-id="3660c-1623"><xref:Microsoft.AspNetCore.Routing.IRouteConstraint>Interfejs zawiera jedną metodę, `Match` która zwraca, `true` Jeśli ograniczenie jest spełnione i `false` w przeciwnym razie.</span><span class="sxs-lookup"><span data-stu-id="3660c-1623">The <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> interface contains a single method, `Match`, which returns `true` if the constraint is satisfied and `false` otherwise.</span></span>

<span data-ttu-id="3660c-1624">Aby użyć niestandardowego <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> , typ ograniczenia trasy musi być zarejestrowany <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> w aplikacji w kontenerze usługi aplikacji.</span><span class="sxs-lookup"><span data-stu-id="3660c-1624">To use a custom <xref:Microsoft.AspNetCore.Routing.IRouteConstraint>, the route constraint type must be registered with the app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> in the app's service container.</span></span> <span data-ttu-id="3660c-1625"><xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>Jest słownikiem, który mapuje klucze ograniczeń trasy do <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementacji, które weryfikują te ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1625">A <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> is a dictionary that maps route constraint keys to <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> implementations that validate those constraints.</span></span> <span data-ttu-id="3660c-1626">Aplikację <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> można zaktualizować w `Startup.ConfigureServices` ramach [usług. Wywołanie addrouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) lub przez skonfigurowanie <xref:Microsoft.AspNetCore.Routing.RouteOptions> bezpośrednio w usłudze `services.Configure<RouteOptions>` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1626">An app's <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap> can be updated in `Startup.ConfigureServices` either as part of a [services.AddRouting](xref:Microsoft.Extensions.DependencyInjection.RoutingServiceCollectionExtensions.AddRouting*) call or by configuring <xref:Microsoft.AspNetCore.Routing.RouteOptions> directly with `services.Configure<RouteOptions>`.</span></span> <span data-ttu-id="3660c-1627">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3660c-1627">For example:</span></span>

```csharp
services.AddRouting(options =>
{
    options.ConstraintMap.Add("customName", typeof(MyCustomConstraint));
});
```

<span data-ttu-id="3660c-1628">Ograniczenie można następnie zastosować do tras w zwykły sposób, przy użyciu nazwy określonej podczas rejestrowania typu ograniczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1628">The constraint can then be applied to routes in the usual manner, using the name specified when registering the constraint type.</span></span> <span data-ttu-id="3660c-1629">Na przykład:</span><span class="sxs-lookup"><span data-stu-id="3660c-1629">For example:</span></span>

```csharp
[HttpGet("{id:customName}")]
public ActionResult<string> Get(string id)
```

## <a name="url-generation-reference"></a><span data-ttu-id="3660c-1630">Odwołanie do generacji adresów URL</span><span class="sxs-lookup"><span data-stu-id="3660c-1630">URL generation reference</span></span>

<span data-ttu-id="3660c-1631">Poniższy przykład pokazuje, jak wygenerować link do trasy, używając słownika wartości tras i <xref:Microsoft.AspNetCore.Routing.RouteCollection> .</span><span class="sxs-lookup"><span data-stu-id="3660c-1631">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

<span data-ttu-id="3660c-1632"><xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath>Wygenerowano na końcu powyższego przykładu `/package/create/123` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1632">The <xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath> generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="3660c-1633">Słownik zawiera `operation` `id` wartości i trasy szablonu "śledzenie trasy pakietu" `package/{operation}/{id}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1633">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="3660c-1634">Aby uzyskać szczegółowe informacje, zapoznaj się z przykładowym kodem w sekcji [Używanie oprogramowania pośredniczącego usługi routingu](#use-routing-middleware) lub [przykładowej aplikacji](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="3660c-1634">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/dotnet/AspNetCore.Docs/tree/main/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="3660c-1635">Drugi parametr <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> konstruktora jest kolekcją *wartości otoczenia*.</span><span class="sxs-lookup"><span data-stu-id="3660c-1635">The second parameter to the <xref:Microsoft.AspNetCore.Routing.VirtualPathContext> constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="3660c-1636">Wartości otoczenia są wygodne do użycia, ponieważ ograniczają liczbę wartości, które Deweloper musi określić w kontekście żądania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1636">Ambient values are convenient to use because they limit the number of values a developer must specify within a request context.</span></span> <span data-ttu-id="3660c-1637">Bieżące wartości trasy bieżącego żądania są uznawane za wartości otoczenia dla generacji łącza.</span><span class="sxs-lookup"><span data-stu-id="3660c-1637">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="3660c-1638">W akcji aplikacji ASP.NET Core MVC `About` `HomeController` , nie trzeba określać wartości trasy kontrolera do łączenia z `Index` akcją, &mdash; w której `Home` jest używana wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1638">In an ASP.NET Core MVC app's `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="3660c-1639">Wartości otoczenia, które nie pasują do parametru, są ignorowane.</span><span class="sxs-lookup"><span data-stu-id="3660c-1639">Ambient values that don't match a parameter are ignored.</span></span> <span data-ttu-id="3660c-1640">Wartości otoczenia są również ignorowane, gdy jawnie podana wartość przesłania wartość otoczenia.</span><span class="sxs-lookup"><span data-stu-id="3660c-1640">Ambient values are also ignored when an explicitly provided value overrides the ambient value.</span></span> <span data-ttu-id="3660c-1641">Dopasowanie występuje od lewej do prawej w adresie URL.</span><span class="sxs-lookup"><span data-stu-id="3660c-1641">Matching occurs from left to right in the URL.</span></span>

<span data-ttu-id="3660c-1642">Wartości jawnie podane, ale które nie pasują do segmentu trasy, są dodawane do ciągu zapytania.</span><span class="sxs-lookup"><span data-stu-id="3660c-1642">Values explicitly provided but that don't match a segment of the route are added to the query string.</span></span> <span data-ttu-id="3660c-1643">W poniższej tabeli przedstawiono wynik przy użyciu szablonu trasy `{controller}/{action}/{id?}` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1643">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="3660c-1644">Wartości otoczenia</span><span class="sxs-lookup"><span data-stu-id="3660c-1644">Ambient Values</span></span>                     | <span data-ttu-id="3660c-1645">Wartości jawne</span><span class="sxs-lookup"><span data-stu-id="3660c-1645">Explicit Values</span></span>                        | <span data-ttu-id="3660c-1646">Wynik</span><span class="sxs-lookup"><span data-stu-id="3660c-1646">Result</span></span>                  |
| ---------------------------------- | -------------------------------------- | ----------------------- |
| <span data-ttu-id="3660c-1647">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1647">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1648">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1648">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-1649">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1649">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1650">Controller = "Order", Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1650">controller = "Order", action = "About"</span></span> | `/Order/About`          |
| <span data-ttu-id="3660c-1651">Controller = "Home", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-1651">controller = "Home", color = "Red"</span></span> | <span data-ttu-id="3660c-1652">Action = "informacje"</span><span class="sxs-lookup"><span data-stu-id="3660c-1652">action = "About"</span></span>                       | `/Home/About`           |
| <span data-ttu-id="3660c-1653">Controller = "Strona główna"</span><span class="sxs-lookup"><span data-stu-id="3660c-1653">controller = "Home"</span></span>                | <span data-ttu-id="3660c-1654">Action = "informacje", Color = "Red"</span><span class="sxs-lookup"><span data-stu-id="3660c-1654">action = "About", color = "Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="3660c-1655">Jeśli trasa ma wartość domyślną, która nie odpowiada parametrowi, a ta wartość jest jawnie określona, musi być zgodna z wartością domyślną:</span><span class="sxs-lookup"><span data-stu-id="3660c-1655">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="3660c-1656">Generowanie linku generuje tylko łącze do tej trasy, gdy zostaną podane pasujące wartości dla `controller` i `action` .</span><span class="sxs-lookup"><span data-stu-id="3660c-1656">Link generation only generates a link for this route when the matching values for `controller` and `action` are provided.</span></span>

## <a name="complex-segments"></a><span data-ttu-id="3660c-1657">Złożone segmenty</span><span class="sxs-lookup"><span data-stu-id="3660c-1657">Complex segments</span></span>

<span data-ttu-id="3660c-1658">Złożone segmenty (na przykład `[Route("/x{token}y")]` ) są przetwarzane przez dopasowanie literałów z prawej strony do lewej w sposób niezachłanney.</span><span class="sxs-lookup"><span data-stu-id="3660c-1658">Complex segments (for example `[Route("/x{token}y")]`) are processed by matching up literals from right to left in a non-greedy way.</span></span> <span data-ttu-id="3660c-1659">[Ten kod](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) zawiera szczegółowy opis sposobu dopasowywania segmentów złożonych.</span><span class="sxs-lookup"><span data-stu-id="3660c-1659">See [this code](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) for a detailed explanation of how complex segments are matched.</span></span> <span data-ttu-id="3660c-1660">[Przykład kodu](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) nie jest używany przez ASP.NET Core, ale zapewnia dobre wyjaśnienie złożonych segmentów.</span><span class="sxs-lookup"><span data-stu-id="3660c-1660">The [code sample](https://github.com/dotnet/aspnetcore/blob/v2.2.13/src/Http/Routing/src/Patterns/RoutePatternMatcher.cs#L293) is not used by ASP.NET Core, but it provides a good explanation of complex segments.</span></span>

::: moniker-end
